
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../generate/">
      
      
        <link rel="next" href="../miller/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.9">
    
    
      
        <title>Surfaces - OgreInterface Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0d440cfe.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#surfacespy" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="OgreInterface Documentation" class="md-header__button md-logo" aria-label="OgreInterface Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OgreInterface Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Surfaces
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
      </form>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="OgreInterface Documentation" class="md-nav__button md-logo" aria-label="OgreInterface Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    OgreInterface Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../generate/" class="md-nav__link">
        Generators
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Surfaces
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Surfaces
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#surfacespy" class="md-nav__link">
    surfaces.py
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#OgreInterface.surfaces" class="md-nav__link">
    OgreInterface.surfaces
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface" class="md-nav__link">
    Interface
  </a>
  
    <nav class="md-nav" aria-label="Interface">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.area" class="md-nav__link">
    area
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.film_a" class="md-nav__link">
    film_a
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.film_b" class="md-nav__link">
    film_b
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.film_basis" class="md-nav__link">
    film_basis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.substrate_a" class="md-nav__link">
    substrate_a
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.substrate_b" class="md-nav__link">
    substrate_b
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.substrate_basis" class="md-nav__link">
    substrate_basis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.get_film_layer_indices" class="md-nav__link">
    get_film_layer_indices()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.get_film_supercell" class="md-nav__link">
    get_film_supercell()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.get_interface" class="md-nav__link">
    get_interface()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.get_substrate_layer_indices" class="md-nav__link">
    get_substrate_layer_indices()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.get_substrate_supercell" class="md-nav__link">
    get_substrate_supercell()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.plot_interface" class="md-nav__link">
    plot_interface()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.relax_interface" class="md-nav__link">
    relax_interface()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.replace_species" class="md-nav__link">
    replace_species()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.set_interfacial_distance" class="md-nav__link">
    set_interfacial_distance()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.shift_film_inplane" class="md-nav__link">
    shift_film_inplane()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.write_file" class="md-nav__link">
    write_file()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Surface" class="md-nav__link">
    Surface
  </a>
  
    <nav class="md-nav" aria-label="Surface">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Surface.area" class="md-nav__link">
    area
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Surface.bulk_transformation_matrix" class="md-nav__link">
    bulk_transformation_matrix
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Surface.formula" class="md-nav__link">
    formula
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Surface.inplane_vectors" class="md-nav__link">
    inplane_vectors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Surface.miller_index_a" class="md-nav__link">
    miller_index_a
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Surface.miller_index_b" class="md-nav__link">
    miller_index_b
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Surface.slab_transformation_matrix" class="md-nav__link">
    slab_transformation_matrix
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Surface.get_surface" class="md-nav__link">
    get_surface()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Surface.get_termination" class="md-nav__link">
    get_termination()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Surface.passivate" class="md-nav__link">
    passivate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Surface.remove_layers" class="md-nav__link">
    remove_layers()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Surface.write_file" class="md-nav__link">
    write_file()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../miller/" class="md-nav__link">
        Miller Index Scan
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        Utils
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../lattice_match/" class="md-nav__link">
        Zur and McGill Algorithm
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
      
      
      
        <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
          Surface Matching
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_6">
          <span class="md-nav__icon md-icon"></span>
          Surface Matching
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../surface_match/ionic_surface_matcher/" class="md-nav__link">
        Ionic surface matcher
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../surface_match/sphere_surface_matcher/" class="md-nav__link">
        Sphere surface matcher
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" >
      
      
      
        <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
          Score Function
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_7">
          <span class="md-nav__icon md-icon"></span>
          Score Function
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../score_function/born/" class="md-nav__link">
        Born
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../score_function/ewald/" class="md-nav__link">
        Ewald
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../score_function/overlap/" class="md-nav__link">
        Overlap
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#surfacespy" class="md-nav__link">
    surfaces.py
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#OgreInterface.surfaces" class="md-nav__link">
    OgreInterface.surfaces
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface" class="md-nav__link">
    Interface
  </a>
  
    <nav class="md-nav" aria-label="Interface">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.area" class="md-nav__link">
    area
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.film_a" class="md-nav__link">
    film_a
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.film_b" class="md-nav__link">
    film_b
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.film_basis" class="md-nav__link">
    film_basis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.substrate_a" class="md-nav__link">
    substrate_a
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.substrate_b" class="md-nav__link">
    substrate_b
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.substrate_basis" class="md-nav__link">
    substrate_basis
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.get_film_layer_indices" class="md-nav__link">
    get_film_layer_indices()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.get_film_supercell" class="md-nav__link">
    get_film_supercell()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.get_interface" class="md-nav__link">
    get_interface()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.get_substrate_layer_indices" class="md-nav__link">
    get_substrate_layer_indices()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.get_substrate_supercell" class="md-nav__link">
    get_substrate_supercell()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.plot_interface" class="md-nav__link">
    plot_interface()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.relax_interface" class="md-nav__link">
    relax_interface()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.replace_species" class="md-nav__link">
    replace_species()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.set_interfacial_distance" class="md-nav__link">
    set_interfacial_distance()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.shift_film_inplane" class="md-nav__link">
    shift_film_inplane()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Interface.write_file" class="md-nav__link">
    write_file()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Surface" class="md-nav__link">
    Surface
  </a>
  
    <nav class="md-nav" aria-label="Surface">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Surface.area" class="md-nav__link">
    area
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Surface.bulk_transformation_matrix" class="md-nav__link">
    bulk_transformation_matrix
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Surface.formula" class="md-nav__link">
    formula
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Surface.inplane_vectors" class="md-nav__link">
    inplane_vectors
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Surface.miller_index_a" class="md-nav__link">
    miller_index_a
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Surface.miller_index_b" class="md-nav__link">
    miller_index_b
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Surface.slab_transformation_matrix" class="md-nav__link">
    slab_transformation_matrix
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Surface.get_surface" class="md-nav__link">
    get_surface()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Surface.get_termination" class="md-nav__link">
    get_termination()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Surface.passivate" class="md-nav__link">
    passivate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Surface.remove_layers" class="md-nav__link">
    remove_layers()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#OgreInterface.surfaces.Surface.write_file" class="md-nav__link">
    write_file()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Surfaces</h1>

<h2 id="surfacespy">surfaces.py</h2>


<div class="doc doc-object doc-module">


<a id="OgreInterface.surfaces"></a>
  <div class="doc doc-contents first">
  
      <p>This module will be used to construct the surfaces and interfaces used in this package.</p>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="OgreInterface.surfaces.Interface" class="doc doc-heading">
        <code>Interface</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Container of Interfaces generated using the InterfaceGenerator</p>
<p>The Surface class and will be used as an input to the InterfaceGenerator class,
and it should be create exclusively using the SurfaceGenerator.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>substrate</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="OgreInterface.surfaces.Surface" href="#OgreInterface.surfaces.Surface">Surface</a></code>
          </td>
          <td><p>Surface class of the substrate material</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>film</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="OgreInterface.surfaces.Surface" href="#OgreInterface.surfaces.Surface">Surface</a></code>
          </td>
          <td><p>Surface class of the film material</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>match</code></td>
          <td>
                <code><span title="OgreInterface.lattice_match.OgreMatch">OgreMatch</span></code>
          </td>
          <td><p>OgreMatch class of the matching interface</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>interfacial_distance</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>Distance between the top atom of the substrate and the bottom atom of the film</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>vacuum</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>Size of the vacuum in Angstroms</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>center</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines if the interface is centered in the vacuum</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>substrate</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="OgreInterface.surfaces.Surface" href="#OgreInterface.surfaces.Surface">Surface</a></code>
          </td>
          <td><p>Surface class of the substrate material</p></td>
        </tr>
        <tr>
          <td><code>film</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="OgreInterface.surfaces.Surface" href="#OgreInterface.surfaces.Surface">Surface</a></code>
          </td>
          <td><p>Surface class of the film material</p></td>
        </tr>
        <tr>
          <td><code>match</code></td>
          <td>
                <code><span title="OgreInterface.lattice_match.OgreMatch">OgreMatch</span></code>
          </td>
          <td><p>OgreMatch class of the matching interface</p></td>
        </tr>
        <tr>
          <td><code>interfacial_distance</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>Distance between the top atom of the substrate and the bottom atom of the film</p></td>
        </tr>
        <tr>
          <td><code>vacuum</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>Size of the vacuum in Angstroms</p></td>
        </tr>
        <tr>
          <td><code>center</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines if the interface is centered in the vacuum</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>OgreInterface/surfaces.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span>
<span class="normal">2124</span>
<span class="normal">2125</span>
<span class="normal">2126</span>
<span class="normal">2127</span>
<span class="normal">2128</span>
<span class="normal">2129</span>
<span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span>
<span class="normal">2136</span>
<span class="normal">2137</span>
<span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span>
<span class="normal">2141</span>
<span class="normal">2142</span>
<span class="normal">2143</span>
<span class="normal">2144</span>
<span class="normal">2145</span>
<span class="normal">2146</span>
<span class="normal">2147</span>
<span class="normal">2148</span>
<span class="normal">2149</span>
<span class="normal">2150</span>
<span class="normal">2151</span>
<span class="normal">2152</span>
<span class="normal">2153</span>
<span class="normal">2154</span>
<span class="normal">2155</span>
<span class="normal">2156</span>
<span class="normal">2157</span>
<span class="normal">2158</span>
<span class="normal">2159</span>
<span class="normal">2160</span>
<span class="normal">2161</span>
<span class="normal">2162</span>
<span class="normal">2163</span>
<span class="normal">2164</span>
<span class="normal">2165</span>
<span class="normal">2166</span>
<span class="normal">2167</span>
<span class="normal">2168</span>
<span class="normal">2169</span>
<span class="normal">2170</span>
<span class="normal">2171</span>
<span class="normal">2172</span>
<span class="normal">2173</span>
<span class="normal">2174</span>
<span class="normal">2175</span>
<span class="normal">2176</span>
<span class="normal">2177</span>
<span class="normal">2178</span>
<span class="normal">2179</span>
<span class="normal">2180</span>
<span class="normal">2181</span>
<span class="normal">2182</span>
<span class="normal">2183</span>
<span class="normal">2184</span>
<span class="normal">2185</span>
<span class="normal">2186</span>
<span class="normal">2187</span>
<span class="normal">2188</span>
<span class="normal">2189</span>
<span class="normal">2190</span>
<span class="normal">2191</span>
<span class="normal">2192</span>
<span class="normal">2193</span>
<span class="normal">2194</span>
<span class="normal">2195</span>
<span class="normal">2196</span>
<span class="normal">2197</span>
<span class="normal">2198</span>
<span class="normal">2199</span>
<span class="normal">2200</span>
<span class="normal">2201</span>
<span class="normal">2202</span>
<span class="normal">2203</span>
<span class="normal">2204</span>
<span class="normal">2205</span>
<span class="normal">2206</span>
<span class="normal">2207</span>
<span class="normal">2208</span>
<span class="normal">2209</span>
<span class="normal">2210</span>
<span class="normal">2211</span>
<span class="normal">2212</span>
<span class="normal">2213</span>
<span class="normal">2214</span>
<span class="normal">2215</span>
<span class="normal">2216</span>
<span class="normal">2217</span>
<span class="normal">2218</span>
<span class="normal">2219</span>
<span class="normal">2220</span>
<span class="normal">2221</span>
<span class="normal">2222</span>
<span class="normal">2223</span>
<span class="normal">2224</span>
<span class="normal">2225</span>
<span class="normal">2226</span>
<span class="normal">2227</span>
<span class="normal">2228</span>
<span class="normal">2229</span>
<span class="normal">2230</span>
<span class="normal">2231</span>
<span class="normal">2232</span>
<span class="normal">2233</span>
<span class="normal">2234</span>
<span class="normal">2235</span>
<span class="normal">2236</span>
<span class="normal">2237</span>
<span class="normal">2238</span>
<span class="normal">2239</span>
<span class="normal">2240</span>
<span class="normal">2241</span>
<span class="normal">2242</span>
<span class="normal">2243</span>
<span class="normal">2244</span>
<span class="normal">2245</span>
<span class="normal">2246</span>
<span class="normal">2247</span>
<span class="normal">2248</span>
<span class="normal">2249</span>
<span class="normal">2250</span>
<span class="normal">2251</span>
<span class="normal">2252</span>
<span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span>
<span class="normal">2258</span>
<span class="normal">2259</span>
<span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span>
<span class="normal">2263</span>
<span class="normal">2264</span>
<span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span>
<span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span>
<span class="normal">2278</span>
<span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span>
<span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span>
<span class="normal">2285</span>
<span class="normal">2286</span>
<span class="normal">2287</span>
<span class="normal">2288</span>
<span class="normal">2289</span>
<span class="normal">2290</span>
<span class="normal">2291</span>
<span class="normal">2292</span>
<span class="normal">2293</span>
<span class="normal">2294</span>
<span class="normal">2295</span>
<span class="normal">2296</span>
<span class="normal">2297</span>
<span class="normal">2298</span>
<span class="normal">2299</span>
<span class="normal">2300</span>
<span class="normal">2301</span>
<span class="normal">2302</span>
<span class="normal">2303</span>
<span class="normal">2304</span>
<span class="normal">2305</span>
<span class="normal">2306</span>
<span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span>
<span class="normal">2315</span>
<span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span>
<span class="normal">2319</span>
<span class="normal">2320</span>
<span class="normal">2321</span>
<span class="normal">2322</span>
<span class="normal">2323</span>
<span class="normal">2324</span>
<span class="normal">2325</span>
<span class="normal">2326</span>
<span class="normal">2327</span>
<span class="normal">2328</span>
<span class="normal">2329</span>
<span class="normal">2330</span>
<span class="normal">2331</span>
<span class="normal">2332</span>
<span class="normal">2333</span>
<span class="normal">2334</span>
<span class="normal">2335</span>
<span class="normal">2336</span>
<span class="normal">2337</span>
<span class="normal">2338</span>
<span class="normal">2339</span>
<span class="normal">2340</span>
<span class="normal">2341</span>
<span class="normal">2342</span>
<span class="normal">2343</span>
<span class="normal">2344</span>
<span class="normal">2345</span>
<span class="normal">2346</span>
<span class="normal">2347</span>
<span class="normal">2348</span>
<span class="normal">2349</span>
<span class="normal">2350</span>
<span class="normal">2351</span>
<span class="normal">2352</span>
<span class="normal">2353</span>
<span class="normal">2354</span>
<span class="normal">2355</span>
<span class="normal">2356</span>
<span class="normal">2357</span>
<span class="normal">2358</span>
<span class="normal">2359</span>
<span class="normal">2360</span>
<span class="normal">2361</span>
<span class="normal">2362</span>
<span class="normal">2363</span>
<span class="normal">2364</span>
<span class="normal">2365</span>
<span class="normal">2366</span>
<span class="normal">2367</span>
<span class="normal">2368</span>
<span class="normal">2369</span>
<span class="normal">2370</span>
<span class="normal">2371</span>
<span class="normal">2372</span>
<span class="normal">2373</span>
<span class="normal">2374</span>
<span class="normal">2375</span>
<span class="normal">2376</span>
<span class="normal">2377</span>
<span class="normal">2378</span>
<span class="normal">2379</span>
<span class="normal">2380</span>
<span class="normal">2381</span>
<span class="normal">2382</span>
<span class="normal">2383</span>
<span class="normal">2384</span>
<span class="normal">2385</span>
<span class="normal">2386</span>
<span class="normal">2387</span>
<span class="normal">2388</span>
<span class="normal">2389</span>
<span class="normal">2390</span>
<span class="normal">2391</span>
<span class="normal">2392</span>
<span class="normal">2393</span>
<span class="normal">2394</span>
<span class="normal">2395</span>
<span class="normal">2396</span>
<span class="normal">2397</span>
<span class="normal">2398</span>
<span class="normal">2399</span>
<span class="normal">2400</span>
<span class="normal">2401</span>
<span class="normal">2402</span>
<span class="normal">2403</span>
<span class="normal">2404</span>
<span class="normal">2405</span>
<span class="normal">2406</span>
<span class="normal">2407</span>
<span class="normal">2408</span>
<span class="normal">2409</span>
<span class="normal">2410</span>
<span class="normal">2411</span>
<span class="normal">2412</span>
<span class="normal">2413</span>
<span class="normal">2414</span>
<span class="normal">2415</span>
<span class="normal">2416</span>
<span class="normal">2417</span>
<span class="normal">2418</span>
<span class="normal">2419</span>
<span class="normal">2420</span>
<span class="normal">2421</span>
<span class="normal">2422</span>
<span class="normal">2423</span>
<span class="normal">2424</span>
<span class="normal">2425</span>
<span class="normal">2426</span>
<span class="normal">2427</span>
<span class="normal">2428</span>
<span class="normal">2429</span>
<span class="normal">2430</span>
<span class="normal">2431</span>
<span class="normal">2432</span>
<span class="normal">2433</span>
<span class="normal">2434</span>
<span class="normal">2435</span>
<span class="normal">2436</span>
<span class="normal">2437</span>
<span class="normal">2438</span>
<span class="normal">2439</span>
<span class="normal">2440</span>
<span class="normal">2441</span>
<span class="normal">2442</span>
<span class="normal">2443</span>
<span class="normal">2444</span>
<span class="normal">2445</span>
<span class="normal">2446</span>
<span class="normal">2447</span>
<span class="normal">2448</span>
<span class="normal">2449</span>
<span class="normal">2450</span>
<span class="normal">2451</span>
<span class="normal">2452</span>
<span class="normal">2453</span>
<span class="normal">2454</span>
<span class="normal">2455</span>
<span class="normal">2456</span>
<span class="normal">2457</span>
<span class="normal">2458</span>
<span class="normal">2459</span>
<span class="normal">2460</span>
<span class="normal">2461</span>
<span class="normal">2462</span>
<span class="normal">2463</span>
<span class="normal">2464</span>
<span class="normal">2465</span>
<span class="normal">2466</span>
<span class="normal">2467</span>
<span class="normal">2468</span>
<span class="normal">2469</span>
<span class="normal">2470</span>
<span class="normal">2471</span>
<span class="normal">2472</span>
<span class="normal">2473</span>
<span class="normal">2474</span>
<span class="normal">2475</span>
<span class="normal">2476</span>
<span class="normal">2477</span>
<span class="normal">2478</span>
<span class="normal">2479</span>
<span class="normal">2480</span>
<span class="normal">2481</span>
<span class="normal">2482</span>
<span class="normal">2483</span>
<span class="normal">2484</span>
<span class="normal">2485</span>
<span class="normal">2486</span>
<span class="normal">2487</span>
<span class="normal">2488</span>
<span class="normal">2489</span>
<span class="normal">2490</span>
<span class="normal">2491</span>
<span class="normal">2492</span>
<span class="normal">2493</span>
<span class="normal">2494</span>
<span class="normal">2495</span>
<span class="normal">2496</span>
<span class="normal">2497</span>
<span class="normal">2498</span>
<span class="normal">2499</span>
<span class="normal">2500</span>
<span class="normal">2501</span>
<span class="normal">2502</span>
<span class="normal">2503</span>
<span class="normal">2504</span>
<span class="normal">2505</span>
<span class="normal">2506</span>
<span class="normal">2507</span>
<span class="normal">2508</span>
<span class="normal">2509</span>
<span class="normal">2510</span>
<span class="normal">2511</span>
<span class="normal">2512</span>
<span class="normal">2513</span>
<span class="normal">2514</span>
<span class="normal">2515</span>
<span class="normal">2516</span>
<span class="normal">2517</span>
<span class="normal">2518</span>
<span class="normal">2519</span>
<span class="normal">2520</span>
<span class="normal">2521</span>
<span class="normal">2522</span>
<span class="normal">2523</span>
<span class="normal">2524</span>
<span class="normal">2525</span>
<span class="normal">2526</span>
<span class="normal">2527</span>
<span class="normal">2528</span>
<span class="normal">2529</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Interface</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Container of Interfaces generated using the InterfaceGenerator</span>

<span class="sd">    The Surface class and will be used as an input to the InterfaceGenerator class,</span>
<span class="sd">    and it should be create exclusively using the SurfaceGenerator.</span>

<span class="sd">    Args:</span>
<span class="sd">        substrate: Surface class of the substrate material</span>
<span class="sd">        film: Surface class of the film material</span>
<span class="sd">        match: OgreMatch class of the matching interface</span>
<span class="sd">        interfacial_distance: Distance between the top atom of the substrate and the bottom atom of the film</span>
<span class="sd">        vacuum: Size of the vacuum in Angstroms</span>
<span class="sd">        center: Determines if the interface is centered in the vacuum</span>

<span class="sd">    Attributes:</span>
<span class="sd">        substrate (Surface): Surface class of the substrate material</span>
<span class="sd">        film (Surface): Surface class of the film material</span>
<span class="sd">        match (OgreMatch): OgreMatch class of the matching interface</span>
<span class="sd">        interfacial_distance (float): Distance between the top atom of the substrate and the bottom atom of the film</span>
<span class="sd">        vacuum (float): Size of the vacuum in Angstroms</span>
<span class="sd">        center (bool): Determines if the interface is centered in the vacuum</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">substrate</span><span class="p">:</span> <span class="n">Surface</span><span class="p">,</span>
        <span class="n">film</span><span class="p">:</span> <span class="n">Surface</span><span class="p">,</span>
        <span class="n">match</span><span class="p">:</span> <span class="n">OgreMatch</span><span class="p">,</span>
        <span class="n">interfacial_distance</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">vacuum</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">center</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center</span> <span class="o">=</span> <span class="n">center</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span> <span class="o">=</span> <span class="n">substrate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">film</span> <span class="o">=</span> <span class="n">film</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">match</span> <span class="o">=</span> <span class="n">match</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vacuum</span> <span class="o">=</span> <span class="n">vacuum</span>
        <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_substrate_supercell</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_substrate_supercell_uvw</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_substrate_supercell_scale_factors</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_supercell</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_film_supercell</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_film_supercell_uvw</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_film_supercell_scale_factors</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_supercell</span><span class="p">(</span><span class="n">substrate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_substrate_a_to_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orient_supercell</span><span class="p">(</span>
            <span class="n">supercell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_substrate_supercell</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_film_a_to_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orient_supercell</span><span class="p">(</span>
            <span class="n">supercell</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_film_supercell</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">interfacial_distance</span> <span class="o">=</span> <span class="n">interfacial_distance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_strained_sub</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substrate_supercell</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_strained_film</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_film</span><span class="p">()</span>

        <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_M_matrix</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_structure</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_substrate_structure</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_film_structure</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_atoms</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_substrate_atoms</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_film_atoms</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_structure</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_substrate_structure</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_film_structure</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_atoms</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_substrate_atoms</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_film_atoms</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stack_interface</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_a_shift</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_b_shift</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">def</span> <span class="nf">get_interface</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">orthogonal</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">return_atoms</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Atoms</span><span class="p">,</span> <span class="n">Structure</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is a simple function for easier access to the interface structure generated from the OgreMatch</span>

<span class="sd">        Args:</span>
<span class="sd">            orthogonal: Determines if the orthogonalized structure is returned</span>
<span class="sd">            return_atoms: Determines if the ASE Atoms object is returned instead of a Pymatgen Structure object (default)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Either a Pymatgen Structure of ASE Atoms object of the interface structure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">orthogonal</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">return_atoms</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_atoms</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_structure</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">return_atoms</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_atoms</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_structure</span>

    <span class="k">def</span> <span class="nf">get_substrate_supercell</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">orthogonal</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">return_atoms</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Atoms</span><span class="p">,</span> <span class="n">Structure</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is a simple function for easier access to the substrate supercell generated from the OgreMatch</span>
<span class="sd">        (i.e. the interface structure with the film atoms removed)</span>

<span class="sd">        Args:</span>
<span class="sd">            orthogonal: Determines if the orthogonalized structure is returned</span>
<span class="sd">            return_atoms: Determines if the ASE Atoms object is returned instead of a Pymatgen Structure object (default)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Either a Pymatgen Structure of ASE Atoms object of the substrate supercell structure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">orthogonal</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">return_atoms</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_substrate_atoms</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_substrate_structure</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">return_atoms</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_substrate_atoms</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_substrate_structure</span>

    <span class="k">def</span> <span class="nf">get_film_supercell</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">orthogonal</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">return_atoms</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Atoms</span><span class="p">,</span> <span class="n">Structure</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is a simple function for easier access to the film supercell generated from the OgreMatch</span>
<span class="sd">        (i.e. the interface structure with the substrate atoms removed)</span>

<span class="sd">        Args:</span>
<span class="sd">            orthogonal: Determines if the orthogonalized structure is returned</span>
<span class="sd">            return_atoms: Determines if the ASE Atoms object is returned instead of a Pymatgen Structure object (default)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Either a Pymatgen Structure of ASE Atoms object of the film supercell structure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">orthogonal</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">return_atoms</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_film_atoms</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_film_structure</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">return_atoms</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_film_atoms</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_film_structure</span>

    <span class="k">def</span> <span class="nf">get_substrate_layer_indices</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">layer_from_interface</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function is used to extract the atom-indicies of specific layers of the substrate part of the interface.</span>

<span class="sd">        Examples:</span>
<span class="sd">        ```</span>
<span class="sd">        &gt;&gt;&gt; interface.get_substrate_layer_indices(layer_from_interface=0)</span>
<span class="sd">        &gt;&gt;&gt; [234 235 236 237 254 255 256 257]</span>
<span class="sd">        ```</span>

<span class="sd">        Args:</span>
<span class="sd">            layer_from_interface: The layer number of the substrate which you would like to get</span>
<span class="sd">                atom-indices for. The layer number is reference from the interface, so layer_from_interface=0</span>
<span class="sd">                would be the layer of the substrate that is at the interface.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A numpy array of integer indices corresponding to the atom index of the interface structure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">interface</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_structure</span>
        <span class="n">site_props</span> <span class="o">=</span> <span class="n">interface</span><span class="o">.</span><span class="n">site_properties</span>
        <span class="n">is_sub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">site_props</span><span class="p">[</span><span class="s2">&quot;is_sub&quot;</span><span class="p">])</span>
        <span class="n">layer_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">site_props</span><span class="p">[</span><span class="s2">&quot;layer_index&quot;</span><span class="p">])</span>
        <span class="n">sub_n_layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">layers</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">rel_layer_index</span> <span class="o">=</span> <span class="n">sub_n_layers</span> <span class="o">-</span> <span class="n">layer_index</span>
        <span class="n">is_layer</span> <span class="o">=</span> <span class="n">rel_layer_index</span> <span class="o">==</span> <span class="n">layer_from_interface</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">is_sub</span><span class="p">,</span> <span class="n">is_layer</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">get_film_layer_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_from_interface</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function is used to extract the atom-indicies of specific layers of the film part of the interface.</span>

<span class="sd">        Examples:</span>
<span class="sd">        ```</span>
<span class="sd">        &gt;&gt;&gt; interface.get_substrate_layer_indices(layer_from_interface=0)</span>
<span class="sd">        &gt;&gt;&gt; [0 1 2 3 4 5 6 7 8 9 10 11 12]</span>
<span class="sd">        ```</span>

<span class="sd">        Args:</span>
<span class="sd">            layer_from_interface: The layer number of the film which you would like to get atom-indices for.</span>
<span class="sd">            The layer number is reference from the interface, so layer_from_interface=0</span>
<span class="sd">            would be the layer of the film that is at the interface.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A numpy array of integer indices corresponding to the atom index of the interface structure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">interface</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_structure</span>
        <span class="n">site_props</span> <span class="o">=</span> <span class="n">interface</span><span class="o">.</span><span class="n">site_properties</span>
        <span class="n">is_film</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">site_props</span><span class="p">[</span><span class="s2">&quot;is_film&quot;</span><span class="p">])</span>
        <span class="n">layer_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">site_props</span><span class="p">[</span><span class="s2">&quot;layer_index&quot;</span><span class="p">])</span>
        <span class="n">is_layer</span> <span class="o">=</span> <span class="n">layer_index</span> <span class="o">==</span> <span class="n">layer_from_interface</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">is_film</span><span class="p">,</span> <span class="n">is_layer</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">replace_species</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">site_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">species_mapping</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function can be used to replace the species at a given site in the interface structure</span>

<span class="sd">        Examples:</span>
<span class="sd">        ```</span>
<span class="sd">        &gt;&gt;&gt; interface.replace_species(site_index=42, species_mapping={&quot;In&quot;: &quot;Zn&quot;, &quot;As&quot;: &quot;Te&quot;})</span>
<span class="sd">        ```</span>

<span class="sd">        Args:</span>
<span class="sd">            site_index: Index of the site to be replaced</span>
<span class="sd">            species_mapping: Dictionary showing the mapping between species.</span>
<span class="sd">                For example if you wanted to replace InAs with ZnTe then the species mapping would</span>
<span class="sd">                be as shown in the example above.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">species_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_structure</span><span class="p">[</span><span class="n">site_index</span><span class="p">]</span><span class="o">.</span><span class="n">species_string</span>

        <span class="k">if</span> <span class="n">species_str</span> <span class="ow">in</span> <span class="n">species_mapping</span><span class="p">:</span>
            <span class="n">is_sub</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_structure</span><span class="p">[</span><span class="n">site_index</span><span class="p">]</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span>
                <span class="s2">&quot;is_sub&quot;</span>
            <span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_structure</span><span class="p">[</span><span class="n">site_index</span><span class="p">]</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span>
                <span class="n">species_mapping</span><span class="p">[</span><span class="n">species_str</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_structure</span><span class="p">[</span><span class="n">site_index</span><span class="p">]</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span>
                <span class="n">species_mapping</span><span class="p">[</span><span class="n">species_str</span><span class="p">]</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">is_sub</span><span class="p">:</span>
                <span class="n">sub_iface_equiv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_substrate_structure</span><span class="o">.</span><span class="n">site_properties</span><span class="p">[</span>
                        <span class="s2">&quot;interface_equivalent&quot;</span>
                    <span class="p">]</span>
                <span class="p">)</span>
                <span class="n">sub_site_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sub_iface_equiv</span> <span class="o">==</span> <span class="n">site_index</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_substrate_structure</span><span class="p">[</span>
                    <span class="n">sub_site_ind</span>
                <span class="p">]</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="n">species_mapping</span><span class="p">[</span><span class="n">species_str</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_substrate_structure</span><span class="p">[</span>
                    <span class="n">sub_site_ind</span>
                <span class="p">]</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="n">species_mapping</span><span class="p">[</span><span class="n">species_str</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">film_iface_equiv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_film_structure</span><span class="o">.</span><span class="n">site_properties</span><span class="p">[</span>
                        <span class="s2">&quot;interface_equivalent&quot;</span>
                    <span class="p">]</span>
                <span class="p">)</span>
                <span class="n">film_site_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">film_iface_equiv</span> <span class="o">==</span> <span class="n">site_index</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_film_structure</span><span class="p">[</span>
                    <span class="n">film_site_ind</span>
                <span class="p">]</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="n">species_mapping</span><span class="p">[</span><span class="n">species_str</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_film_structure</span><span class="p">[</span>
                    <span class="n">film_site_ind</span>
                <span class="p">]</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="n">species_mapping</span><span class="p">[</span><span class="n">species_str</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Species: </span><span class="si">{</span><span class="n">species_str</span><span class="si">}</span><span class="s2"> is not is species mapping&quot;</span>
            <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">area</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cross section area of the interface in Angstroms^2</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; interface.area</span>
<span class="sd">            &gt;&gt;&gt; 205.123456</span>

<span class="sd">        Returns:</span>
<span class="sd">            Cross-section area in Angstroms^2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">match</span><span class="o">.</span><span class="n">area</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_structure_volume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">matrix</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_structure</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span><span class="p">)</span>
        <span class="n">vac_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">matrix</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vacuum</span> <span class="o">*</span> <span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])),</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="n">total_volume</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">matrix</span><span class="p">))</span>
        <span class="n">vacuum_volume</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">vac_matrix</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">total_volume</span> <span class="o">-</span> <span class="n">vacuum_volume</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">substrate_basis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the miller indices of the basis vectors of the substrate supercell</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; interface.substrate_basis</span>
<span class="sd">            &gt;&gt;&gt; [[3 1 0]</span>
<span class="sd">            ...  [-1 3 0]</span>
<span class="sd">            ...  [0 0 1]]</span>

<span class="sd">        Returns:</span>
<span class="sd">            (3, 3) numpy array containing the miller indices of each lattice vector</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substrate_supercell_uvw</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">substrate_a</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the miller indices of the a basis vector of the substrate supercell</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; interface.substrate_a</span>
<span class="sd">            &gt;&gt;&gt; [3 1 0]</span>

<span class="sd">        Returns:</span>
<span class="sd">            (3,) numpy array containing the miller indices of the a lattice vector</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substrate_supercell_uvw</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">substrate_b</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the miller indices of the b basis vector of the substrate supercell</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; interface.substrate_b</span>
<span class="sd">            &gt;&gt;&gt; [-1 3 0]</span>

<span class="sd">        Returns:</span>
<span class="sd">            (3,) numpy array containing the miller indices of the b lattice vector</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substrate_supercell_uvw</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">film_basis</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the miller indices of the basis vectors of the film supercell</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; interface.film_basis</span>
<span class="sd">            &gt;&gt;&gt; [[1 -1 0]</span>
<span class="sd">            ...  [0 1 0]</span>
<span class="sd">            ...  [0 0 1]]</span>

<span class="sd">        Returns:</span>
<span class="sd">            (3, 3) numpy array containing the miller indices of each lattice vector</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_film_supercell_uvw</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">film_a</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the miller indices of the a basis vector of the film supercell</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; interface.film_a</span>
<span class="sd">            &gt;&gt;&gt; [1 -1 0]</span>

<span class="sd">        Returns:</span>
<span class="sd">            (3,) numpy array containing the miller indices of the a lattice vector</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_film_supercell_uvw</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">film_b</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the miller indices of the a basis vector of the film supercell</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; interface.film_b</span>
<span class="sd">            &gt;&gt;&gt; [0 1 0]</span>

<span class="sd">        Returns:</span>
<span class="sd">            (3,) numpy array containing the miller indices of the b lattice vector</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_film_supercell_uvw</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">fm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">film</span><span class="o">.</span><span class="n">miller_index</span>
        <span class="n">sm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">miller_index</span>
        <span class="n">film_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">film</span><span class="o">.</span><span class="n">formula</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">fm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">fm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">fm</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="n">sub_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">formula</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">sm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">sm</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">sm</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="n">s_uvw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substrate_supercell_uvw</span>
        <span class="n">s_sf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substrate_supercell_scale_factors</span>
        <span class="n">f_uvw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_film_supercell_uvw</span>
        <span class="n">f_sf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_film_supercell_scale_factors</span>
        <span class="n">match_a_film</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">f_sf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">*[</span><span class="si">{</span><span class="n">f_uvw</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">f_uvw</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">f_uvw</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2">]&quot;</span>
        <span class="p">)</span>
        <span class="n">match_a_sub</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s_sf</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">*[</span><span class="si">{</span><span class="n">s_uvw</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s_uvw</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s_uvw</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2">]&quot;</span>
        <span class="p">)</span>
        <span class="n">match_b_film</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">f_sf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">*[</span><span class="si">{</span><span class="n">f_uvw</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">f_uvw</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">f_uvw</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2">]&quot;</span>
        <span class="p">)</span>
        <span class="n">match_b_sub</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s_sf</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">*[</span><span class="si">{</span><span class="n">s_uvw</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s_uvw</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">s_uvw</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">2d</span><span class="si">}</span><span class="s2">]&quot;</span>
        <span class="p">)</span>
        <span class="n">return_info</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;Film: &quot;</span> <span class="o">+</span> <span class="n">film_str</span><span class="p">,</span>
            <span class="s2">&quot;Substrate: &quot;</span> <span class="o">+</span> <span class="n">sub_str</span><span class="p">,</span>
            <span class="s2">&quot;Epitaxial Match Along </span><span class="se">\\</span><span class="s2">vec</span><span class="si">{a}</span><span class="s2"> (film || sub): &quot;</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">match_a_film</span><span class="si">}</span><span class="s2"> || </span><span class="si">{</span><span class="n">match_a_sub</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Epitaxial Match Along </span><span class="se">\\</span><span class="s2">vec</span><span class="si">{b}</span><span class="s2"> (film || sub): &quot;</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">match_b_film</span><span class="si">}</span><span class="s2"> || </span><span class="si">{</span><span class="n">match_b_sub</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Strain Along </span><span class="se">\\</span><span class="s2">vec</span><span class="si">{a}</span><span class="s2"> (%): &quot;</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">match</span><span class="o">.</span><span class="n">linear_strain</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Strain Along </span><span class="se">\\</span><span class="s2">vec</span><span class="si">{b}</span><span class="s2"> (%): &quot;</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">match</span><span class="o">.</span><span class="n">linear_strain</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;In-plane Angle Mismatch (%): &quot;</span>
            <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">match</span><span class="o">.</span><span class="n">angle_strain</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Cross Section Area (Ang^2): &quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">area</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">return_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">return_info</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">return_str</span>

    <span class="k">def</span> <span class="nf">_load_relaxed_structure</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">relaxed_structure_file</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">relaxed_structure_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">poscar_str</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">desc_str</span> <span class="o">=</span> <span class="n">poscar_str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>

        <span class="n">layers</span> <span class="o">=</span> <span class="n">desc_str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
        <span class="n">termination_index</span> <span class="o">=</span> <span class="n">desc_str</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
        <span class="n">ortho</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">desc_str</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">d_int</span> <span class="o">=</span> <span class="n">desc_str</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">layers_to_relax</span> <span class="o">=</span> <span class="n">desc_str</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>

        <span class="n">film_layers</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">sub_layers</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">film_termination_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">termination_index</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">sub_termination_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">termination_index</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">N_film_layers_to_relax</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">layers_to_relax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">N_sub_layers_to_relax</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">layers_to_relax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">if</span> <span class="p">(</span>
            <span class="n">d_int</span> <span class="o">==</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">interfacial_distance</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="ow">and</span> <span class="n">film_termination_index</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">film</span><span class="o">.</span><span class="n">termination_index</span>
            <span class="ow">and</span> <span class="n">sub_termination_index</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">termination_index</span>
        <span class="p">):</span>
            <span class="n">poscar</span> <span class="o">=</span> <span class="n">Poscar</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">poscar_str</span><span class="p">),</span> <span class="n">read_velocities</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
            <span class="n">relaxed_structure</span> <span class="o">=</span> <span class="n">poscar</span><span class="o">.</span><span class="n">structure</span>

            <span class="k">if</span> <span class="n">ortho</span><span class="p">:</span>
                <span class="n">unrelaxed_structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_structure</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">unrelaxed_structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_structure</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

            <span class="n">unrelaxed_structure</span><span class="o">.</span><span class="n">add_site_property</span><span class="p">(</span>
                <span class="s2">&quot;orig_ind&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">unrelaxed_structure</span><span class="p">)))</span>
            <span class="p">)</span>

            <span class="n">relaxation_shifts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">unrelaxed_structure</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>

            <span class="n">is_negative</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">unrelaxed_structure</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>

            <span class="k">if</span> <span class="n">is_negative</span><span class="p">:</span>
                <span class="n">relaxed_structure</span> <span class="o">=</span> <span class="n">Structure</span><span class="p">(</span>
                    <span class="n">lattice</span><span class="o">=</span><span class="n">Lattice</span><span class="p">(</span><span class="n">relaxed_structure</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                    <span class="n">species</span><span class="o">=</span><span class="n">relaxed_structure</span><span class="o">.</span><span class="n">species</span><span class="p">,</span>
                    <span class="n">coords</span><span class="o">=</span><span class="n">relaxed_structure</span><span class="o">.</span><span class="n">frac_coords</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="n">is_film_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="n">unrelaxed_structure</span><span class="o">.</span><span class="n">site_properties</span><span class="p">[</span><span class="s2">&quot;is_film&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">is_sub_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="n">unrelaxed_structure</span><span class="o">.</span><span class="n">site_properties</span><span class="p">[</span><span class="s2">&quot;is_sub&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">layer_index_full</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="n">unrelaxed_structure</span><span class="o">.</span><span class="n">site_properties</span><span class="p">[</span><span class="s2">&quot;layer_index&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">sub_to_delete</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span>
                <span class="n">is_sub_full</span><span class="p">,</span>
                <span class="n">layer_index_full</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">layers</span> <span class="o">-</span> <span class="n">sub_layers</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">film_to_delete</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span>
                <span class="n">is_film_full</span><span class="p">,</span> <span class="n">layer_index_full</span> <span class="o">&gt;=</span> <span class="n">film_layers</span>
            <span class="p">)</span>

            <span class="n">to_delete</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">sub_to_delete</span><span class="p">,</span> <span class="n">film_to_delete</span><span class="p">))[</span>
                <span class="mi">0</span>
            <span class="p">]</span>

            <span class="n">unrelaxed_structure</span><span class="o">.</span><span class="n">remove_sites</span><span class="p">(</span><span class="n">to_delete</span><span class="p">)</span>

            <span class="n">is_film_small</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="n">unrelaxed_structure</span><span class="o">.</span><span class="n">site_properties</span><span class="p">[</span><span class="s2">&quot;is_film&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">is_sub_small</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="n">unrelaxed_structure</span><span class="o">.</span><span class="n">site_properties</span><span class="p">[</span><span class="s2">&quot;is_sub&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">layer_index_small</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="n">unrelaxed_structure</span><span class="o">.</span><span class="n">site_properties</span><span class="p">[</span><span class="s2">&quot;layer_index&quot;</span><span class="p">]</span>
            <span class="p">)</span>

            <span class="n">film_layers_to_relax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N_film_layers_to_relax</span><span class="p">)</span>

            <span class="n">sub_layers_to_relax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">layers</span> <span class="o">-</span> <span class="n">N_sub_layers_to_relax</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">film_to_relax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span>
                <span class="n">is_film_small</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">layer_index_small</span><span class="p">,</span> <span class="n">film_layers_to_relax</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">sub_to_relax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span>
                <span class="n">is_sub_small</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">layer_index_small</span><span class="p">,</span> <span class="n">sub_layers_to_relax</span><span class="p">)</span>
            <span class="p">)</span>

            <span class="n">relaxed_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">film_to_relax</span><span class="p">,</span> <span class="n">sub_to_relax</span><span class="p">)</span>
            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

            <span class="n">periodic_shifts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="p">]</span>
            <span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">unrelaxed_structure</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span><span class="p">)</span>

            <span class="n">ref_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">is_sub_small</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">unrelaxed_ref</span> <span class="o">=</span> <span class="n">unrelaxed_structure</span><span class="p">[</span><span class="n">ref_ind</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span>
            <span class="n">relaxed_ref</span> <span class="o">=</span> <span class="n">relaxed_structure</span><span class="p">[</span><span class="n">ref_ind</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">relaxed_inds</span><span class="p">:</span>
                <span class="n">init_ind</span> <span class="o">=</span> <span class="n">unrelaxed_structure</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="s2">&quot;orig_ind&quot;</span><span class="p">]</span>
                <span class="n">relaxed_coords</span> <span class="o">=</span> <span class="n">relaxed_structure</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span>
                <span class="n">relaxed_coords</span> <span class="o">-=</span> <span class="n">relaxed_ref</span>
                <span class="n">unrelaxed_coords</span> <span class="o">=</span> <span class="n">unrelaxed_structure</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span>
                <span class="n">unrelaxed_coords</span> <span class="o">-=</span> <span class="n">unrelaxed_ref</span>

                <span class="n">all_relaxed_coords</span> <span class="o">=</span> <span class="n">periodic_shifts</span> <span class="o">+</span> <span class="n">relaxed_coords</span>
                <span class="n">dists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span>
                    <span class="n">all_relaxed_coords</span> <span class="o">-</span> <span class="n">unrelaxed_coords</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
                <span class="p">)</span>
                <span class="n">center_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">dists</span><span class="p">)</span>
                <span class="n">bond</span> <span class="o">=</span> <span class="n">all_relaxed_coords</span><span class="p">[</span><span class="n">center_ind</span><span class="p">]</span> <span class="o">-</span> <span class="n">unrelaxed_coords</span>
                <span class="n">relaxation_shifts</span><span class="p">[</span><span class="n">init_ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">bond</span>

            <span class="k">return</span> <span class="n">relaxation_shifts</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;The surface terminations and interfacial distances must be the same&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">relax_interface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">relaxed_structure_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function will shift the positions of the atoms near the interface coorresponding to the</span>
<span class="sd">        atomic positions from a relaxed interface. This especially usefull when running DFT on large interface</span>
<span class="sd">        structures because the atomic positions can be relaxed using an interface with less layers, and</span>
<span class="sd">        then the relax positions can be applied to a much larger interface for a static DFT calculation.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; interface.relax_interface(relax_structure_file=&quot;CONTCAR&quot;)</span>

<span class="sd">        Args:</span>
<span class="sd">            relaxed_structure_file: File path to the relax structure (CONTCAR/POSCAR for now)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">relaxation_shifts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_relaxed_structure</span><span class="p">(</span>
            <span class="n">relaxed_structure_file</span>
        <span class="p">)</span>
        <span class="n">init_ortho_structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_structure</span>
        <span class="n">relaxed_ortho_structure</span> <span class="o">=</span> <span class="n">Structure</span><span class="p">(</span>
            <span class="n">lattice</span><span class="o">=</span><span class="n">init_ortho_structure</span><span class="o">.</span><span class="n">lattice</span><span class="p">,</span>
            <span class="n">species</span><span class="o">=</span><span class="n">init_ortho_structure</span><span class="o">.</span><span class="n">species</span><span class="p">,</span>
            <span class="n">coords</span><span class="o">=</span><span class="n">init_ortho_structure</span><span class="o">.</span><span class="n">cart_coords</span> <span class="o">+</span> <span class="n">relaxation_shifts</span><span class="p">,</span>
            <span class="n">to_unit_cell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">coords_are_cartesian</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">site_properties</span><span class="o">=</span><span class="n">init_ortho_structure</span><span class="o">.</span><span class="n">site_properties</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">relaxed_ortho_atoms</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_atoms</span><span class="p">(</span><span class="n">relaxed_ortho_structure</span><span class="p">)</span>
        <span class="p">(</span>
            <span class="n">relaxed_ortho_film_structure</span><span class="p">,</span>
            <span class="n">relaxed_ortho_film_atoms</span><span class="p">,</span>
            <span class="n">relaxed_ortho_sub_structure</span><span class="p">,</span>
            <span class="n">relaxed_ortho_sub_atoms</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_film_and_substrate_parts</span><span class="p">(</span><span class="n">relaxed_ortho_structure</span><span class="p">)</span>

        <span class="n">init_non_ortho_structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_structure</span>
        <span class="n">relaxed_non_ortho_structure</span> <span class="o">=</span> <span class="n">Structure</span><span class="p">(</span>
            <span class="n">lattice</span><span class="o">=</span><span class="n">init_non_ortho_structure</span><span class="o">.</span><span class="n">lattice</span><span class="p">,</span>
            <span class="n">species</span><span class="o">=</span><span class="n">init_non_ortho_structure</span><span class="o">.</span><span class="n">species</span><span class="p">,</span>
            <span class="n">coords</span><span class="o">=</span><span class="n">init_non_ortho_structure</span><span class="o">.</span><span class="n">cart_coords</span> <span class="o">+</span> <span class="n">relaxation_shifts</span><span class="p">,</span>
            <span class="n">to_unit_cell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">coords_are_cartesian</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">site_properties</span><span class="o">=</span><span class="n">init_non_ortho_structure</span><span class="o">.</span><span class="n">site_properties</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">relaxed_non_ortho_atoms</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_atoms</span><span class="p">(</span><span class="n">relaxed_non_ortho_structure</span><span class="p">)</span>
        <span class="p">(</span>
            <span class="n">relaxed_non_ortho_film_structure</span><span class="p">,</span>
            <span class="n">relaxed_non_ortho_film_atoms</span><span class="p">,</span>
            <span class="n">relaxed_non_ortho_sub_structure</span><span class="p">,</span>
            <span class="n">relaxed_non_ortho_sub_atoms</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_film_and_substrate_parts</span><span class="p">(</span><span class="n">relaxed_non_ortho_structure</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_structure</span> <span class="o">=</span> <span class="n">relaxed_ortho_structure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_film_structure</span> <span class="o">=</span> <span class="n">relaxed_ortho_film_structure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_substrate_structure</span> <span class="o">=</span> <span class="n">relaxed_ortho_sub_structure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_structure</span> <span class="o">=</span> <span class="n">relaxed_non_ortho_structure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_film_structure</span> <span class="o">=</span> <span class="n">relaxed_non_ortho_film_structure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_substrate_structure</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">relaxed_non_ortho_sub_structure</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_atoms</span> <span class="o">=</span> <span class="n">relaxed_ortho_atoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_film_atoms</span> <span class="o">=</span> <span class="n">relaxed_ortho_film_atoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_substrate_atoms</span> <span class="o">=</span> <span class="n">relaxed_ortho_sub_atoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_atoms</span> <span class="o">=</span> <span class="n">relaxed_non_ortho_atoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_film_atoms</span> <span class="o">=</span> <span class="n">relaxed_non_ortho_film_atoms</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_substrate_atoms</span> <span class="o">=</span> <span class="n">relaxed_non_ortho_sub_atoms</span>

    <span class="k">def</span> <span class="nf">write_file</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">output</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;POSCAR_interface&quot;</span><span class="p">,</span>
        <span class="n">orthogonal</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">relax</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">film_layers_to_relax</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">substrate_layers_to_relax</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write the POSCAR of the interface</span>

<span class="sd">        Args:</span>
<span class="sd">            output: File path of the output POSCAR</span>
<span class="sd">            orthogonal: Determines of the orthogonal structure is written</span>
<span class="sd">            relax: Determines if selective dynamics is applied to the atoms at the interface</span>
<span class="sd">            film_layers_to_relax: Number of unit cell layers near the interface to relax</span>
<span class="sd">            substrate_layers_to_relax: Number of unit cell layers near the interface to relax</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">orthogonal</span><span class="p">:</span>
            <span class="n">slab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_structure</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">slab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_structure</span>

        <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="sa">f</span><span class="s2">&quot;L=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">film</span><span class="o">.</span><span class="n">layers</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">layers</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">film</span><span class="o">.</span><span class="n">termination_index</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">termination_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;O=</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">orthogonal</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;d=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">interfacial_distance</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">relax</span><span class="p">:</span>
            <span class="n">comment</span> <span class="o">+=</span> <span class="s2">&quot;|&quot;</span> <span class="o">+</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="sa">f</span><span class="s2">&quot;R=</span><span class="si">{</span><span class="n">film_layers_to_relax</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">substrate_layers_to_relax</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="n">film_layers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">film_layers_to_relax</span><span class="p">)</span>
            <span class="n">sub_layers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">layers</span> <span class="o">-</span> <span class="n">substrate_layers_to_relax</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">layer_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">slab</span><span class="o">.</span><span class="n">site_properties</span><span class="p">[</span><span class="s2">&quot;layer_index&quot;</span><span class="p">])</span>
            <span class="n">is_sub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">slab</span><span class="o">.</span><span class="n">site_properties</span><span class="p">[</span><span class="s2">&quot;is_sub&quot;</span><span class="p">])</span>
            <span class="n">is_film</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">slab</span><span class="o">.</span><span class="n">site_properties</span><span class="p">[</span><span class="s2">&quot;is_film&quot;</span><span class="p">])</span>
            <span class="n">film_to_relax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span>
                <span class="n">is_film</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">layer_index</span><span class="p">,</span> <span class="n">film_layers</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">sub_to_relax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span>
                <span class="n">is_sub</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">layer_index</span><span class="p">,</span> <span class="n">sub_layers</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">to_relax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">sub_to_relax</span><span class="p">,</span> <span class="n">film_to_relax</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="n">repeats</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">comment</span> <span class="o">+=</span> <span class="s2">&quot;|&quot;</span> <span class="o">+</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="sa">f</span><span class="s2">&quot;a=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_a_shift</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;b=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_b_shift</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">_passivated</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">film</span><span class="o">.</span><span class="n">_passivated</span><span class="p">:</span>
            <span class="n">poscar</span> <span class="o">=</span> <span class="n">Poscar</span><span class="p">(</span><span class="n">slab</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">relax</span><span class="p">:</span>
                <span class="n">poscar</span><span class="o">.</span><span class="n">selective_dynamics</span> <span class="o">=</span> <span class="n">to_relax</span>

            <span class="n">poscar_str</span> <span class="o">=</span> <span class="n">poscar</span><span class="o">.</span><span class="n">get_string</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">syms</span> <span class="o">=</span> <span class="p">[</span><span class="n">site</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">symbol</span> <span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">slab</span><span class="p">]</span>

            <span class="n">syms</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">slab</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">site</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">symbol</span> <span class="o">==</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">site</span><span class="o">.</span><span class="n">specie</span><span class="p">,</span> <span class="s2">&quot;oxi_state&quot;</span><span class="p">):</span>
                        <span class="n">oxi</span> <span class="o">=</span> <span class="n">site</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">oxi_state</span>

                        <span class="k">if</span> <span class="n">oxi</span> <span class="o">&lt;</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">oxi</span> <span class="o">!=</span> <span class="mf">0.5</span><span class="p">:</span>
                            <span class="n">H_str</span> <span class="o">=</span> <span class="s2">&quot;H&quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">oxi</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                        <span class="k">elif</span> <span class="n">oxi</span> <span class="o">==</span> <span class="mf">0.5</span><span class="p">:</span>
                            <span class="n">H_str</span> <span class="o">=</span> <span class="s2">&quot;H.5&quot;</span>
                        <span class="k">elif</span> <span class="n">oxi</span> <span class="o">&gt;</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">oxi</span> <span class="o">!=</span> <span class="mf">1.5</span><span class="p">:</span>
                            <span class="n">H_str</span> <span class="o">=</span> <span class="s2">&quot;H&quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">oxi</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="k">elif</span> <span class="n">oxi</span> <span class="o">==</span> <span class="mf">1.5</span><span class="p">:</span>
                            <span class="n">H_str</span> <span class="o">=</span> <span class="s2">&quot;H1.5&quot;</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">H_str</span> <span class="o">=</span> <span class="s2">&quot;H&quot;</span>

                        <span class="n">syms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">H_str</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">syms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">site</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">symbol</span><span class="p">)</span>

            <span class="n">comp_list</span> <span class="o">=</span> <span class="p">[(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span><span class="n">syms</span><span class="p">)]</span>
            <span class="n">atom_types</span><span class="p">,</span> <span class="n">n_atoms</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">comp_list</span><span class="p">)</span>

            <span class="n">new_atom_types</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atom_types</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;H&quot;</span> <span class="o">==</span> <span class="n">atom</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">atom</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Hf&quot;</span><span class="p">,</span> <span class="s2">&quot;Hs&quot;</span><span class="p">,</span> <span class="s2">&quot;Hg&quot;</span><span class="p">,</span> <span class="s2">&quot;He&quot;</span><span class="p">]:</span>
                    <span class="n">new_atom_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">new_atom_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span>

            <span class="n">comment</span> <span class="o">+=</span> <span class="s2">&quot;|potcar=&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">atom_types</span><span class="p">)</span>

            <span class="n">poscar</span> <span class="o">=</span> <span class="n">Poscar</span><span class="p">(</span><span class="n">slab</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">relax</span><span class="p">:</span>
                <span class="n">poscar</span><span class="o">.</span><span class="n">selective_dynamics</span> <span class="o">=</span> <span class="n">to_relax</span>

            <span class="n">poscar_str</span> <span class="o">=</span> <span class="n">poscar</span><span class="o">.</span><span class="n">get_string</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">poscar_str</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">new_atom_types</span><span class="p">)</span>
            <span class="n">poscar_str</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">n_atoms</span><span class="p">)))</span>
            <span class="n">poscar_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">poscar_str</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">poscar_str</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_shift_film</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">interface</span><span class="p">:</span> <span class="n">Structure</span><span class="p">,</span> <span class="n">shift</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">fractional</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Structure</span><span class="p">,</span> <span class="n">Atoms</span><span class="p">,</span> <span class="n">Structure</span><span class="p">,</span> <span class="n">Atoms</span><span class="p">]:</span>
        <span class="n">shifted_interface_structure</span> <span class="o">=</span> <span class="n">interface</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">film_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
            <span class="n">shifted_interface_structure</span><span class="o">.</span><span class="n">site_properties</span><span class="p">[</span><span class="s2">&quot;is_film&quot;</span><span class="p">]</span>
        <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">shifted_interface_structure</span><span class="o">.</span><span class="n">translate_sites</span><span class="p">(</span>
            <span class="n">indices</span><span class="o">=</span><span class="n">film_ind</span><span class="p">,</span>
            <span class="n">vector</span><span class="o">=</span><span class="n">shift</span><span class="p">,</span>
            <span class="n">frac_coords</span><span class="o">=</span><span class="n">fractional</span><span class="p">,</span>
            <span class="n">to_unit_cell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">shifted_interface_atoms</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_atoms</span><span class="p">(</span><span class="n">shifted_interface_structure</span><span class="p">)</span>
        <span class="p">(</span>
            <span class="n">shifted_film_structure</span><span class="p">,</span>
            <span class="n">shifted_film_atoms</span><span class="p">,</span>
            <span class="n">_</span><span class="p">,</span>
            <span class="n">_</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_film_and_substrate_parts</span><span class="p">(</span><span class="n">shifted_interface_structure</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="n">shifted_interface_structure</span><span class="p">,</span>
            <span class="n">shifted_interface_atoms</span><span class="p">,</span>
            <span class="n">shifted_film_structure</span><span class="p">,</span>
            <span class="n">shifted_film_atoms</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_interfacial_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interfacial_distance</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets a new interfacial distance for the interface by shifting the film in the z-direction</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; interface.set_interfacial_distance(interfacial_distance=2.0)</span>

<span class="sd">        Args:</span>
<span class="sd">            interfacial_distance: New interfacial distance for the interface</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">shift</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">interfacial_distance</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">interfacial_distance</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interfacial_distance</span> <span class="o">=</span> <span class="n">interfacial_distance</span>
        <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_structure</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_atoms</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_film_structure</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_film_atoms</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shift_film</span><span class="p">(</span>
            <span class="n">interface</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_structure</span><span class="p">,</span>
            <span class="n">shift</span><span class="o">=</span><span class="n">shift</span><span class="p">,</span>
            <span class="n">fractional</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_structure</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_atoms</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_film_structure</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_film_atoms</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shift_film</span><span class="p">(</span>
            <span class="n">interface</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_structure</span><span class="p">,</span>
            <span class="n">shift</span><span class="o">=</span><span class="n">shift</span><span class="p">,</span>
            <span class="n">fractional</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">shift_film_inplane</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">x_shift</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">y_shift</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">fractional</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shifts the film in-place over the substrate within the plane of the interface by a given shift vector.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Shift using fractional coordinates:</span>
<span class="sd">            &gt;&gt;&gt; interface.shift_film(shift=[0.5, 0.25], fractional=True)</span>

<span class="sd">            Shift using cartesian coordinates:</span>
<span class="sd">            &gt;&gt;&gt; interface.shift_film(shift=[4.5, 0.0], fractional=False)</span>

<span class="sd">        Args:</span>
<span class="sd">            x_shift: Shift in the x or a-vector directions depending on if fractional=True</span>
<span class="sd">            y_shift: Shift in the y or b-vector directions depending on if fractional=True</span>
<span class="sd">            fractional: Determines if the shift is defined in fractional coordinates</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">shift_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x_shift</span><span class="p">,</span> <span class="n">y_shift</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">fractional</span><span class="p">:</span>
            <span class="n">frac_shift</span> <span class="o">=</span> <span class="n">shift_array</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">frac_shift</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_structure</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">get_fractional_coords</span><span class="p">(</span>
                    <span class="n">shift_array</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_a_shift</span> <span class="o">+=</span> <span class="n">shift_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_b_shift</span> <span class="o">+=</span> <span class="n">shift_array</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_structure</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_atoms</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_film_structure</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_film_atoms</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shift_film</span><span class="p">(</span>
            <span class="n">interface</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_structure</span><span class="p">,</span>
            <span class="n">shift</span><span class="o">=</span><span class="n">frac_shift</span><span class="p">,</span>
            <span class="n">fractional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_structure</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_atoms</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_film_structure</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_film_atoms</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shift_film</span><span class="p">(</span>
            <span class="n">interface</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_structure</span><span class="p">,</span>
            <span class="n">shift</span><span class="o">=</span><span class="n">frac_shift</span><span class="p">,</span>
            <span class="n">fractional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_create_supercell</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">substrate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Structure</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">substrate</span><span class="p">:</span>
            <span class="n">matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">match</span><span class="o">.</span><span class="n">substrate_sl_transform</span>
            <span class="n">supercell</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">_non_orthogonal_slab_structure</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">basis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">uvw_basis</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">match</span><span class="o">.</span><span class="n">film_sl_transform</span>
            <span class="n">supercell</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">film</span><span class="o">.</span><span class="n">_non_orthogonal_slab_structure</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">basis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">film</span><span class="o">.</span><span class="n">uvw_basis</span>

        <span class="n">supercell</span><span class="o">.</span><span class="n">make_supercell</span><span class="p">(</span><span class="n">scaling_matrix</span><span class="o">=</span><span class="n">matrix</span><span class="p">)</span>

        <span class="n">uvw_supercell</span> <span class="o">=</span> <span class="n">matrix</span> <span class="o">@</span> <span class="n">basis</span>
        <span class="n">scale_factors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">uvw_supercell</span><span class="p">):</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">reduce</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">_float_gcd</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
            <span class="n">uvw_supercell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">uvw_supercell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">scale</span>
            <span class="n">scale_factors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">supercell</span><span class="p">,</span> <span class="n">uvw_supercell</span><span class="p">,</span> <span class="n">scale_factors</span>

    <span class="k">def</span> <span class="nf">_orient_supercell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">supercell</span><span class="p">:</span> <span class="n">Structure</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="n">matrix</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">supercell</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span><span class="p">)</span>

        <span class="n">a_norm</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">a_to_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[[</span><span class="n">a_norm</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">a_norm</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">a_norm</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">a_norm</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">T</span>

        <span class="n">a_to_i_operation</span> <span class="o">=</span> <span class="n">SymmOp</span><span class="o">.</span><span class="n">from_rotation_and_translation</span><span class="p">(</span>
            <span class="n">a_to_i</span><span class="p">,</span> <span class="n">translation_vec</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">supercell</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span><span class="n">a_to_i_operation</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">a_to_i</span>

    <span class="k">def</span> <span class="nf">_prepare_substrate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Structure</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
        <span class="n">matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">match</span><span class="o">.</span><span class="n">substrate_sl_transform</span>
        <span class="n">supercell_slab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">_non_orthogonal_slab_structure</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">supercell_slab</span><span class="o">.</span><span class="n">make_supercell</span><span class="p">(</span><span class="n">scaling_matrix</span><span class="o">=</span><span class="n">matrix</span><span class="p">)</span>

        <span class="n">uvw_supercell</span> <span class="o">=</span> <span class="n">matrix</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">uvw_basis</span>
        <span class="n">scale_factors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">uvw_supercell</span><span class="p">):</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">reduce</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">_float_gcd</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
            <span class="n">uvw_supercell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">uvw_supercell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">scale</span>
            <span class="n">scale_factors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">supercell_slab</span><span class="p">,</span> <span class="n">uvw_supercell</span><span class="p">,</span> <span class="n">scale_factors</span>

    <span class="k">def</span> <span class="nf">_prepare_film</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Structure</span><span class="p">:</span>
        <span class="n">supercell_slab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_film_supercell</span>
        <span class="n">sc_matrix</span> <span class="o">=</span> <span class="n">supercell_slab</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span>
        <span class="n">sub_sc_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substrate_supercell</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span>

        <span class="n">sub_non_orth_c_vec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_substrate_supercell</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">sub_non_orth_c_norm</span> <span class="o">=</span> <span class="n">sub_non_orth_c_vec</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span>
            <span class="n">sub_non_orth_c_vec</span>
        <span class="p">)</span>

        <span class="n">norm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">film</span><span class="o">.</span><span class="n">surface_normal</span>
        <span class="n">proj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">norm</span><span class="p">,</span> <span class="n">sub_non_orth_c_norm</span><span class="p">)</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">supercell_slab</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span> <span class="n">proj</span>

        <span class="n">new_c_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">sc_matrix</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">sub_non_orth_c_norm</span> <span class="o">*</span> <span class="n">scale</span><span class="p">])</span>

        <span class="n">oriented_film</span> <span class="o">=</span> <span class="n">Structure</span><span class="p">(</span>
            <span class="n">lattice</span><span class="o">=</span><span class="n">Lattice</span><span class="p">(</span><span class="n">new_c_matrix</span><span class="p">),</span>
            <span class="n">species</span><span class="o">=</span><span class="n">supercell_slab</span><span class="o">.</span><span class="n">species</span><span class="p">,</span>
            <span class="n">coords</span><span class="o">=</span><span class="n">supercell_slab</span><span class="o">.</span><span class="n">cart_coords</span><span class="p">,</span>
            <span class="n">coords_are_cartesian</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">to_unit_cell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">site_properties</span><span class="o">=</span><span class="n">supercell_slab</span><span class="o">.</span><span class="n">site_properties</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">strained_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">sub_sc_matrix</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span>
                <span class="n">oriented_film</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="n">init_volume</span> <span class="o">=</span> <span class="n">oriented_film</span><span class="o">.</span><span class="n">volume</span>
        <span class="n">strain_volume</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">strained_matrix</span><span class="p">))</span>
        <span class="n">scale_factor</span> <span class="o">=</span> <span class="n">init_volume</span> <span class="o">/</span> <span class="n">strain_volume</span>

        <span class="c1"># Maintain constant volume</span>
        <span class="n">strained_matrix</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*=</span> <span class="n">scale_factor</span>

        <span class="n">strained_film</span> <span class="o">=</span> <span class="n">Structure</span><span class="p">(</span>
            <span class="n">lattice</span><span class="o">=</span><span class="n">Lattice</span><span class="p">(</span><span class="n">strained_matrix</span><span class="p">),</span>
            <span class="n">species</span><span class="o">=</span><span class="n">oriented_film</span><span class="o">.</span><span class="n">species</span><span class="p">,</span>
            <span class="n">coords</span><span class="o">=</span><span class="n">oriented_film</span><span class="o">.</span><span class="n">frac_coords</span><span class="p">,</span>
            <span class="n">coords_are_cartesian</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">to_unit_cell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">site_properties</span><span class="o">=</span><span class="n">supercell_slab</span><span class="o">.</span><span class="n">site_properties</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">strained_film</span>

    <span class="k">def</span> <span class="nf">_prepare_film_old</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Structure</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
        <span class="n">matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">match</span><span class="o">.</span><span class="n">film_sl_transform</span>
        <span class="n">supercell_slab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">film</span><span class="o">.</span><span class="n">_non_orthogonal_slab_structure</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">supercell_slab</span><span class="o">.</span><span class="n">make_supercell</span><span class="p">(</span><span class="n">scaling_matrix</span><span class="o">=</span><span class="n">matrix</span><span class="p">)</span>

        <span class="n">sc_matrix</span> <span class="o">=</span> <span class="n">supercell_slab</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span>
        <span class="n">sub_non_orth_c_vec</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">_non_orthogonal_slab_structure</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">sub_non_orth_c_norm</span> <span class="o">=</span> <span class="n">sub_non_orth_c_vec</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span>
            <span class="n">sub_non_orth_c_vec</span>
        <span class="p">)</span>

        <span class="n">norm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">film</span><span class="o">.</span><span class="n">surface_normal</span>
        <span class="n">proj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">norm</span><span class="p">,</span> <span class="n">sub_non_orth_c_norm</span><span class="p">)</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">film</span><span class="o">.</span><span class="n">_orthogonal_slab_structure</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">c</span> <span class="o">/</span> <span class="n">proj</span>

        <span class="n">new_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">sc_matrix</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">sub_non_orth_c_norm</span> <span class="o">*</span> <span class="n">scale</span><span class="p">])</span>

        <span class="n">oriented_supercell_slab</span> <span class="o">=</span> <span class="n">Structure</span><span class="p">(</span>
            <span class="n">lattice</span><span class="o">=</span><span class="n">Lattice</span><span class="p">(</span><span class="n">new_matrix</span><span class="p">),</span>
            <span class="n">species</span><span class="o">=</span><span class="n">supercell_slab</span><span class="o">.</span><span class="n">species</span><span class="p">,</span>
            <span class="n">coords</span><span class="o">=</span><span class="n">supercell_slab</span><span class="o">.</span><span class="n">cart_coords</span><span class="p">,</span>
            <span class="n">coords_are_cartesian</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">to_unit_cell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">site_properties</span><span class="o">=</span><span class="n">supercell_slab</span><span class="o">.</span><span class="n">site_properties</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">uvw_supercell</span> <span class="o">=</span> <span class="n">matrix</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">film</span><span class="o">.</span><span class="n">uvw_basis</span>
        <span class="n">scale_factors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">uvw_supercell</span><span class="p">):</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">reduce</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">_float_gcd</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span>
            <span class="n">uvw_supercell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">uvw_supercell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">scale</span>
            <span class="n">scale_factors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">oriented_supercell_slab</span><span class="p">,</span> <span class="n">uvw_supercell</span><span class="p">,</span> <span class="n">scale_factors</span>

    <span class="c1"># def _strain_and_orient_film(self) -&gt; Tuple[Structure, np.ndarray]:</span>
    <span class="c1">#     sub_in_plane_vecs = self._substrate_supercell.lattice.matrix[:2]</span>
    <span class="c1">#     film_out_of_plane = self._film_supercell.lattice.matrix[-1]</span>
    <span class="c1"># film_inv_matrix = self._film_supercell.lattice.inv_matrix</span>
    <span class="c1"># new_matrix = np.vstack([sub_in_plane_vecs, film_out_of_plane])</span>
    <span class="c1"># transform = (film_inv_matrix @ new_matrix).T</span>
    <span class="c1">#     print(transform)</span>
    <span class="c1"># op = SymmOp.from_rotation_and_translation(</span>
    <span class="c1">#     transform, translation_vec=np.zeros(3)</span>
    <span class="c1"># )</span>

    <span class="c1"># strained_film = deepcopy(self._film_supercell)</span>
    <span class="c1"># strained_film.apply_operation(op)</span>

    <span class="c1">#     return strained_film, transform</span>

    <span class="c1"># def _strain_and_orient_film(self) -&gt; Tuple[Structure, np.ndarray]:</span>
    <span class="c1">#     sub_matrix = deepcopy(self._substrate_supercell.lattice.matrix)</span>
    <span class="c1">#     film_matrix = deepcopy(self._film_supercell.lattice.matrix)</span>

    <span class="c1">#     sub_a = sub_matrix[0] / np.linalg.norm(sub_matrix[0])</span>
    <span class="c1">#     film_a = film_matrix[0] / np.linalg.norm(film_matrix[0])</span>

    <span class="c1">#     normal = self.film.surface_normal</span>

    <span class="c1">#     sub_b = np.cross(sub_a, normal)</span>
    <span class="c1">#     sub_b /= np.linalg.norm(sub_b)</span>

    <span class="c1">#     film_b = np.cross(film_a, normal)</span>
    <span class="c1">#     film_b /= np.linalg.norm(film_b)</span>

    <span class="c1">#     sub_ortho_basis = np.vstack(</span>
    <span class="c1">#         [</span>
    <span class="c1">#             sub_a,</span>
    <span class="c1">#             sub_b,</span>
    <span class="c1">#             normal,</span>
    <span class="c1">#         ]</span>
    <span class="c1">#     )</span>

    <span class="c1">#     film_ortho_basis = np.vstack(</span>
    <span class="c1">#         [</span>
    <span class="c1">#             film_a,</span>
    <span class="c1">#             film_b,</span>
    <span class="c1">#             normal,</span>
    <span class="c1">#         ]</span>
    <span class="c1">#     )</span>

    <span class="c1">#     rotation = (np.linalg.inv(film_ortho_basis) @ sub_ortho_basis).T</span>

    <span class="c1">#     op = SymmOp.from_rotation_and_translation(</span>
    <span class="c1">#         rotation, translation_vec=np.zeros(3)</span>
    <span class="c1">#     )</span>

    <span class="c1">#     rotated_film = deepcopy(self._film_supercell)</span>
    <span class="c1">#     rotated_film.apply_operation(op)</span>

    <span class="c1">#     old_matrix = np.vstack([film_matrix[:2], normal])</span>
    <span class="c1">#     new_matrix = np.vstack([sub_matrix[:2], normal])</span>
    <span class="c1">#     transform = (np.linalg.inv(old_matrix) @ new_matrix).T</span>

    <span class="c1">#     # Poscar(self._film_supercell).write_file(&quot;POSCAR_film_init&quot;)</span>

    <span class="c1">#     # strained_film = Structure(</span>
    <span class="c1">#     #     lattice=Lattice(new_matrix),</span>
    <span class="c1">#     #     species=self._film_supercell.species,</span>
    <span class="c1">#     #     coords=self._film_supercell.frac_coords,</span>
    <span class="c1">#     #     to_unit_cell=True,</span>
    <span class="c1">#     #     coords_are_cartesian=False,</span>
    <span class="c1">#     #     site_properties=self._film_supercell.site_properties,</span>
    <span class="c1">#     # )</span>
    <span class="c1">#     # Poscar(strained_film).write_file(&quot;POSCAR_str_film&quot;)</span>

    <span class="c1">#     return (</span>
    <span class="c1">#         rotated_film,</span>
    <span class="c1">#         transform,</span>
    <span class="c1">#     )</span>

    <span class="k">def</span> <span class="nf">_stack_interface</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span>
        <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">Structure</span><span class="p">,</span>
        <span class="n">Structure</span><span class="p">,</span>
        <span class="n">Structure</span><span class="p">,</span>
        <span class="n">Atoms</span><span class="p">,</span>
        <span class="n">Atoms</span><span class="p">,</span>
        <span class="n">Atoms</span><span class="p">,</span>
        <span class="n">Structure</span><span class="p">,</span>
        <span class="n">Structure</span><span class="p">,</span>
        <span class="n">Structure</span><span class="p">,</span>
        <span class="n">Atoms</span><span class="p">,</span>
        <span class="n">Atoms</span><span class="p">,</span>
        <span class="n">Atoms</span><span class="p">,</span>
    <span class="p">]:</span>

        <span class="c1"># Get the strained substrate and film</span>
        <span class="n">strained_sub</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strained_sub</span>
        <span class="n">strained_film</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strained_film</span>

        <span class="c1"># Get the oriented bulk structure of the substrate</span>
        <span class="n">oriented_bulk_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">oriented_bulk_structure</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">c</span>

        <span class="c1"># Get the normalized projection of the substrate c-vector onto the normal vector,</span>
        <span class="c1"># This is used to determine the length of the non-orthogonal c-vector in order to get</span>
        <span class="c1"># the correct vacuum size.</span>
        <span class="n">c_norm_proj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">c_projection</span> <span class="o">/</span> <span class="n">oriented_bulk_c</span>

        <span class="c1"># Get the substrate matrix and c-vector</span>
        <span class="n">sub_matrix</span> <span class="o">=</span> <span class="n">strained_sub</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span>
        <span class="n">sub_c</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">sub_matrix</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># Get the fractional and cartesian coordinates of the substrate and film</span>
        <span class="n">strained_sub_coords</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">strained_sub</span><span class="o">.</span><span class="n">cart_coords</span><span class="p">)</span>
        <span class="n">strained_film_coords</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">strained_film</span><span class="o">.</span><span class="n">cart_coords</span><span class="p">)</span>
        <span class="n">strained_sub_frac_coords</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">strained_sub</span><span class="o">.</span><span class="n">frac_coords</span><span class="p">)</span>
        <span class="n">strained_film_frac_coords</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">strained_film</span><span class="o">.</span><span class="n">frac_coords</span><span class="p">)</span>

        <span class="c1"># Find the min and max coordinates of the substrate and film</span>
        <span class="n">min_sub_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">strained_sub_frac_coords</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">max_sub_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">strained_sub_frac_coords</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">min_film_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">strained_film_frac_coords</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">max_film_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">strained_film_frac_coords</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># Get the lengths of the c-vetors of the substrate and film</span>
        <span class="n">sub_c_len</span> <span class="o">=</span> <span class="n">strained_sub</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">c</span>
        <span class="n">film_c_len</span> <span class="o">=</span> <span class="n">strained_film</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">c</span>

        <span class="c1"># Find the total length of the interface structure including the interfacial distance</span>
        <span class="n">interface_structure_len</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">(</span><span class="n">max_sub_coords</span> <span class="o">-</span> <span class="n">min_sub_coords</span><span class="p">)</span> <span class="o">*</span> <span class="n">sub_c_len</span><span class="p">,</span>
                <span class="p">(</span><span class="n">max_film_coords</span> <span class="o">-</span> <span class="n">min_film_coords</span><span class="p">)</span> <span class="o">*</span> <span class="n">film_c_len</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">interfacial_distance</span> <span class="o">/</span> <span class="n">c_norm_proj</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="c1"># Find the length of the vacuum region in the non-orthogonal basis</span>
        <span class="n">interface_vacuum_len</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vacuum</span> <span class="o">/</span> <span class="n">c_norm_proj</span>

        <span class="c1"># The total length of the interface c-vector should be the length of the structure + length of the vacuum</span>
        <span class="c1"># This will get changed in the next line to be exactly an integer multiple of the</span>
        <span class="c1"># oriented bulk cell of the substrate</span>
        <span class="n">init_interface_c_len</span> <span class="o">=</span> <span class="n">interface_structure_len</span> <span class="o">+</span> <span class="n">interface_vacuum_len</span>

        <span class="c1"># Find the closest integer multiple of the substrate oriented bulk c-vector length</span>
        <span class="n">n_unit_cell</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">init_interface_c_len</span> <span class="o">/</span> <span class="n">oriented_bulk_c</span><span class="p">))</span>

        <span class="c1"># Make the new interface c-vector length an integer multiple of the oriented bulk c-vector</span>
        <span class="n">interface_c_len</span> <span class="o">=</span> <span class="n">oriented_bulk_c</span> <span class="o">*</span> <span class="n">n_unit_cell</span>

        <span class="c1"># Create the transformation matrix from the primtive bulk structure to the interface unit cell</span>
        <span class="c1"># this is only needed for band unfolding purposes</span>
        <span class="n">sub_M</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">_transformation_matrix</span>
        <span class="n">layer_M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">layer_M</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_unit_cell</span>
        <span class="n">interface_M</span> <span class="o">=</span> <span class="n">layer_M</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">match</span><span class="o">.</span><span class="n">substrate_sl_transform</span> <span class="o">@</span> <span class="n">sub_M</span>

        <span class="c1"># Create the new interface lattice vectors</span>
        <span class="n">interface_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span>
            <span class="p">[</span><span class="n">sub_matrix</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">interface_c_len</span> <span class="o">*</span> <span class="p">(</span><span class="n">sub_c</span> <span class="o">/</span> <span class="n">sub_c_len</span><span class="p">)]</span>
        <span class="p">)</span>
        <span class="n">interface_lattice</span> <span class="o">=</span> <span class="n">Lattice</span><span class="p">(</span><span class="n">matrix</span><span class="o">=</span><span class="n">interface_matrix</span><span class="p">)</span>

        <span class="c1"># Convert the interfacial distance into fractional coordinated because they are easier to work with</span>
        <span class="n">frac_int_distance_shift</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">interfacial_distance</span><span class="p">]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">interface_lattice</span><span class="o">.</span><span class="n">inv_matrix</span><span class="p">)</span>

        <span class="n">interface_inv_matrix</span> <span class="o">=</span> <span class="n">interface_lattice</span><span class="o">.</span><span class="n">inv_matrix</span>

        <span class="c1"># Convert the substrate cartesian coordinates into the interface fractional coordinates</span>
        <span class="c1"># and shift the bottom atom c-position to zero</span>
        <span class="n">sub_interface_coords</span> <span class="o">=</span> <span class="n">strained_sub_coords</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">interface_inv_matrix</span><span class="p">)</span>
        <span class="n">sub_interface_coords</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">sub_interface_coords</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

        <span class="c1"># Convert the film cartesian coordinates into the interface fractional coordinates</span>
        <span class="c1"># and shift the bottom atom c-position to the top substrate c-position + interfacial distance</span>
        <span class="n">film_interface_coords</span> <span class="o">=</span> <span class="n">strained_film_coords</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">interface_inv_matrix</span><span class="p">)</span>
        <span class="n">film_interface_coords</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">film_interface_coords</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">film_interface_coords</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">sub_interface_coords</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="n">film_interface_coords</span> <span class="o">+=</span> <span class="n">frac_int_distance_shift</span>

        <span class="c1"># Combine the coodinates, species, and site_properties to make the interface Structure</span>
        <span class="n">interface_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="n">sub_interface_coords</span><span class="p">,</span> <span class="n">film_interface_coords</span><span class="p">]</span>
        <span class="n">interface_species</span> <span class="o">=</span> <span class="n">strained_sub</span><span class="o">.</span><span class="n">species</span> <span class="o">+</span> <span class="n">strained_film</span><span class="o">.</span><span class="n">species</span>
        <span class="n">interface_site_properties</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">key</span><span class="p">:</span> <span class="n">strained_sub</span><span class="o">.</span><span class="n">site_properties</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="o">+</span> <span class="n">strained_film</span><span class="o">.</span><span class="n">site_properties</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">strained_sub</span><span class="o">.</span><span class="n">site_properties</span>
        <span class="p">}</span>
        <span class="n">interface_site_properties</span><span class="p">[</span><span class="s2">&quot;is_sub&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">strained_sub</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">strained_film</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">interface_site_properties</span><span class="p">[</span><span class="s2">&quot;is_film&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="kc">False</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">strained_sub</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">strained_film</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Create the non-orthogonalized interface structure</span>
        <span class="n">non_ortho_interface_struc</span> <span class="o">=</span> <span class="n">Structure</span><span class="p">(</span>
            <span class="n">lattice</span><span class="o">=</span><span class="n">interface_lattice</span><span class="p">,</span>
            <span class="n">species</span><span class="o">=</span><span class="n">interface_species</span><span class="p">,</span>
            <span class="n">coords</span><span class="o">=</span><span class="n">interface_coords</span><span class="p">,</span>
            <span class="n">to_unit_cell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">coords_are_cartesian</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">site_properties</span><span class="o">=</span><span class="n">interface_site_properties</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">non_ortho_interface_struc</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

        <span class="n">non_ortho_interface_struc</span><span class="o">.</span><span class="n">add_site_property</span><span class="p">(</span>
            <span class="s2">&quot;interface_equivalent&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">non_ortho_interface_struc</span><span class="p">)))</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">:</span>
            <span class="c1"># Get the new vacuum length, needed for shifting</span>
            <span class="n">vacuum_len</span> <span class="o">=</span> <span class="n">interface_c_len</span> <span class="o">-</span> <span class="n">interface_structure_len</span>

            <span class="c1"># Find the fractional coordinates of shifting the structure up by half the amount of vacuum cells</span>
            <span class="n">center_shift</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">vacuum_len</span> <span class="o">/</span> <span class="n">oriented_bulk_c</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
            <span class="n">center_shift</span> <span class="o">*=</span> <span class="n">oriented_bulk_c</span> <span class="o">/</span> <span class="n">interface_c_len</span>

            <span class="c1"># Center the structure in the vacuum</span>
            <span class="n">non_ortho_interface_struc</span><span class="o">.</span><span class="n">translate_sites</span><span class="p">(</span>
                <span class="n">indices</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">non_ortho_interface_struc</span><span class="p">)),</span>
                <span class="n">vector</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">center_shift</span><span class="p">],</span>
                <span class="n">frac_coords</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">to_unit_cell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># Get the frac coords of the non-orthogonalized interface</span>
        <span class="n">frac_coords</span> <span class="o">=</span> <span class="n">non_ortho_interface_struc</span><span class="o">.</span><span class="n">frac_coords</span>

        <span class="c1"># Find the max c-coord of the substrate</span>
        <span class="c1"># This is used to shift the x-y positions of the interface structure so the top atom of the substrate</span>
        <span class="c1"># is located at x=0, y=0. This will have no effect of the properties of the interface since all the</span>
        <span class="c1"># atoms are shifted, it is more of a visual thing to make the interfaces look nice.</span>
        <span class="n">is_sub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">non_ortho_interface_struc</span><span class="o">.</span><span class="n">site_properties</span><span class="p">[</span><span class="s2">&quot;is_sub&quot;</span><span class="p">])</span>
        <span class="n">sub_frac_coords</span> <span class="o">=</span> <span class="n">frac_coords</span><span class="p">[</span><span class="n">is_sub</span><span class="p">]</span>
        <span class="n">max_c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">sub_frac_coords</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># Find the xy-shift in cartesian coordinates</span>
        <span class="n">cart_shift</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">max_c</span><span class="p">])</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span>
            <span class="n">non_ortho_interface_struc</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span>
        <span class="p">)</span>
        <span class="n">cart_shift</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="c1"># Get the projection of the non-orthogonal c-vector onto the surface normal</span>
        <span class="n">proj_c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">surface_normal</span><span class="p">,</span>
            <span class="n">non_ortho_interface_struc</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="c1"># Get the orthogonalized c-vector of the interface (this conserves the vacuum, but breaks symmetries)</span>
        <span class="n">ortho_c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">surface_normal</span> <span class="o">*</span> <span class="n">proj_c</span>

        <span class="c1"># Create the orthogonalized lattice vectors</span>
        <span class="n">new_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">non_ortho_interface_struc</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span>
                <span class="n">ortho_c</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="c1"># Create the orthogonalized structure</span>
        <span class="n">ortho_interface_struc</span> <span class="o">=</span> <span class="n">Structure</span><span class="p">(</span>
            <span class="n">lattice</span><span class="o">=</span><span class="n">Lattice</span><span class="p">(</span><span class="n">new_matrix</span><span class="p">),</span>
            <span class="n">species</span><span class="o">=</span><span class="n">non_ortho_interface_struc</span><span class="o">.</span><span class="n">species</span><span class="p">,</span>
            <span class="n">coords</span><span class="o">=</span><span class="n">non_ortho_interface_struc</span><span class="o">.</span><span class="n">cart_coords</span><span class="p">,</span>
            <span class="n">site_properties</span><span class="o">=</span><span class="n">non_ortho_interface_struc</span><span class="o">.</span><span class="n">site_properties</span><span class="p">,</span>
            <span class="n">to_unit_cell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">coords_are_cartesian</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Shift the structure so the top substrate atom&#39;s x and y postions are zero, similar to the non-orthogonalized structure</span>
        <span class="n">ortho_interface_struc</span><span class="o">.</span><span class="n">translate_sites</span><span class="p">(</span>
            <span class="n">indices</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ortho_interface_struc</span><span class="p">)),</span>
            <span class="n">vector</span><span class="o">=-</span><span class="n">cart_shift</span><span class="p">,</span>
            <span class="n">frac_coords</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">to_unit_cell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># The next step is used extract on the film and substrate portions of the interface</span>
        <span class="c1"># These can be used for charge transfer calculation</span>
        <span class="p">(</span>
            <span class="n">ortho_film_structure</span><span class="p">,</span>
            <span class="n">ortho_film_atoms</span><span class="p">,</span>
            <span class="n">ortho_sub_structure</span><span class="p">,</span>
            <span class="n">ortho_sub_atoms</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_film_and_substrate_parts</span><span class="p">(</span><span class="n">ortho_interface_struc</span><span class="p">)</span>
        <span class="p">(</span>
            <span class="n">non_ortho_film_structure</span><span class="p">,</span>
            <span class="n">non_ortho_film_atoms</span><span class="p">,</span>
            <span class="n">non_ortho_sub_structure</span><span class="p">,</span>
            <span class="n">non_ortho_sub_atoms</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_film_and_substrate_parts</span><span class="p">(</span><span class="n">non_ortho_interface_struc</span><span class="p">)</span>

        <span class="n">non_ortho_interface_atoms</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_atoms</span><span class="p">(</span><span class="n">non_ortho_interface_struc</span><span class="p">)</span>
        <span class="n">ortho_interface_atoms</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_atoms</span><span class="p">(</span><span class="n">ortho_interface_struc</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="n">interface_M</span><span class="p">,</span>
            <span class="n">non_ortho_interface_struc</span><span class="p">,</span>
            <span class="n">non_ortho_sub_structure</span><span class="p">,</span>
            <span class="n">non_ortho_film_structure</span><span class="p">,</span>
            <span class="n">non_ortho_interface_atoms</span><span class="p">,</span>
            <span class="n">non_ortho_sub_atoms</span><span class="p">,</span>
            <span class="n">non_ortho_film_atoms</span><span class="p">,</span>
            <span class="n">ortho_interface_struc</span><span class="p">,</span>
            <span class="n">ortho_sub_structure</span><span class="p">,</span>
            <span class="n">ortho_film_structure</span><span class="p">,</span>
            <span class="n">ortho_interface_atoms</span><span class="p">,</span>
            <span class="n">ortho_sub_atoms</span><span class="p">,</span>
            <span class="n">ortho_film_atoms</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_film_and_substrate_parts</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">interface</span><span class="p">:</span> <span class="n">Structure</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Structure</span><span class="p">,</span> <span class="n">Atoms</span><span class="p">,</span> <span class="n">Structure</span><span class="p">,</span> <span class="n">Atoms</span><span class="p">]:</span>
        <span class="n">film_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">interface</span><span class="o">.</span><span class="n">site_properties</span><span class="p">[</span><span class="s2">&quot;is_film&quot;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">sub_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">interface</span><span class="o">.</span><span class="n">site_properties</span><span class="p">[</span><span class="s2">&quot;is_sub&quot;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">film_structure</span> <span class="o">=</span> <span class="n">interface</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">film_structure</span><span class="o">.</span><span class="n">remove_sites</span><span class="p">(</span><span class="n">sub_inds</span><span class="p">)</span>
        <span class="n">film_atoms</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_atoms</span><span class="p">(</span><span class="n">film_structure</span><span class="p">)</span>

        <span class="n">sub_structure</span> <span class="o">=</span> <span class="n">interface</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">sub_structure</span><span class="o">.</span><span class="n">remove_sites</span><span class="p">(</span><span class="n">film_inds</span><span class="p">)</span>
        <span class="n">sub_atoms</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_atoms</span><span class="p">(</span><span class="n">sub_structure</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">film_structure</span><span class="p">,</span> <span class="n">film_atoms</span><span class="p">,</span> <span class="n">sub_structure</span><span class="p">,</span> <span class="n">sub_atoms</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">_metallic_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">elements_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="s2">&quot;Li&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Be&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Na&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Mg&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Al&quot;</span><span class="p">,</span>
                <span class="s2">&quot;K&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Ca&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Sc&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Ti&quot;</span><span class="p">,</span>
                <span class="s2">&quot;V&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Cr&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Mn&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Fe&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Co&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Ni&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Cu&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Zn&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Ga&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Rb&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Sr&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Y&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Zr&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Nb&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Mo&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Tc&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Ru&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Rh&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Pd&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Ag&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Cd&quot;</span><span class="p">,</span>
                <span class="s2">&quot;In&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Sn&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Cs&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Ba&quot;</span><span class="p">,</span>
                <span class="s2">&quot;La&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Ce&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Pr&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Nd&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Pm&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Sm&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Eu&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Gd&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Tb&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Dy&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Ho&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Er&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Tm&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Yb&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Lu&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Hf&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Ta&quot;</span><span class="p">,</span>
                <span class="s2">&quot;W&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Re&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Os&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Ir&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Pt&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Au&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Hg&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Tl&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Pb&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Bi&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Rn&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Fr&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Ra&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Ac&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Th&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Pa&quot;</span><span class="p">,</span>
                <span class="s2">&quot;U&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Np&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Pu&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Am&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Cm&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Bk&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Cf&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Es&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Fm&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Md&quot;</span><span class="p">,</span>
                <span class="s2">&quot;No&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Lr&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Rf&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Db&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Sg&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Bh&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Hs&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Mt&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Ds &quot;</span><span class="p">,</span>
                <span class="s2">&quot;Rg &quot;</span><span class="p">,</span>
                <span class="s2">&quot;Cn &quot;</span><span class="p">,</span>
                <span class="s2">&quot;Nh&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Fl&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Mc&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Lv&quot;</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">elements_list</span>

    <span class="k">def</span> <span class="nf">_get_radii</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">sub_species</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">bulk_structure</span><span class="o">.</span><span class="n">species</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">film_species</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">film</span><span class="o">.</span><span class="n">bulk_structure</span><span class="o">.</span><span class="n">species</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">sub_elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">Element</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sub_species</span><span class="p">]</span>
        <span class="n">film_elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">Element</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">film_species</span><span class="p">]</span>

        <span class="n">sub_metal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">sub_species</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metallic_elements</span><span class="p">)</span>
        <span class="n">film_metal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">film_species</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_metallic_elements</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">sub_metal</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="n">sub_dict</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">sub_species</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span> <span class="n">sub_elements</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">metallic_radius</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_elements</span><span class="p">))</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Xs</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">X</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">sub_elements</span><span class="p">]</span>
            <span class="n">X_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">([</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">Xs</span><span class="p">,</span> <span class="mi">2</span><span class="p">)])</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">X_diff</span> <span class="o">&gt;=</span> <span class="mf">1.7</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="n">sub_dict</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">sub_species</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span> <span class="n">sub_elements</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">average_ionic_radius</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sub_elements</span><span class="p">))</span>
                <span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sub_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="p">:</span> <span class="n">CovalentRadius</span><span class="o">.</span><span class="n">radius</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">sub_species</span><span class="p">}</span>

        <span class="k">if</span> <span class="n">film_metal</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="n">film_dict</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">film_species</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span> <span class="n">film_elements</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">metallic_radius</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">film_elements</span><span class="p">))</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Xs</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">X</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">film_elements</span><span class="p">]</span>
            <span class="n">X_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">([</span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="n">Xs</span><span class="p">,</span> <span class="mi">2</span><span class="p">)])</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">X_diff</span> <span class="o">&gt;=</span> <span class="mf">1.7</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
                <span class="n">film_dict</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">film_species</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span> <span class="n">film_elements</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">average_ionic_radius</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">film_elements</span><span class="p">))</span>
                <span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">film_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">f</span><span class="p">:</span> <span class="n">CovalentRadius</span><span class="o">.</span><span class="n">radius</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">film_species</span><span class="p">}</span>

        <span class="n">sub_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">film_dict</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">sub_dict</span>

    <span class="k">def</span> <span class="nf">_generate_sc_for_interface_view</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">struc</span><span class="p">,</span> <span class="n">transformation_matrix</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Structure</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
        <span class="n">plot_struc</span> <span class="o">=</span> <span class="n">Structure</span><span class="p">(</span>
            <span class="n">lattice</span><span class="o">=</span><span class="n">struc</span><span class="o">.</span><span class="n">lattice</span><span class="p">,</span>
            <span class="n">species</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">],</span>
            <span class="n">coords</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
            <span class="n">to_unit_cell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">coords_are_cartesian</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plot_struc</span><span class="o">.</span><span class="n">make_supercell</span><span class="p">(</span><span class="n">transformation_matrix</span><span class="p">)</span>
        <span class="n">inv_matrix</span> <span class="o">=</span> <span class="n">plot_struc</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">inv_matrix</span>

        <span class="k">return</span> <span class="n">plot_struc</span><span class="p">,</span> <span class="n">inv_matrix</span>

    <span class="k">def</span> <span class="nf">_plot_interface_view</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">,</span>
        <span class="n">zero_coord</span><span class="p">,</span>
        <span class="n">supercell_shift</span><span class="p">,</span>
        <span class="n">cell_vetices</span><span class="p">,</span>
        <span class="n">slab_matrix</span><span class="p">,</span>
        <span class="n">sc_inv_matrix</span><span class="p">,</span>
        <span class="n">facecolor</span><span class="p">,</span>
        <span class="n">edgecolor</span><span class="p">,</span>
        <span class="n">is_film</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">strain</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cart_coords</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">zero_coord</span> <span class="o">+</span> <span class="n">supercell_shift</span> <span class="o">+</span> <span class="n">cell_vetices</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">slab_matrix</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">fc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">cart_coords</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">sc_inv_matrix</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_film</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">strain</span><span class="p">:</span>
                <span class="n">strain_matrix</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_film_supercell</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">inv_matrix</span>
                    <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">_strained_sub</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span>
                <span class="p">)</span>
                <span class="n">strain_matrix</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
                <span class="n">plot_coords</span> <span class="o">=</span> <span class="n">cart_coords</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">strain_matrix</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plot_coords</span> <span class="o">=</span> <span class="n">cart_coords</span>

            <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plot_coords</span> <span class="o">=</span> <span class="n">cart_coords</span>
            <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">2.0</span>

        <span class="n">center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cart_coords</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">sc_inv_matrix</span><span class="p">),</span>
            <span class="mi">3</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">center_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="o">-</span><span class="mf">0.0001</span> <span class="o">&lt;=</span> <span class="n">center</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">center</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">1.0001</span><span class="p">)</span>

        <span class="n">x_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">fc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">fc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">y_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">fc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">fc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">point_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">x_in</span><span class="p">,</span> <span class="n">y_in</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">point_in</span><span class="o">.</span><span class="n">any</span><span class="p">()</span> <span class="ow">or</span> <span class="n">center_in</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="n">poly</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span>
                <span class="n">xy</span><span class="o">=</span><span class="n">plot_coords</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">2</span><span class="p">],</span>
                <span class="n">closed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">facecolor</span><span class="o">=</span><span class="n">facecolor</span><span class="p">,</span>
                <span class="n">edgecolor</span><span class="o">=</span><span class="n">edgecolor</span><span class="p">,</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_interface</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">output</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;interface_view.png&quot;</span><span class="p">,</span>
        <span class="n">strain</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">dpi</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span>
        <span class="n">show_in_colab</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function will show the relative alignment of the film and substrate supercells by plotting the in-plane unit cells on top of each other</span>

<span class="sd">        Args:</span>
<span class="sd">            output: File path for the output image</span>
<span class="sd">            strain: Determines if the film lattice should be strained so it shows perfectly aligned lattice coincidence sites,</span>
<span class="sd">                or if the film lattice should be unstrained, giving a better visual of the lattice mismatch.</span>
<span class="sd">            dpi: dpi (dots per inch) of the output image.</span>
<span class="sd">                Setting dpi=100 gives reasonably sized images when viewed in colab notebook</span>
<span class="sd">            show_in_colab: Determines if the matplotlib figure is closed or not after the plot if made.</span>
<span class="sd">                if show_in_colab=True the plot will show up after you run the cell in colab/jupyter notebook.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sub_struc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">_orthogonal_slab_structure</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">sub_a_to_i_op</span> <span class="o">=</span> <span class="n">SymmOp</span><span class="o">.</span><span class="n">from_rotation_and_translation</span><span class="p">(</span>
            <span class="n">rotation_matrix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_substrate_a_to_i</span><span class="p">,</span> <span class="n">translation_vec</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">sub_struc</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span><span class="n">sub_a_to_i_op</span><span class="p">)</span>

        <span class="n">film_struc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">film</span><span class="o">.</span><span class="n">_orthogonal_slab_structure</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">film_a_to_i_op</span> <span class="o">=</span> <span class="n">SymmOp</span><span class="o">.</span><span class="n">from_rotation_and_translation</span><span class="p">(</span>
            <span class="n">rotation_matrix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_film_a_to_i</span><span class="p">,</span> <span class="n">translation_vec</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">film_struc</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span><span class="n">film_a_to_i_op</span><span class="p">)</span>

        <span class="n">sub_matrix</span> <span class="o">=</span> <span class="n">sub_struc</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span>
        <span class="n">film_matrix</span> <span class="o">=</span> <span class="n">film_struc</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span>

        <span class="n">sub_sc_matrix</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_substrate_supercell</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span><span class="p">)</span>
        <span class="n">film_sc_matrix</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_film_supercell</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span><span class="p">)</span>

        <span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="n">sc_shifts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="n">sub_sc_shifts</span> <span class="o">=</span> <span class="n">sc_shifts</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">sub_sc_matrix</span><span class="p">)</span>
        <span class="n">film_sc_shifts</span> <span class="o">=</span> <span class="n">sc_shifts</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">film_sc_matrix</span><span class="p">)</span>
        <span class="n">sub_sl</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">sub_sc_matrix</span><span class="p">)</span>

        <span class="n">sub_struc</span><span class="p">,</span> <span class="n">sub_inv_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_sc_for_interface_view</span><span class="p">(</span>
            <span class="n">struc</span><span class="o">=</span><span class="n">sub_struc</span><span class="p">,</span>
            <span class="n">transformation_matrix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">match</span><span class="o">.</span><span class="n">substrate_sl_transform</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">film_struc</span><span class="p">,</span> <span class="n">film_inv_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_sc_for_interface_view</span><span class="p">(</span>
            <span class="n">struc</span><span class="o">=</span><span class="n">film_struc</span><span class="p">,</span>
            <span class="n">transformation_matrix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">match</span><span class="o">.</span><span class="n">film_sl_transform</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">sub_struc</span><span class="o">.</span><span class="n">cart_coords</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">shift</span> <span class="ow">in</span> <span class="n">sub_sc_shifts</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_plot_interface_view</span><span class="p">(</span>
                    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                    <span class="n">zero_coord</span><span class="o">=</span><span class="n">c</span><span class="p">,</span>
                    <span class="n">supercell_shift</span><span class="o">=</span><span class="n">shift</span><span class="p">,</span>
                    <span class="n">cell_vetices</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
                    <span class="n">slab_matrix</span><span class="o">=</span><span class="n">sub_matrix</span><span class="p">,</span>
                    <span class="n">sc_inv_matrix</span><span class="o">=</span><span class="n">sub_inv_matrix</span><span class="p">,</span>
                    <span class="n">is_film</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">strain</span><span class="o">=</span><span class="n">strain</span><span class="p">,</span>
                    <span class="n">facecolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
                    <span class="n">edgecolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">)</span>

        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">film_struc</span><span class="o">.</span><span class="n">cart_coords</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">shift</span> <span class="ow">in</span> <span class="n">film_sc_shifts</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_plot_interface_view</span><span class="p">(</span>
                    <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                    <span class="n">zero_coord</span><span class="o">=</span><span class="n">c</span><span class="p">,</span>
                    <span class="n">supercell_shift</span><span class="o">=</span><span class="n">shift</span><span class="p">,</span>
                    <span class="n">cell_vetices</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
                    <span class="n">slab_matrix</span><span class="o">=</span><span class="n">film_matrix</span><span class="p">,</span>
                    <span class="n">sc_inv_matrix</span><span class="o">=</span><span class="n">film_inv_matrix</span><span class="p">,</span>
                    <span class="n">is_film</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">strain</span><span class="o">=</span><span class="n">strain</span><span class="p">,</span>
                    <span class="n">facecolor</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
                    <span class="n">edgecolor</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">sub_sl</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">sub_sl</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">show_in_colab</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="OgreInterface.surfaces.Interface.area" class="doc doc-heading">
<code class="highlight language-python"><span class="n">area</span><span class="p">:</span> <span class="nb">float</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Cross section area of the interface in Angstroms^2</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span><span class="o">.</span><span class="n">area</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mf">205.123456</span>
</code></pre></div>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>float</code>
          </td>
          <td><p>Cross-section area in Angstroms^2</p></td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="OgreInterface.surfaces.Interface.film_a" class="doc doc-heading">
<code class="highlight language-python"><span class="n">film_a</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the miller indices of the a basis vector of the film supercell</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span><span class="o">.</span><span class="n">film_a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="mi">1</span> <span class="o">-</span><span class="mi">1</span> <span class="mi">0</span><span class="p">]</span>
</code></pre></div>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>(3,) numpy array containing the miller indices of the a lattice vector</p></td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="OgreInterface.surfaces.Interface.film_b" class="doc doc-heading">
<code class="highlight language-python"><span class="n">film_b</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the miller indices of the a basis vector of the film supercell</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span><span class="o">.</span><span class="n">film_b</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">]</span>
</code></pre></div>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>(3,) numpy array containing the miller indices of the b lattice vector</p></td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="OgreInterface.surfaces.Interface.film_basis" class="doc doc-heading">
<code class="highlight language-python"><span class="n">film_basis</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the miller indices of the basis vectors of the film supercell</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span><span class="o">.</span><span class="n">film_basis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[[</span><span class="mi">1</span> <span class="o">-</span><span class="mi">1</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span> <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span> <span class="p">[</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">]]</span>
</code></pre></div>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>(3, 3) numpy array containing the miller indices of each lattice vector</p></td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="OgreInterface.surfaces.Interface.substrate_a" class="doc doc-heading">
<code class="highlight language-python"><span class="n">substrate_a</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the miller indices of the a basis vector of the substrate supercell</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span><span class="o">.</span><span class="n">substrate_a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="mi">3</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">]</span>
</code></pre></div>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>(3,) numpy array containing the miller indices of the a lattice vector</p></td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="OgreInterface.surfaces.Interface.substrate_b" class="doc doc-heading">
<code class="highlight language-python"><span class="n">substrate_b</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the miller indices of the b basis vector of the substrate supercell</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span><span class="o">.</span><span class="n">substrate_b</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="mi">3</span> <span class="mi">0</span><span class="p">]</span>
</code></pre></div>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>(3,) numpy array containing the miller indices of the b lattice vector</p></td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="OgreInterface.surfaces.Interface.substrate_basis" class="doc doc-heading">
<code class="highlight language-python"><span class="n">substrate_basis</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the miller indices of the basis vectors of the substrate supercell</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span><span class="o">.</span><span class="n">substrate_basis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[[</span><span class="mi">3</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="mi">3</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span> <span class="p">[</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">]]</span>
</code></pre></div>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>(3, 3) numpy array containing the miller indices of each lattice vector</p></td>
        </tr>
    </tbody>
  </table>
  </div>

</div>



<div class="doc doc-object doc-function">



<h3 id="OgreInterface.surfaces.Interface.get_film_layer_indices" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_film_layer_indices</span><span class="p">(</span><span class="n">layer_from_interface</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This function is used to extract the atom-indicies of specific layers of the film part of the interface.</p>

<p><strong>Examples:</strong></p>
    
      <pre><code>&gt;&gt;&gt; interface.get_substrate_layer_indices(layer_from_interface=0)
&gt;&gt;&gt; [0 1 2 3 4 5 6 7 8 9 10 11 12]
</code></pre>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>layer_from_interface</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The layer number of the film which you would like to get atom-indices for.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>A numpy array of integer indices corresponding to the atom index of the interface structure</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>OgreInterface/surfaces.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_film_layer_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_from_interface</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function is used to extract the atom-indicies of specific layers of the film part of the interface.</span>

<span class="sd">    Examples:</span>
<span class="sd">    ```</span>
<span class="sd">    &gt;&gt;&gt; interface.get_substrate_layer_indices(layer_from_interface=0)</span>
<span class="sd">    &gt;&gt;&gt; [0 1 2 3 4 5 6 7 8 9 10 11 12]</span>
<span class="sd">    ```</span>

<span class="sd">    Args:</span>
<span class="sd">        layer_from_interface: The layer number of the film which you would like to get atom-indices for.</span>
<span class="sd">        The layer number is reference from the interface, so layer_from_interface=0</span>
<span class="sd">        would be the layer of the film that is at the interface.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A numpy array of integer indices corresponding to the atom index of the interface structure</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">interface</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_structure</span>
    <span class="n">site_props</span> <span class="o">=</span> <span class="n">interface</span><span class="o">.</span><span class="n">site_properties</span>
    <span class="n">is_film</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">site_props</span><span class="p">[</span><span class="s2">&quot;is_film&quot;</span><span class="p">])</span>
    <span class="n">layer_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">site_props</span><span class="p">[</span><span class="s2">&quot;layer_index&quot;</span><span class="p">])</span>
    <span class="n">is_layer</span> <span class="o">=</span> <span class="n">layer_index</span> <span class="o">==</span> <span class="n">layer_from_interface</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">is_film</span><span class="p">,</span> <span class="n">is_layer</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="OgreInterface.surfaces.Interface.get_film_supercell" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_film_supercell</span><span class="p">(</span><span class="n">orthogonal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_atoms</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This is a simple function for easier access to the film supercell generated from the OgreMatch
(i.e. the interface structure with the substrate atoms removed)</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>orthogonal</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines if the orthogonalized structure is returned</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>return_atoms</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines if the ASE Atoms object is returned instead of a Pymatgen Structure object (default)</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="ase.Atoms">Atoms</span>, <span title="pymatgen.core.structure.Structure">Structure</span>]</code>
          </td>
          <td><p>Either a Pymatgen Structure of ASE Atoms object of the film supercell structure</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>OgreInterface/surfaces.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span>
<span class="normal">989</span>
<span class="normal">990</span>
<span class="normal">991</span>
<span class="normal">992</span>
<span class="normal">993</span>
<span class="normal">994</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_film_supercell</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">orthogonal</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_atoms</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Atoms</span><span class="p">,</span> <span class="n">Structure</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a simple function for easier access to the film supercell generated from the OgreMatch</span>
<span class="sd">    (i.e. the interface structure with the substrate atoms removed)</span>

<span class="sd">    Args:</span>
<span class="sd">        orthogonal: Determines if the orthogonalized structure is returned</span>
<span class="sd">        return_atoms: Determines if the ASE Atoms object is returned instead of a Pymatgen Structure object (default)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Either a Pymatgen Structure of ASE Atoms object of the film supercell structure</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">orthogonal</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">return_atoms</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_film_atoms</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_film_structure</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">return_atoms</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_film_atoms</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_film_structure</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="OgreInterface.surfaces.Interface.get_interface" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_interface</span><span class="p">(</span><span class="n">orthogonal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_atoms</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This is a simple function for easier access to the interface structure generated from the OgreMatch</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>orthogonal</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines if the orthogonalized structure is returned</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>return_atoms</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines if the ASE Atoms object is returned instead of a Pymatgen Structure object (default)</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="ase.Atoms">Atoms</span>, <span title="pymatgen.core.structure.Structure">Structure</span>]</code>
          </td>
          <td><p>Either a Pymatgen Structure of ASE Atoms object of the interface structure</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>OgreInterface/surfaces.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_interface</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">orthogonal</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_atoms</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Atoms</span><span class="p">,</span> <span class="n">Structure</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a simple function for easier access to the interface structure generated from the OgreMatch</span>

<span class="sd">    Args:</span>
<span class="sd">        orthogonal: Determines if the orthogonalized structure is returned</span>
<span class="sd">        return_atoms: Determines if the ASE Atoms object is returned instead of a Pymatgen Structure object (default)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Either a Pymatgen Structure of ASE Atoms object of the interface structure</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">orthogonal</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">return_atoms</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_atoms</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_structure</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">return_atoms</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_atoms</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_structure</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="OgreInterface.surfaces.Interface.get_substrate_layer_indices" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_substrate_layer_indices</span><span class="p">(</span><span class="n">layer_from_interface</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This function is used to extract the atom-indicies of specific layers of the substrate part of the interface.</p>

<p><strong>Examples:</strong></p>
    
      <pre><code>&gt;&gt;&gt; interface.get_substrate_layer_indices(layer_from_interface=0)
&gt;&gt;&gt; [234 235 236 237 254 255 256 257]
</code></pre>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>layer_from_interface</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>The layer number of the substrate which you would like to get
atom-indices for. The layer number is reference from the interface, so layer_from_interface=0
would be the layer of the substrate that is at the interface.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>A numpy array of integer indices corresponding to the atom index of the interface structure</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>OgreInterface/surfaces.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_substrate_layer_indices</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">layer_from_interface</span><span class="p">:</span> <span class="nb">int</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function is used to extract the atom-indicies of specific layers of the substrate part of the interface.</span>

<span class="sd">    Examples:</span>
<span class="sd">    ```</span>
<span class="sd">    &gt;&gt;&gt; interface.get_substrate_layer_indices(layer_from_interface=0)</span>
<span class="sd">    &gt;&gt;&gt; [234 235 236 237 254 255 256 257]</span>
<span class="sd">    ```</span>

<span class="sd">    Args:</span>
<span class="sd">        layer_from_interface: The layer number of the substrate which you would like to get</span>
<span class="sd">            atom-indices for. The layer number is reference from the interface, so layer_from_interface=0</span>
<span class="sd">            would be the layer of the substrate that is at the interface.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A numpy array of integer indices corresponding to the atom index of the interface structure</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">interface</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_structure</span>
    <span class="n">site_props</span> <span class="o">=</span> <span class="n">interface</span><span class="o">.</span><span class="n">site_properties</span>
    <span class="n">is_sub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">site_props</span><span class="p">[</span><span class="s2">&quot;is_sub&quot;</span><span class="p">])</span>
    <span class="n">layer_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">site_props</span><span class="p">[</span><span class="s2">&quot;layer_index&quot;</span><span class="p">])</span>
    <span class="n">sub_n_layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">layers</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">rel_layer_index</span> <span class="o">=</span> <span class="n">sub_n_layers</span> <span class="o">-</span> <span class="n">layer_index</span>
    <span class="n">is_layer</span> <span class="o">=</span> <span class="n">rel_layer_index</span> <span class="o">==</span> <span class="n">layer_from_interface</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">is_sub</span><span class="p">,</span> <span class="n">is_layer</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="OgreInterface.surfaces.Interface.get_substrate_supercell" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_substrate_supercell</span><span class="p">(</span><span class="n">orthogonal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_atoms</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This is a simple function for easier access to the substrate supercell generated from the OgreMatch
(i.e. the interface structure with the film atoms removed)</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>orthogonal</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines if the orthogonalized structure is returned</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>return_atoms</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines if the ASE Atoms object is returned instead of a Pymatgen Structure object (default)</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="ase.Atoms">Atoms</span>, <span title="pymatgen.core.structure.Structure">Structure</span>]</code>
          </td>
          <td><p>Either a Pymatgen Structure of ASE Atoms object of the substrate supercell structure</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>OgreInterface/surfaces.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_substrate_supercell</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">orthogonal</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_atoms</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Atoms</span><span class="p">,</span> <span class="n">Structure</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a simple function for easier access to the substrate supercell generated from the OgreMatch</span>
<span class="sd">    (i.e. the interface structure with the film atoms removed)</span>

<span class="sd">    Args:</span>
<span class="sd">        orthogonal: Determines if the orthogonalized structure is returned</span>
<span class="sd">        return_atoms: Determines if the ASE Atoms object is returned instead of a Pymatgen Structure object (default)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Either a Pymatgen Structure of ASE Atoms object of the substrate supercell structure</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">orthogonal</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">return_atoms</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_substrate_atoms</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_substrate_structure</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">return_atoms</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_substrate_atoms</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_substrate_structure</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="OgreInterface.surfaces.Interface.plot_interface" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot_interface</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;interface_view.png&#39;</span><span class="p">,</span> <span class="n">strain</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">show_in_colab</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This function will show the relative alignment of the film and substrate supercells by plotting the in-plane unit cells on top of each other</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>output</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>File path for the output image</p></td>
          <td>
                <code>&#39;interface_view.png&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>strain</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines if the film lattice should be strained so it shows perfectly aligned lattice coincidence sites,
or if the film lattice should be unstrained, giving a better visual of the lattice mismatch.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>dpi</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>dpi (dots per inch) of the output image.
Setting dpi=100 gives reasonably sized images when viewed in colab notebook</p></td>
          <td>
                <code>400</code>
          </td>
        </tr>
        <tr>
          <td><code>show_in_colab</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines if the matplotlib figure is closed or not after the plot if made.
if show_in_colab=True the plot will show up after you run the cell in colab/jupyter notebook.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>OgreInterface/surfaces.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2408</span>
<span class="normal">2409</span>
<span class="normal">2410</span>
<span class="normal">2411</span>
<span class="normal">2412</span>
<span class="normal">2413</span>
<span class="normal">2414</span>
<span class="normal">2415</span>
<span class="normal">2416</span>
<span class="normal">2417</span>
<span class="normal">2418</span>
<span class="normal">2419</span>
<span class="normal">2420</span>
<span class="normal">2421</span>
<span class="normal">2422</span>
<span class="normal">2423</span>
<span class="normal">2424</span>
<span class="normal">2425</span>
<span class="normal">2426</span>
<span class="normal">2427</span>
<span class="normal">2428</span>
<span class="normal">2429</span>
<span class="normal">2430</span>
<span class="normal">2431</span>
<span class="normal">2432</span>
<span class="normal">2433</span>
<span class="normal">2434</span>
<span class="normal">2435</span>
<span class="normal">2436</span>
<span class="normal">2437</span>
<span class="normal">2438</span>
<span class="normal">2439</span>
<span class="normal">2440</span>
<span class="normal">2441</span>
<span class="normal">2442</span>
<span class="normal">2443</span>
<span class="normal">2444</span>
<span class="normal">2445</span>
<span class="normal">2446</span>
<span class="normal">2447</span>
<span class="normal">2448</span>
<span class="normal">2449</span>
<span class="normal">2450</span>
<span class="normal">2451</span>
<span class="normal">2452</span>
<span class="normal">2453</span>
<span class="normal">2454</span>
<span class="normal">2455</span>
<span class="normal">2456</span>
<span class="normal">2457</span>
<span class="normal">2458</span>
<span class="normal">2459</span>
<span class="normal">2460</span>
<span class="normal">2461</span>
<span class="normal">2462</span>
<span class="normal">2463</span>
<span class="normal">2464</span>
<span class="normal">2465</span>
<span class="normal">2466</span>
<span class="normal">2467</span>
<span class="normal">2468</span>
<span class="normal">2469</span>
<span class="normal">2470</span>
<span class="normal">2471</span>
<span class="normal">2472</span>
<span class="normal">2473</span>
<span class="normal">2474</span>
<span class="normal">2475</span>
<span class="normal">2476</span>
<span class="normal">2477</span>
<span class="normal">2478</span>
<span class="normal">2479</span>
<span class="normal">2480</span>
<span class="normal">2481</span>
<span class="normal">2482</span>
<span class="normal">2483</span>
<span class="normal">2484</span>
<span class="normal">2485</span>
<span class="normal">2486</span>
<span class="normal">2487</span>
<span class="normal">2488</span>
<span class="normal">2489</span>
<span class="normal">2490</span>
<span class="normal">2491</span>
<span class="normal">2492</span>
<span class="normal">2493</span>
<span class="normal">2494</span>
<span class="normal">2495</span>
<span class="normal">2496</span>
<span class="normal">2497</span>
<span class="normal">2498</span>
<span class="normal">2499</span>
<span class="normal">2500</span>
<span class="normal">2501</span>
<span class="normal">2502</span>
<span class="normal">2503</span>
<span class="normal">2504</span>
<span class="normal">2505</span>
<span class="normal">2506</span>
<span class="normal">2507</span>
<span class="normal">2508</span>
<span class="normal">2509</span>
<span class="normal">2510</span>
<span class="normal">2511</span>
<span class="normal">2512</span>
<span class="normal">2513</span>
<span class="normal">2514</span>
<span class="normal">2515</span>
<span class="normal">2516</span>
<span class="normal">2517</span>
<span class="normal">2518</span>
<span class="normal">2519</span>
<span class="normal">2520</span>
<span class="normal">2521</span>
<span class="normal">2522</span>
<span class="normal">2523</span>
<span class="normal">2524</span>
<span class="normal">2525</span>
<span class="normal">2526</span>
<span class="normal">2527</span>
<span class="normal">2528</span>
<span class="normal">2529</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_interface</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">output</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;interface_view.png&quot;</span><span class="p">,</span>
    <span class="n">strain</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">dpi</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span>
    <span class="n">show_in_colab</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function will show the relative alignment of the film and substrate supercells by plotting the in-plane unit cells on top of each other</span>

<span class="sd">    Args:</span>
<span class="sd">        output: File path for the output image</span>
<span class="sd">        strain: Determines if the film lattice should be strained so it shows perfectly aligned lattice coincidence sites,</span>
<span class="sd">            or if the film lattice should be unstrained, giving a better visual of the lattice mismatch.</span>
<span class="sd">        dpi: dpi (dots per inch) of the output image.</span>
<span class="sd">            Setting dpi=100 gives reasonably sized images when viewed in colab notebook</span>
<span class="sd">        show_in_colab: Determines if the matplotlib figure is closed or not after the plot if made.</span>
<span class="sd">            if show_in_colab=True the plot will show up after you run the cell in colab/jupyter notebook.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">sub_struc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">_orthogonal_slab_structure</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">sub_a_to_i_op</span> <span class="o">=</span> <span class="n">SymmOp</span><span class="o">.</span><span class="n">from_rotation_and_translation</span><span class="p">(</span>
        <span class="n">rotation_matrix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_substrate_a_to_i</span><span class="p">,</span> <span class="n">translation_vec</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">sub_struc</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span><span class="n">sub_a_to_i_op</span><span class="p">)</span>

    <span class="n">film_struc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">film</span><span class="o">.</span><span class="n">_orthogonal_slab_structure</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">film_a_to_i_op</span> <span class="o">=</span> <span class="n">SymmOp</span><span class="o">.</span><span class="n">from_rotation_and_translation</span><span class="p">(</span>
        <span class="n">rotation_matrix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_film_a_to_i</span><span class="p">,</span> <span class="n">translation_vec</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">film_struc</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span><span class="n">film_a_to_i_op</span><span class="p">)</span>

    <span class="n">sub_matrix</span> <span class="o">=</span> <span class="n">sub_struc</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span>
    <span class="n">film_matrix</span> <span class="o">=</span> <span class="n">film_struc</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span>

    <span class="n">sub_sc_matrix</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_substrate_supercell</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span><span class="p">)</span>
    <span class="n">film_sc_matrix</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_film_supercell</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span><span class="p">)</span>

    <span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="n">sc_shifts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="n">sub_sc_shifts</span> <span class="o">=</span> <span class="n">sc_shifts</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">sub_sc_matrix</span><span class="p">)</span>
    <span class="n">film_sc_shifts</span> <span class="o">=</span> <span class="n">sc_shifts</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">film_sc_matrix</span><span class="p">)</span>
    <span class="n">sub_sl</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">sub_sc_matrix</span><span class="p">)</span>

    <span class="n">sub_struc</span><span class="p">,</span> <span class="n">sub_inv_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_sc_for_interface_view</span><span class="p">(</span>
        <span class="n">struc</span><span class="o">=</span><span class="n">sub_struc</span><span class="p">,</span>
        <span class="n">transformation_matrix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">match</span><span class="o">.</span><span class="n">substrate_sl_transform</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">film_struc</span><span class="p">,</span> <span class="n">film_inv_matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_generate_sc_for_interface_view</span><span class="p">(</span>
        <span class="n">struc</span><span class="o">=</span><span class="n">film_struc</span><span class="p">,</span>
        <span class="n">transformation_matrix</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">match</span><span class="o">.</span><span class="n">film_sl_transform</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">sub_struc</span><span class="o">.</span><span class="n">cart_coords</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">shift</span> <span class="ow">in</span> <span class="n">sub_sc_shifts</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_interface_view</span><span class="p">(</span>
                <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                <span class="n">zero_coord</span><span class="o">=</span><span class="n">c</span><span class="p">,</span>
                <span class="n">supercell_shift</span><span class="o">=</span><span class="n">shift</span><span class="p">,</span>
                <span class="n">cell_vetices</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
                <span class="n">slab_matrix</span><span class="o">=</span><span class="n">sub_matrix</span><span class="p">,</span>
                <span class="n">sc_inv_matrix</span><span class="o">=</span><span class="n">sub_inv_matrix</span><span class="p">,</span>
                <span class="n">is_film</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">strain</span><span class="o">=</span><span class="n">strain</span><span class="p">,</span>
                <span class="n">facecolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
                <span class="n">edgecolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">)</span>

    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">film_struc</span><span class="o">.</span><span class="n">cart_coords</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">shift</span> <span class="ow">in</span> <span class="n">film_sc_shifts</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_plot_interface_view</span><span class="p">(</span>
                <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                <span class="n">zero_coord</span><span class="o">=</span><span class="n">c</span><span class="p">,</span>
                <span class="n">supercell_shift</span><span class="o">=</span><span class="n">shift</span><span class="p">,</span>
                <span class="n">cell_vetices</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
                <span class="n">slab_matrix</span><span class="o">=</span><span class="n">film_matrix</span><span class="p">,</span>
                <span class="n">sc_inv_matrix</span><span class="o">=</span><span class="n">film_inv_matrix</span><span class="p">,</span>
                <span class="n">is_film</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">strain</span><span class="o">=</span><span class="n">strain</span><span class="p">,</span>
                <span class="n">facecolor</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
                <span class="n">edgecolor</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span> <span class="o">/</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">sub_sl</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="n">sub_sl</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">show_in_colab</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="OgreInterface.surfaces.Interface.relax_interface" class="doc doc-heading">
<code class="highlight language-python"><span class="n">relax_interface</span><span class="p">(</span><span class="n">relaxed_structure_file</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This function will shift the positions of the atoms near the interface coorresponding to the
atomic positions from a relaxed interface. This especially usefull when running DFT on large interface
structures because the atomic positions can be relaxed using an interface with less layers, and
then the relax positions can be applied to a much larger interface for a static DFT calculation.</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span><span class="o">.</span><span class="n">relax_interface</span><span class="p">(</span><span class="n">relax_structure_file</span><span class="o">=</span><span class="s2">&quot;CONTCAR&quot;</span><span class="p">)</span>
</code></pre></div>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>relaxed_structure_file</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>File path to the relax structure (CONTCAR/POSCAR for now)</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>OgreInterface/surfaces.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">relax_interface</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">relaxed_structure_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function will shift the positions of the atoms near the interface coorresponding to the</span>
<span class="sd">    atomic positions from a relaxed interface. This especially usefull when running DFT on large interface</span>
<span class="sd">    structures because the atomic positions can be relaxed using an interface with less layers, and</span>
<span class="sd">    then the relax positions can be applied to a much larger interface for a static DFT calculation.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; interface.relax_interface(relax_structure_file=&quot;CONTCAR&quot;)</span>

<span class="sd">    Args:</span>
<span class="sd">        relaxed_structure_file: File path to the relax structure (CONTCAR/POSCAR for now)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">relaxation_shifts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_relaxed_structure</span><span class="p">(</span>
        <span class="n">relaxed_structure_file</span>
    <span class="p">)</span>
    <span class="n">init_ortho_structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_structure</span>
    <span class="n">relaxed_ortho_structure</span> <span class="o">=</span> <span class="n">Structure</span><span class="p">(</span>
        <span class="n">lattice</span><span class="o">=</span><span class="n">init_ortho_structure</span><span class="o">.</span><span class="n">lattice</span><span class="p">,</span>
        <span class="n">species</span><span class="o">=</span><span class="n">init_ortho_structure</span><span class="o">.</span><span class="n">species</span><span class="p">,</span>
        <span class="n">coords</span><span class="o">=</span><span class="n">init_ortho_structure</span><span class="o">.</span><span class="n">cart_coords</span> <span class="o">+</span> <span class="n">relaxation_shifts</span><span class="p">,</span>
        <span class="n">to_unit_cell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">coords_are_cartesian</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">site_properties</span><span class="o">=</span><span class="n">init_ortho_structure</span><span class="o">.</span><span class="n">site_properties</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">relaxed_ortho_atoms</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_atoms</span><span class="p">(</span><span class="n">relaxed_ortho_structure</span><span class="p">)</span>
    <span class="p">(</span>
        <span class="n">relaxed_ortho_film_structure</span><span class="p">,</span>
        <span class="n">relaxed_ortho_film_atoms</span><span class="p">,</span>
        <span class="n">relaxed_ortho_sub_structure</span><span class="p">,</span>
        <span class="n">relaxed_ortho_sub_atoms</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_film_and_substrate_parts</span><span class="p">(</span><span class="n">relaxed_ortho_structure</span><span class="p">)</span>

    <span class="n">init_non_ortho_structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_structure</span>
    <span class="n">relaxed_non_ortho_structure</span> <span class="o">=</span> <span class="n">Structure</span><span class="p">(</span>
        <span class="n">lattice</span><span class="o">=</span><span class="n">init_non_ortho_structure</span><span class="o">.</span><span class="n">lattice</span><span class="p">,</span>
        <span class="n">species</span><span class="o">=</span><span class="n">init_non_ortho_structure</span><span class="o">.</span><span class="n">species</span><span class="p">,</span>
        <span class="n">coords</span><span class="o">=</span><span class="n">init_non_ortho_structure</span><span class="o">.</span><span class="n">cart_coords</span> <span class="o">+</span> <span class="n">relaxation_shifts</span><span class="p">,</span>
        <span class="n">to_unit_cell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">coords_are_cartesian</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">site_properties</span><span class="o">=</span><span class="n">init_non_ortho_structure</span><span class="o">.</span><span class="n">site_properties</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">relaxed_non_ortho_atoms</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_atoms</span><span class="p">(</span><span class="n">relaxed_non_ortho_structure</span><span class="p">)</span>
    <span class="p">(</span>
        <span class="n">relaxed_non_ortho_film_structure</span><span class="p">,</span>
        <span class="n">relaxed_non_ortho_film_atoms</span><span class="p">,</span>
        <span class="n">relaxed_non_ortho_sub_structure</span><span class="p">,</span>
        <span class="n">relaxed_non_ortho_sub_atoms</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_film_and_substrate_parts</span><span class="p">(</span><span class="n">relaxed_non_ortho_structure</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_structure</span> <span class="o">=</span> <span class="n">relaxed_ortho_structure</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_film_structure</span> <span class="o">=</span> <span class="n">relaxed_ortho_film_structure</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_substrate_structure</span> <span class="o">=</span> <span class="n">relaxed_ortho_sub_structure</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_structure</span> <span class="o">=</span> <span class="n">relaxed_non_ortho_structure</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_film_structure</span> <span class="o">=</span> <span class="n">relaxed_non_ortho_film_structure</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_substrate_structure</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">relaxed_non_ortho_sub_structure</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_atoms</span> <span class="o">=</span> <span class="n">relaxed_ortho_atoms</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_film_atoms</span> <span class="o">=</span> <span class="n">relaxed_ortho_film_atoms</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_substrate_atoms</span> <span class="o">=</span> <span class="n">relaxed_ortho_sub_atoms</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_atoms</span> <span class="o">=</span> <span class="n">relaxed_non_ortho_atoms</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_film_atoms</span> <span class="o">=</span> <span class="n">relaxed_non_ortho_film_atoms</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_substrate_atoms</span> <span class="o">=</span> <span class="n">relaxed_non_ortho_sub_atoms</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="OgreInterface.surfaces.Interface.replace_species" class="doc doc-heading">
<code class="highlight language-python"><span class="n">replace_species</span><span class="p">(</span><span class="n">site_index</span><span class="p">,</span> <span class="n">species_mapping</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This function can be used to replace the species at a given site in the interface structure</p>

<p><strong>Examples:</strong></p>
    
      <pre><code>&gt;&gt;&gt; interface.replace_species(site_index=42, species_mapping={&quot;In&quot;: &quot;Zn&quot;, &quot;As&quot;: &quot;Te&quot;})
</code></pre>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>site_index</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Index of the site to be replaced</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>species_mapping</code></td>
          <td>
                <code><span title="typing.Dict">Dict</span>[str, str]</code>
          </td>
          <td><p>Dictionary showing the mapping between species.
For example if you wanted to replace InAs with ZnTe then the species mapping would
be as shown in the example above.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>OgreInterface/surfaces.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">replace_species</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">site_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">species_mapping</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function can be used to replace the species at a given site in the interface structure</span>

<span class="sd">    Examples:</span>
<span class="sd">    ```</span>
<span class="sd">    &gt;&gt;&gt; interface.replace_species(site_index=42, species_mapping={&quot;In&quot;: &quot;Zn&quot;, &quot;As&quot;: &quot;Te&quot;})</span>
<span class="sd">    ```</span>

<span class="sd">    Args:</span>
<span class="sd">        site_index: Index of the site to be replaced</span>
<span class="sd">        species_mapping: Dictionary showing the mapping between species.</span>
<span class="sd">            For example if you wanted to replace InAs with ZnTe then the species mapping would</span>
<span class="sd">            be as shown in the example above.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">species_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_structure</span><span class="p">[</span><span class="n">site_index</span><span class="p">]</span><span class="o">.</span><span class="n">species_string</span>

    <span class="k">if</span> <span class="n">species_str</span> <span class="ow">in</span> <span class="n">species_mapping</span><span class="p">:</span>
        <span class="n">is_sub</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_structure</span><span class="p">[</span><span class="n">site_index</span><span class="p">]</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span>
            <span class="s2">&quot;is_sub&quot;</span>
        <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_structure</span><span class="p">[</span><span class="n">site_index</span><span class="p">]</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span>
            <span class="n">species_mapping</span><span class="p">[</span><span class="n">species_str</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_structure</span><span class="p">[</span><span class="n">site_index</span><span class="p">]</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span>
            <span class="n">species_mapping</span><span class="p">[</span><span class="n">species_str</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">is_sub</span><span class="p">:</span>
            <span class="n">sub_iface_equiv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_substrate_structure</span><span class="o">.</span><span class="n">site_properties</span><span class="p">[</span>
                    <span class="s2">&quot;interface_equivalent&quot;</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="n">sub_site_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sub_iface_equiv</span> <span class="o">==</span> <span class="n">site_index</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_substrate_structure</span><span class="p">[</span>
                <span class="n">sub_site_ind</span>
            <span class="p">]</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="n">species_mapping</span><span class="p">[</span><span class="n">species_str</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_substrate_structure</span><span class="p">[</span>
                <span class="n">sub_site_ind</span>
            <span class="p">]</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="n">species_mapping</span><span class="p">[</span><span class="n">species_str</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">film_iface_equiv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_film_structure</span><span class="o">.</span><span class="n">site_properties</span><span class="p">[</span>
                    <span class="s2">&quot;interface_equivalent&quot;</span>
                <span class="p">]</span>
            <span class="p">)</span>
            <span class="n">film_site_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">film_iface_equiv</span> <span class="o">==</span> <span class="n">site_index</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_film_structure</span><span class="p">[</span>
                <span class="n">film_site_ind</span>
            <span class="p">]</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="n">species_mapping</span><span class="p">[</span><span class="n">species_str</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_film_structure</span><span class="p">[</span>
                <span class="n">film_site_ind</span>
            <span class="p">]</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="n">species_mapping</span><span class="p">[</span><span class="n">species_str</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Species: </span><span class="si">{</span><span class="n">species_str</span><span class="si">}</span><span class="s2"> is not is species mapping&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="OgreInterface.surfaces.Interface.set_interfacial_distance" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_interfacial_distance</span><span class="p">(</span><span class="n">interfacial_distance</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Sets a new interfacial distance for the interface by shifting the film in the z-direction</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span><span class="o">.</span><span class="n">set_interfacial_distance</span><span class="p">(</span><span class="n">interfacial_distance</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</code></pre></div>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>interfacial_distance</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>New interfacial distance for the interface</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>OgreInterface/surfaces.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_interfacial_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interfacial_distance</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sets a new interfacial distance for the interface by shifting the film in the z-direction</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; interface.set_interfacial_distance(interfacial_distance=2.0)</span>

<span class="sd">    Args:</span>
<span class="sd">        interfacial_distance: New interfacial distance for the interface</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">shift</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">interfacial_distance</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">interfacial_distance</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">interfacial_distance</span> <span class="o">=</span> <span class="n">interfacial_distance</span>
    <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_structure</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_atoms</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_film_structure</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_film_atoms</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shift_film</span><span class="p">(</span>
        <span class="n">interface</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_structure</span><span class="p">,</span>
        <span class="n">shift</span><span class="o">=</span><span class="n">shift</span><span class="p">,</span>
        <span class="n">fractional</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_structure</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_atoms</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_film_structure</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_film_atoms</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shift_film</span><span class="p">(</span>
        <span class="n">interface</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_structure</span><span class="p">,</span>
        <span class="n">shift</span><span class="o">=</span><span class="n">shift</span><span class="p">,</span>
        <span class="n">fractional</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="OgreInterface.surfaces.Interface.shift_film_inplane" class="doc doc-heading">
<code class="highlight language-python"><span class="n">shift_film_inplane</span><span class="p">(</span><span class="n">x_shift</span><span class="p">,</span> <span class="n">y_shift</span><span class="p">,</span> <span class="n">fractional</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Shifts the film in-place over the substrate within the plane of the interface by a given shift vector.</p>

<p><strong>Examples:</strong></p>
    <p>Shift using fractional coordinates:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span><span class="o">.</span><span class="n">shift_film</span><span class="p">(</span><span class="n">shift</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">],</span> <span class="n">fractional</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
    <p>Shift using cartesian coordinates:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">interface</span><span class="o">.</span><span class="n">shift_film</span><span class="p">(</span><span class="n">shift</span><span class="o">=</span><span class="p">[</span><span class="mf">4.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="n">fractional</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>x_shift</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>Shift in the x or a-vector directions depending on if fractional=True</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>y_shift</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>Shift in the y or b-vector directions depending on if fractional=True</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>fractional</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines if the shift is defined in fractional coordinates</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>OgreInterface/surfaces.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">shift_film_inplane</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">x_shift</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">y_shift</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">fractional</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shifts the film in-place over the substrate within the plane of the interface by a given shift vector.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Shift using fractional coordinates:</span>
<span class="sd">        &gt;&gt;&gt; interface.shift_film(shift=[0.5, 0.25], fractional=True)</span>

<span class="sd">        Shift using cartesian coordinates:</span>
<span class="sd">        &gt;&gt;&gt; interface.shift_film(shift=[4.5, 0.0], fractional=False)</span>

<span class="sd">    Args:</span>
<span class="sd">        x_shift: Shift in the x or a-vector directions depending on if fractional=True</span>
<span class="sd">        y_shift: Shift in the y or b-vector directions depending on if fractional=True</span>
<span class="sd">        fractional: Determines if the shift is defined in fractional coordinates</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">shift_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x_shift</span><span class="p">,</span> <span class="n">y_shift</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">fractional</span><span class="p">:</span>
        <span class="n">frac_shift</span> <span class="o">=</span> <span class="n">shift_array</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">frac_shift</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_structure</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">get_fractional_coords</span><span class="p">(</span>
                <span class="n">shift_array</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_a_shift</span> <span class="o">+=</span> <span class="n">shift_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_b_shift</span> <span class="o">+=</span> <span class="n">shift_array</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_structure</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_atoms</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_film_structure</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_film_atoms</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shift_film</span><span class="p">(</span>
        <span class="n">interface</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_structure</span><span class="p">,</span>
        <span class="n">shift</span><span class="o">=</span><span class="n">frac_shift</span><span class="p">,</span>
        <span class="n">fractional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_structure</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_atoms</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_film_structure</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_film_atoms</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shift_film</span><span class="p">(</span>
        <span class="n">interface</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_structure</span><span class="p">,</span>
        <span class="n">shift</span><span class="o">=</span><span class="n">frac_shift</span><span class="p">,</span>
        <span class="n">fractional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="OgreInterface.surfaces.Interface.write_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">write_file</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;POSCAR_interface&#39;</span><span class="p">,</span> <span class="n">orthogonal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">relax</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">film_layers_to_relax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">substrate_layers_to_relax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Write the POSCAR of the interface</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>output</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>File path of the output POSCAR</p></td>
          <td>
                <code>&#39;POSCAR_interface&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>orthogonal</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines of the orthogonal structure is written</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>relax</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines if selective dynamics is applied to the atoms at the interface</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>film_layers_to_relax</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of unit cell layers near the interface to relax</p></td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>substrate_layers_to_relax</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of unit cell layers near the interface to relax</p></td>
          <td>
                <code>1</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>OgreInterface/surfaces.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_file</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">output</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;POSCAR_interface&quot;</span><span class="p">,</span>
    <span class="n">orthogonal</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">relax</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">film_layers_to_relax</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">substrate_layers_to_relax</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Write the POSCAR of the interface</span>

<span class="sd">    Args:</span>
<span class="sd">        output: File path of the output POSCAR</span>
<span class="sd">        orthogonal: Determines of the orthogonal structure is written</span>
<span class="sd">        relax: Determines if selective dynamics is applied to the atoms at the interface</span>
<span class="sd">        film_layers_to_relax: Number of unit cell layers near the interface to relax</span>
<span class="sd">        substrate_layers_to_relax: Number of unit cell layers near the interface to relax</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">orthogonal</span><span class="p">:</span>
        <span class="n">slab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_structure</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">slab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_structure</span>

    <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;L=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">film</span><span class="o">.</span><span class="n">layers</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">layers</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">film</span><span class="o">.</span><span class="n">termination_index</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">termination_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;O=</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">orthogonal</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;d=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">interfacial_distance</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">relax</span><span class="p">:</span>
        <span class="n">comment</span> <span class="o">+=</span> <span class="s2">&quot;|&quot;</span> <span class="o">+</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="sa">f</span><span class="s2">&quot;R=</span><span class="si">{</span><span class="n">film_layers_to_relax</span><span class="si">}</span><span class="s2">,</span><span class="si">{</span><span class="n">substrate_layers_to_relax</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="n">film_layers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">film_layers_to_relax</span><span class="p">)</span>
        <span class="n">sub_layers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">layers</span> <span class="o">-</span> <span class="n">substrate_layers_to_relax</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">layer_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">slab</span><span class="o">.</span><span class="n">site_properties</span><span class="p">[</span><span class="s2">&quot;layer_index&quot;</span><span class="p">])</span>
        <span class="n">is_sub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">slab</span><span class="o">.</span><span class="n">site_properties</span><span class="p">[</span><span class="s2">&quot;is_sub&quot;</span><span class="p">])</span>
        <span class="n">is_film</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">slab</span><span class="o">.</span><span class="n">site_properties</span><span class="p">[</span><span class="s2">&quot;is_film&quot;</span><span class="p">])</span>
        <span class="n">film_to_relax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span>
            <span class="n">is_film</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">layer_index</span><span class="p">,</span> <span class="n">film_layers</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">sub_to_relax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span>
            <span class="n">is_sub</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">layer_index</span><span class="p">,</span> <span class="n">sub_layers</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">to_relax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span><span class="n">sub_to_relax</span><span class="p">,</span> <span class="n">film_to_relax</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">repeats</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">comment</span> <span class="o">+=</span> <span class="s2">&quot;|&quot;</span> <span class="o">+</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;a=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_a_shift</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;b=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_b_shift</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">substrate</span><span class="o">.</span><span class="n">_passivated</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">film</span><span class="o">.</span><span class="n">_passivated</span><span class="p">:</span>
        <span class="n">poscar</span> <span class="o">=</span> <span class="n">Poscar</span><span class="p">(</span><span class="n">slab</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">relax</span><span class="p">:</span>
            <span class="n">poscar</span><span class="o">.</span><span class="n">selective_dynamics</span> <span class="o">=</span> <span class="n">to_relax</span>

        <span class="n">poscar_str</span> <span class="o">=</span> <span class="n">poscar</span><span class="o">.</span><span class="n">get_string</span><span class="p">()</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">syms</span> <span class="o">=</span> <span class="p">[</span><span class="n">site</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">symbol</span> <span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">slab</span><span class="p">]</span>

        <span class="n">syms</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">slab</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">site</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">symbol</span> <span class="o">==</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">site</span><span class="o">.</span><span class="n">specie</span><span class="p">,</span> <span class="s2">&quot;oxi_state&quot;</span><span class="p">):</span>
                    <span class="n">oxi</span> <span class="o">=</span> <span class="n">site</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">oxi_state</span>

                    <span class="k">if</span> <span class="n">oxi</span> <span class="o">&lt;</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">oxi</span> <span class="o">!=</span> <span class="mf">0.5</span><span class="p">:</span>
                        <span class="n">H_str</span> <span class="o">=</span> <span class="s2">&quot;H&quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">oxi</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                    <span class="k">elif</span> <span class="n">oxi</span> <span class="o">==</span> <span class="mf">0.5</span><span class="p">:</span>
                        <span class="n">H_str</span> <span class="o">=</span> <span class="s2">&quot;H.5&quot;</span>
                    <span class="k">elif</span> <span class="n">oxi</span> <span class="o">&gt;</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">oxi</span> <span class="o">!=</span> <span class="mf">1.5</span><span class="p">:</span>
                        <span class="n">H_str</span> <span class="o">=</span> <span class="s2">&quot;H&quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">oxi</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="k">elif</span> <span class="n">oxi</span> <span class="o">==</span> <span class="mf">1.5</span><span class="p">:</span>
                        <span class="n">H_str</span> <span class="o">=</span> <span class="s2">&quot;H1.5&quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">H_str</span> <span class="o">=</span> <span class="s2">&quot;H&quot;</span>

                    <span class="n">syms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">H_str</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">syms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">site</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">symbol</span><span class="p">)</span>

        <span class="n">comp_list</span> <span class="o">=</span> <span class="p">[(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span><span class="n">syms</span><span class="p">)]</span>
        <span class="n">atom_types</span><span class="p">,</span> <span class="n">n_atoms</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">comp_list</span><span class="p">)</span>

        <span class="n">new_atom_types</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atom_types</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;H&quot;</span> <span class="o">==</span> <span class="n">atom</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">atom</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Hf&quot;</span><span class="p">,</span> <span class="s2">&quot;Hs&quot;</span><span class="p">,</span> <span class="s2">&quot;Hg&quot;</span><span class="p">,</span> <span class="s2">&quot;He&quot;</span><span class="p">]:</span>
                <span class="n">new_atom_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_atom_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span>

        <span class="n">comment</span> <span class="o">+=</span> <span class="s2">&quot;|potcar=&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">atom_types</span><span class="p">)</span>

        <span class="n">poscar</span> <span class="o">=</span> <span class="n">Poscar</span><span class="p">(</span><span class="n">slab</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">relax</span><span class="p">:</span>
            <span class="n">poscar</span><span class="o">.</span><span class="n">selective_dynamics</span> <span class="o">=</span> <span class="n">to_relax</span>

        <span class="n">poscar_str</span> <span class="o">=</span> <span class="n">poscar</span><span class="o">.</span><span class="n">get_string</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">poscar_str</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">new_atom_types</span><span class="p">)</span>
        <span class="n">poscar_str</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">n_atoms</span><span class="p">)))</span>
        <span class="n">poscar_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">poscar_str</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">poscar_str</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="OgreInterface.surfaces.Surface" class="doc doc-heading">
        <code>Surface</code>


</h2>


  <div class="doc doc-contents ">

  
      <p>Container for surfaces generated with the SurfaceGenerator</p>
<p>The Surface class and will be used as an input to the InterfaceGenerator class,
and it should be create exclusively using the SurfaceGenerator.</p>

<p><strong>Examples:</strong></p>
    <p>Generating a surface with pseudo-hydrogen passivation where the atomic positions of the hydrogens need to be relaxed using DFT.</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">OgreInterface.generate</span> <span class="kn">import</span> <span class="n">SurfaceGenerator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surfaces</span> <span class="o">=</span> <span class="n">SurfaceGenerator</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;POSCAR_bulk&quot;</span><span class="p">,</span> <span class="n">miller_index</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">layers</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">vacuum</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surface</span> <span class="o">=</span> <span class="n">surfaces</span><span class="o">.</span><span class="n">slabs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># OgreInterface.Surface object</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surface</span><span class="o">.</span><span class="n">passivate</span><span class="p">(</span><span class="n">bot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surface</span><span class="o">.</span><span class="n">write_file</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;POSCAR_slab&quot;</span><span class="p">,</span> <span class="n">orthogonal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">relax</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># relax=True will automatically set selective dynamics=True for all passivating hydrogens</span>
</code></pre></div>
    <p>Generating a surface with pseudo-hydrogen passivation that comes from a structure with pre-relaxed pseudo-hydrogens.</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">OgreInterface.generate</span> <span class="kn">import</span> <span class="n">SurfaceGenerator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surfaces</span> <span class="o">=</span> <span class="n">SurfaceGenerator</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;POSCAR_bulk&quot;</span><span class="p">,</span> <span class="n">miller_index</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">layers</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">vacuum</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surface</span> <span class="o">=</span> <span class="n">surfaces</span><span class="o">.</span><span class="n">slabs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># OgreInterface.Surface object</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surface</span><span class="o">.</span><span class="n">passivate</span><span class="p">(</span><span class="n">bot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">passivated_struc</span><span class="o">=</span><span class="s2">&quot;CONTCAR&quot;</span><span class="p">)</span> <span class="c1"># CONTCAR is the output of the structural relaxation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">surface</span><span class="o">.</span><span class="n">write_file</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s2">&quot;POSCAR_slab&quot;</span><span class="p">,</span> <span class="n">orthogonal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">relax</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>orthogonal_slab</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="pymatgen.core.structure.Structure">Structure</span>, <span title="ase.Atoms">Atoms</span>]</code>
          </td>
          <td><p>Slab structure that is forced to have an c lattice vector that is orthogonal
to the inplane lattice vectors</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>non_orthogonal_slab</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="pymatgen.core.structure.Structure">Structure</span>, <span title="ase.Atoms">Atoms</span>]</code>
          </td>
          <td><p>Slab structure that is not gaurunteed to have an orthogonal c lattice vector,
and assumes the same basis as the primitive_oriented_bulk structure.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>oriented_bulk</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="pymatgen.core.structure.Structure">Structure</span>, <span title="ase.Atoms">Atoms</span>]</code>
          </td>
          <td><p>Structure of the smallest building block of the slab, which was used to
construct the non_orthogonal_slab supercell by creating a (1x1xN) supercell where N in the number
of layers.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>bulk</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="pymatgen.core.structure.Structure">Structure</span>, <span title="ase.Atoms">Atoms</span>]</code>
          </td>
          <td><p>Bulk structure that can be transformed into the slab basis using the transformation_matrix</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>transformation_matrix</code></td>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>3x3 integer matrix that used to change from the bulk basis to the slab basis.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>miller_index</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>Miller indices of the surface, with respect to the conventional bulk structure.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>layers</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of unit cell layers in the surface</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>vacuum</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>Size of the vacuum in Angstroms</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>uvw_basis</code></td>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>Miller indices corresponding to the lattice vector directions of the slab</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>point_group_operations</code></td>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>List of unique point group operations that will eventually be used to efficiently
filter out symmetrically equivalent interfaces found using the lattice matching algorithm.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>bottom_layer_dist</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>z-distance of where the next atom should be if the slab structure were to continue downwards
(This is used to automatically approximate the interfacial distance in interfacial_distance is set to None in the InterfaceGenerator)</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>top_layer_dist</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>z-distance of where the next atom should be if the slab structure were to continue upwards
(This is used to automatically approximate the interfacial distance in interfacial_distance is set to None in the InterfaceGenerator)</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>termination_index</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Index of the Surface in the list of Surfaces produced by the SurfaceGenerator</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>surface_normal</code></td>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>The normal vector of the surface</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>c_projection</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>The projections of the c-lattice vector onto the surface normal</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>oriented_bulk_structure</code></td>
          <td>
          </td>
          <td><p>Pymatgen Structure of the smallest building block of the slab, which was used to
construct the non_orthogonal_slab supercell by creating a (1x1xN) supercell where N in the number
of layers.</p></td>
        </tr>
        <tr>
          <td><code>oriented_bulk_atoms</code></td>
          <td>
                <code><span title="ase.Atoms">Atoms</span></code>
          </td>
          <td><p>ASE Atoms of the smallest building block of the slab, which was used to
construct the non_orthogonal_slab supercell by creating a (1x1xN) supercell where N in the number
of layers.</p></td>
        </tr>
        <tr>
          <td><code>bulk_structure</code></td>
          <td>
                <code><span title="pymatgen.core.structure.Structure">Structure</span></code>
          </td>
          <td><p>Bulk Pymatgen Structure that can be transformed into the slab basis using the transformation_matrix</p></td>
        </tr>
        <tr>
          <td><code>bulk_atoms</code></td>
          <td>
                <code><span title="ase.Atoms">Atoms</span></code>
          </td>
          <td><p>Bulk ASE Atoms that can be transformed into the slab basis using the transformation_matrix</p></td>
        </tr>
        <tr>
          <td><code>transformation_matrix</code></td>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>3x3 integer matrix that used to change from the bulk basis to the slab basis.</p></td>
        </tr>
        <tr>
          <td><code>miller_index</code></td>
          <td>
                <code>list</code>
          </td>
          <td><p>Miller indices of the surface, with respect to the conventional bulk structure.</p></td>
        </tr>
        <tr>
          <td><code>layers</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of unit cell layers in the surface</p></td>
        </tr>
        <tr>
          <td><code>vacuum</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>Size of the vacuum in Angstroms</p></td>
        </tr>
        <tr>
          <td><code>uvw_basis</code></td>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>Miller indices corresponding to the lattice vector directions of the slab</p></td>
        </tr>
        <tr>
          <td><code>point_group_operations</code></td>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>List of unique point group operations that will eventually be used to efficiently
filter out symmetrically equivalent interfaces found using the lattice matching algorithm.</p></td>
        </tr>
        <tr>
          <td><code>bottom_layer_dist</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>z-distance of where the next atom should be if the slab structure were to continue downwards
(This is used to automatically approximate the interfacial distance in interfacial_distance is set to None in the InterfaceGenerator)</p></td>
        </tr>
        <tr>
          <td><code>top_layer_dist</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>z-distance of where the next atom should be if the slab structure were to continue upwards
(This is used to automatically approximate the interfacial distance in interfacial_distance is set to None in the InterfaceGenerator)</p></td>
        </tr>
        <tr>
          <td><code>termination_index</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Index of the Surface in the list of Surfaces produced by the SurfaceGenerator</p></td>
        </tr>
        <tr>
          <td><code>surface_normal</code></td>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>The normal vector of the surface</p></td>
        </tr>
        <tr>
          <td><code>c_projection</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>The projections of the c-lattice vector onto the surface normal</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>OgreInterface/surfaces.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Surface</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Container for surfaces generated with the SurfaceGenerator</span>

<span class="sd">    The Surface class and will be used as an input to the InterfaceGenerator class,</span>
<span class="sd">    and it should be create exclusively using the SurfaceGenerator.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Generating a surface with pseudo-hydrogen passivation where the atomic positions of the hydrogens need to be relaxed using DFT.</span>
<span class="sd">        &gt;&gt;&gt; from OgreInterface.generate import SurfaceGenerator</span>
<span class="sd">        &gt;&gt;&gt; surfaces = SurfaceGenerator.from_file(filename=&quot;POSCAR_bulk&quot;, miller_index=[1, 1, 1], layers=5, vacuum=60)</span>
<span class="sd">        &gt;&gt;&gt; surface = surfaces.slabs[0] # OgreInterface.Surface object</span>
<span class="sd">        &gt;&gt;&gt; surface.passivate(bot=True, top=True)</span>
<span class="sd">        &gt;&gt;&gt; surface.write_file(output=&quot;POSCAR_slab&quot;, orthogonal=True, relax=True) # relax=True will automatically set selective dynamics=True for all passivating hydrogens</span>

<span class="sd">        Generating a surface with pseudo-hydrogen passivation that comes from a structure with pre-relaxed pseudo-hydrogens.</span>
<span class="sd">        &gt;&gt;&gt; from OgreInterface.generate import SurfaceGenerator</span>
<span class="sd">        &gt;&gt;&gt; surfaces = SurfaceGenerator.from_file(filename=&quot;POSCAR_bulk&quot;, miller_index=[1, 1, 1], layers=20, vacuum=60)</span>
<span class="sd">        &gt;&gt;&gt; surface = surfaces.slabs[0] # OgreInterface.Surface object</span>
<span class="sd">        &gt;&gt;&gt; surface.passivate(bot=True, top=True, passivated_struc=&quot;CONTCAR&quot;) # CONTCAR is the output of the structural relaxation</span>
<span class="sd">        &gt;&gt;&gt; surface.write_file(output=&quot;POSCAR_slab&quot;, orthogonal=True, relax=False)</span>

<span class="sd">    Args:</span>
<span class="sd">        orthogonal_slab: Slab structure that is forced to have an c lattice vector that is orthogonal</span>
<span class="sd">            to the inplane lattice vectors</span>
<span class="sd">        non_orthogonal_slab: Slab structure that is not gaurunteed to have an orthogonal c lattice vector,</span>
<span class="sd">            and assumes the same basis as the primitive_oriented_bulk structure.</span>
<span class="sd">        oriented_bulk: Structure of the smallest building block of the slab, which was used to</span>
<span class="sd">            construct the non_orthogonal_slab supercell by creating a (1x1xN) supercell where N in the number</span>
<span class="sd">            of layers.</span>
<span class="sd">        bulk: Bulk structure that can be transformed into the slab basis using the transformation_matrix</span>
<span class="sd">        transformation_matrix: 3x3 integer matrix that used to change from the bulk basis to the slab basis.</span>
<span class="sd">        miller_index: Miller indices of the surface, with respect to the conventional bulk structure.</span>
<span class="sd">        layers: Number of unit cell layers in the surface</span>
<span class="sd">        vacuum: Size of the vacuum in Angstroms</span>
<span class="sd">        uvw_basis: Miller indices corresponding to the lattice vector directions of the slab</span>
<span class="sd">        point_group_operations: List of unique point group operations that will eventually be used to efficiently</span>
<span class="sd">            filter out symmetrically equivalent interfaces found using the lattice matching algorithm.</span>
<span class="sd">        bottom_layer_dist: z-distance of where the next atom should be if the slab structure were to continue downwards</span>
<span class="sd">            (This is used to automatically approximate the interfacial distance in interfacial_distance is set to None in the InterfaceGenerator)</span>
<span class="sd">        top_layer_dist: z-distance of where the next atom should be if the slab structure were to continue upwards</span>
<span class="sd">            (This is used to automatically approximate the interfacial distance in interfacial_distance is set to None in the InterfaceGenerator)</span>
<span class="sd">        termination_index: Index of the Surface in the list of Surfaces produced by the SurfaceGenerator</span>
<span class="sd">        surface_normal (np.ndarray): The normal vector of the surface</span>
<span class="sd">        c_projection (float): The projections of the c-lattice vector onto the surface normal</span>

<span class="sd">    Attributes:</span>
<span class="sd">        oriented_bulk_structure: Pymatgen Structure of the smallest building block of the slab, which was used to</span>
<span class="sd">            construct the non_orthogonal_slab supercell by creating a (1x1xN) supercell where N in the number</span>
<span class="sd">            of layers.</span>
<span class="sd">        oriented_bulk_atoms (Atoms): ASE Atoms of the smallest building block of the slab, which was used to</span>
<span class="sd">            construct the non_orthogonal_slab supercell by creating a (1x1xN) supercell where N in the number</span>
<span class="sd">            of layers.</span>
<span class="sd">        bulk_structure (Structure): Bulk Pymatgen Structure that can be transformed into the slab basis using the transformation_matrix</span>
<span class="sd">        bulk_atoms (Atoms): Bulk ASE Atoms that can be transformed into the slab basis using the transformation_matrix</span>
<span class="sd">        transformation_matrix (np.ndarray): 3x3 integer matrix that used to change from the bulk basis to the slab basis.</span>
<span class="sd">        miller_index (list): Miller indices of the surface, with respect to the conventional bulk structure.</span>
<span class="sd">        layers (int): Number of unit cell layers in the surface</span>
<span class="sd">        vacuum (float): Size of the vacuum in Angstroms</span>
<span class="sd">        uvw_basis (np.ndarray): Miller indices corresponding to the lattice vector directions of the slab</span>
<span class="sd">        point_group_operations (np.ndarray): List of unique point group operations that will eventually be used to efficiently</span>
<span class="sd">            filter out symmetrically equivalent interfaces found using the lattice matching algorithm.</span>
<span class="sd">        bottom_layer_dist (float): z-distance of where the next atom should be if the slab structure were to continue downwards</span>
<span class="sd">            (This is used to automatically approximate the interfacial distance in interfacial_distance is set to None in the InterfaceGenerator)</span>
<span class="sd">        top_layer_dist (float): z-distance of where the next atom should be if the slab structure were to continue upwards</span>
<span class="sd">            (This is used to automatically approximate the interfacial distance in interfacial_distance is set to None in the InterfaceGenerator)</span>
<span class="sd">        termination_index (int): Index of the Surface in the list of Surfaces produced by the SurfaceGenerator</span>
<span class="sd">        surface_normal (np.ndarray): The normal vector of the surface</span>
<span class="sd">        c_projection (float): The projections of the c-lattice vector onto the surface normal</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">orthogonal_slab</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Structure</span><span class="p">,</span> <span class="n">Atoms</span><span class="p">],</span>
        <span class="n">non_orthogonal_slab</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Structure</span><span class="p">,</span> <span class="n">Atoms</span><span class="p">],</span>
        <span class="n">oriented_bulk</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Structure</span><span class="p">,</span> <span class="n">Atoms</span><span class="p">],</span>
        <span class="n">bulk</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Structure</span><span class="p">,</span> <span class="n">Atoms</span><span class="p">],</span>
        <span class="n">transformation_matrix</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">miller_index</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
        <span class="n">layers</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">vacuum</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">uvw_basis</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">point_group_operations</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">bottom_layer_dist</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">top_layer_dist</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">termination_index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">surface_normal</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">c_projection</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_slab_structure</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_slab_atoms</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_atoms_and_struc</span><span class="p">(</span><span class="n">orthogonal_slab</span><span class="p">)</span>
        <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_slab_structure</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_slab_atoms</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_atoms_and_struc</span><span class="p">(</span><span class="n">non_orthogonal_slab</span><span class="p">)</span>
        <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">oriented_bulk_structure</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">oriented_bulk_atoms</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_atoms_and_struc</span><span class="p">(</span><span class="n">oriented_bulk</span><span class="p">)</span>
        <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bulk_structure</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bulk_atoms</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_atoms_and_struc</span><span class="p">(</span><span class="n">bulk</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">surface_normal</span> <span class="o">=</span> <span class="n">surface_normal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c_projection</span> <span class="o">=</span> <span class="n">c_projection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_transformation_matrix</span> <span class="o">=</span> <span class="n">transformation_matrix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">miller_index</span> <span class="o">=</span> <span class="n">miller_index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span> <span class="o">=</span> <span class="n">layers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vacuum</span> <span class="o">=</span> <span class="n">vacuum</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uvw_basis</span> <span class="o">=</span> <span class="n">uvw_basis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">point_group_operations</span> <span class="o">=</span> <span class="n">point_group_operations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bottom_layer_dist</span> <span class="o">=</span> <span class="n">bottom_layer_dist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">top_layer_dist</span> <span class="o">=</span> <span class="n">top_layer_dist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">termination_index</span> <span class="o">=</span> <span class="n">termination_index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_passivated</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">get_surface</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">orthogonal</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">return_structure</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">return_atoms</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Atoms</span><span class="p">,</span> <span class="n">Structure</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This is a simple function for easier access to the surface structure generated from the SurfaceGenerator</span>

<span class="sd">        Args:</span>
<span class="sd">            orthogonal: Determines if the orthogonalized structure is returned</span>
<span class="sd">            return_structure: Determines if the Pymatgen Structure object is returned</span>
<span class="sd">            return_atoms: Determines if the ASE Atoms object is returned</span>

<span class="sd">        Returns:</span>
<span class="sd">            Either a Pymatgen Structure of ASE Atoms object of the surface structure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">orthogonal</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">return_structure</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">return_atoms</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_slab_structure</span>
            <span class="k">elif</span> <span class="n">return_atoms</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">return_structure</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_slab_atoms</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Please select either return_atoms=True OR return_structure=True to get an ASE atoms object or a Pymatgen Structure object.&quot;</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">return_structure</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">return_atoms</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_slab_structure</span>
            <span class="k">elif</span> <span class="n">return_atoms</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">return_structure</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_slab_atoms</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Please select either return_atoms=True OR return_structure=True to get an ASE atoms object or a Pymatgen Structure object.&quot;</span>
                <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">slab_transformation_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transformation matrix to convert the primitive bulk lattice vectors to the</span>
<span class="sd">        slab supercell lattice vectors (including the vacuum region)</span>

<span class="sd">        Examples:</span>
<span class="sd">        &gt;&gt;&gt; surface.slab_transformation_matrix</span>
<span class="sd">        &gt;&gt;&gt; [[ -1   1   0]</span>
<span class="sd">        ...  [  0   0   1]</span>
<span class="sd">        ...  [ 15  15 -15]]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">layer_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">layer_mat</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vacuum</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_projection</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">layer_mat</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transformation_matrix</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">bulk_transformation_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transformation matrix to convert the primitive bulk unit cell to the smallest</span>
<span class="sd">        oriented unit cell of the slab structure</span>

<span class="sd">        Examples:</span>
<span class="sd">        &gt;&gt;&gt; surface.bulk_transformation_matrix</span>
<span class="sd">        &gt;&gt;&gt; [[ -1   1   0]</span>
<span class="sd">        ...  [  0   0   1]</span>
<span class="sd">        ...  [  1   1  -1]]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transformation_matrix</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">formula</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reduced formula of the surface</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; surface.formula</span>
<span class="sd">            &gt;&gt;&gt; &quot;InAs&quot;</span>

<span class="sd">        Returns:</span>
<span class="sd">            Reduced formula of the underlying bulk structure</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bulk_structure</span><span class="o">.</span><span class="n">composition</span><span class="o">.</span><span class="n">reduced_formula</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">area</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cross section area of the slab in Angstroms^2</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; surface.area</span>
<span class="sd">            &gt;&gt;&gt; 62.51234</span>

<span class="sd">        Returns:</span>
<span class="sd">            Cross-section area in Angstroms^2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">area</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_slab_structure</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_slab_structure</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="p">)</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">area</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">inplane_vectors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        In-plane cartesian vectors of the slab structure</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; surface.inplane_vectors</span>
<span class="sd">            &gt;&gt;&gt; [[4.0 0.0 0.0]</span>
<span class="sd">            ...  [2.0 2.0 0.0]]</span>

<span class="sd">        Returns:</span>
<span class="sd">            (2, 3) numpy array containing the cartesian coordinates of the in-place lattice vectors</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">matrix</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_slab_structure</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">matrix</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">miller_index_a</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Miller index of the a-lattice vector</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; surface.miller_index_a</span>
<span class="sd">            &gt;&gt;&gt; [-1 1 0]</span>

<span class="sd">        Returns:</span>
<span class="sd">            (3,) numpy array containing the miller indices</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">uvw_basis</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">miller_index_b</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Miller index of the b-lattice vector</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; surface.miller_index_b</span>
<span class="sd">            &gt;&gt;&gt; [1 -1 0]</span>

<span class="sd">        Returns:</span>
<span class="sd">            (3,) numpy array containing the miller indices</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">uvw_basis</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_atoms_and_struc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms_or_struc</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Structure</span><span class="p">,</span> <span class="n">Atoms</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">atoms_or_struc</span><span class="p">)</span> <span class="o">==</span> <span class="n">Atoms</span><span class="p">:</span>
            <span class="n">init_structure</span> <span class="o">=</span> <span class="n">AseAtomsAdaptor</span><span class="o">.</span><span class="n">get_structure</span><span class="p">(</span><span class="n">atoms_or_struc</span><span class="p">)</span>
            <span class="n">init_atoms</span> <span class="o">=</span> <span class="n">atoms_or_struc</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">atoms_or_struc</span><span class="p">)</span> <span class="o">==</span> <span class="n">Structure</span><span class="p">:</span>
            <span class="n">init_structure</span> <span class="o">=</span> <span class="n">atoms_or_struc</span>
            <span class="n">init_atoms</span> <span class="o">=</span> <span class="n">AseAtomsAdaptor</span><span class="o">.</span><span class="n">get_atoms</span><span class="p">(</span><span class="n">atoms_or_struc</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Surface._get_atoms_and_struc() accepts &#39;pymatgen.core.structure.Structure&#39; or &#39;ase.Atoms&#39; not &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">atoms_or_struc</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">init_structure</span><span class="p">,</span> <span class="n">init_atoms</span>

    <span class="k">def</span> <span class="nf">write_file</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">orthogonal</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">output</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;POSCAR_slab&quot;</span><span class="p">,</span>
        <span class="n">relax</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes a POSCAR file of the surface with important information about the slab such as the number of layers, the termination index, and pseudo-hydrogen charges</span>

<span class="sd">        Examples:</span>
<span class="sd">            Writing a POSCAR file for a static DFT calculation:</span>
<span class="sd">            &gt;&gt;&gt; surface.write_file(orthogonal=True, output=&quot;POSCAR&quot;, relax=False)</span>

<span class="sd">            Writing a passivated POSCAR file that needs to be relaxed using DFT:</span>
<span class="sd">            &gt;&gt;&gt; surface.write_file(orthogonal=True, output=&quot;POSCAR&quot;, relax=True)</span>


<span class="sd">        Args:</span>
<span class="sd">            orthogonal: Determines the the output slab is forced to have a c-vector that is orthogonal to the a and b lattice vectors</span>
<span class="sd">            output: File path of the POSCAR</span>
<span class="sd">            relax: Determines if selective dynamics should be set in the POSCAR</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">orthogonal</span><span class="p">:</span>
            <span class="n">slab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_slab_structure</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">slab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_slab_structure</span>

        <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="sa">f</span><span class="s2">&quot;L=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">termination_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s2">&quot;O=</span><span class="si">{</span><span class="n">orthogonal</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_passivated</span><span class="p">:</span>
            <span class="n">poscar_str</span> <span class="o">=</span> <span class="n">Poscar</span><span class="p">(</span><span class="n">slab</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span><span class="o">.</span><span class="n">get_string</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">relax</span><span class="p">:</span>
                <span class="n">atomic_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">slab</span><span class="o">.</span><span class="n">atomic_numbers</span><span class="p">)</span>
                <span class="n">selective_dynamics</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">atomic_numbers</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                    <span class="n">repeats</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">selective_dynamics</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="n">syms</span> <span class="o">=</span> <span class="p">[</span><span class="n">site</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">symbol</span> <span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">slab</span><span class="p">]</span>

            <span class="n">syms</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">slab</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">site</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">symbol</span> <span class="o">==</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">site</span><span class="o">.</span><span class="n">specie</span><span class="p">,</span> <span class="s2">&quot;oxi_state&quot;</span><span class="p">):</span>
                        <span class="n">oxi</span> <span class="o">=</span> <span class="n">site</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">oxi_state</span>

                        <span class="k">if</span> <span class="n">oxi</span> <span class="o">&lt;</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">oxi</span> <span class="o">!=</span> <span class="mf">0.5</span><span class="p">:</span>
                            <span class="n">H_str</span> <span class="o">=</span> <span class="s2">&quot;H&quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">oxi</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                        <span class="k">elif</span> <span class="n">oxi</span> <span class="o">==</span> <span class="mf">0.5</span><span class="p">:</span>
                            <span class="n">H_str</span> <span class="o">=</span> <span class="s2">&quot;H.5&quot;</span>
                        <span class="k">elif</span> <span class="n">oxi</span> <span class="o">&gt;</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">oxi</span> <span class="o">!=</span> <span class="mf">1.5</span><span class="p">:</span>
                            <span class="n">H_str</span> <span class="o">=</span> <span class="s2">&quot;H&quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">oxi</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="k">elif</span> <span class="n">oxi</span> <span class="o">==</span> <span class="mf">1.5</span><span class="p">:</span>
                            <span class="n">H_str</span> <span class="o">=</span> <span class="s2">&quot;H1.5&quot;</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">H_str</span> <span class="o">=</span> <span class="s2">&quot;H&quot;</span>

                        <span class="n">syms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">H_str</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">syms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">site</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">symbol</span><span class="p">)</span>

            <span class="n">comp_list</span> <span class="o">=</span> <span class="p">[(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span><span class="n">syms</span><span class="p">)]</span>
            <span class="n">atom_types</span><span class="p">,</span> <span class="n">n_atoms</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">comp_list</span><span class="p">)</span>

            <span class="n">new_atom_types</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atom_types</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;H&quot;</span> <span class="o">==</span> <span class="n">atom</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">atom</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Hf&quot;</span><span class="p">,</span> <span class="s2">&quot;Hs&quot;</span><span class="p">,</span> <span class="s2">&quot;Hg&quot;</span><span class="p">,</span> <span class="s2">&quot;He&quot;</span><span class="p">]:</span>
                    <span class="n">new_atom_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">new_atom_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span>

            <span class="n">comment</span> <span class="o">+=</span> <span class="s2">&quot;|potcar=&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">atom_types</span><span class="p">)</span>

            <span class="n">poscar</span> <span class="o">=</span> <span class="n">Poscar</span><span class="p">(</span><span class="n">slab</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">relax</span><span class="p">:</span>
                <span class="n">poscar</span><span class="o">.</span><span class="n">selective_dynamics</span> <span class="o">=</span> <span class="n">selective_dynamics</span>

            <span class="n">poscar_str</span> <span class="o">=</span> <span class="n">poscar</span><span class="o">.</span><span class="n">get_string</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">poscar_str</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">new_atom_types</span><span class="p">)</span>
            <span class="n">poscar_str</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">n_atoms</span><span class="p">)))</span>
            <span class="n">poscar_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">poscar_str</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">poscar_str</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">remove_layers</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">num_layers</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">top</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">atol</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Removes atomic layers from a specified side of the surface. Using this function will ruin the pseudo-hydrogen passivation</span>
<span class="sd">        for the side that has layers removed, so it would be prefered to just select a different termination from the list of Surfaces</span>
<span class="sd">        generated using the SurfaceGenerator instead of manually removing layers to get the termination you want.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Removing 3 layers from the top of a surface:</span>
<span class="sd">            &gt;&gt;&gt; surface.remove_layers(num_layers=3, top=True)</span>

<span class="sd">        Args:</span>
<span class="sd">            num_layers: Number of atomic layers to remove</span>
<span class="sd">            top: Determines of the layers are removed from the top of the slab or the bottom if False</span>
<span class="sd">            atol: Tolarence for grouping the layers, if None, it is automatically determined and usually performs well</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">group_inds_conv</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">group_layers</span><span class="p">(</span>
            <span class="n">structure</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_slab_structure</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">top</span><span class="p">:</span>
            <span class="n">group_inds_conv</span> <span class="o">=</span> <span class="n">group_inds_conv</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">to_delete_conv</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_layers</span><span class="p">):</span>
            <span class="n">to_delete_conv</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">group_inds_conv</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_slab_structure</span><span class="o">.</span><span class="n">remove_sites</span><span class="p">(</span><span class="n">to_delete_conv</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_surface_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Structure</span><span class="p">,</span> <span class="n">List</span><span class="p">]:</span>
        <span class="n">obs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">oriented_bulk_structure</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">obs</span><span class="o">.</span><span class="n">add_oxidation_state_by_guess</span><span class="p">()</span>

        <span class="n">layer_struc</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_layer_supercelll</span><span class="p">(</span><span class="n">structure</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">layers</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">layer_struc</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

        <span class="n">layer_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">layer_struc</span><span class="o">.</span><span class="n">site_properties</span><span class="p">[</span><span class="s2">&quot;layer_index&quot;</span><span class="p">])</span>

        <span class="n">bottom_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">layer_inds</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">top_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">layer_inds</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">layer_inds</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">cnn</span> <span class="o">=</span> <span class="n">CrystalNN</span><span class="p">(</span><span class="n">search_cutoff</span><span class="o">=</span><span class="n">cutoff</span><span class="p">)</span>
        <span class="c1"># cnn = BrunnerNN_real(cutoff=3.0)</span>
        <span class="n">top_neighborhood</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">top_inds</span><span class="p">:</span>
            <span class="n">info_dict</span> <span class="o">=</span> <span class="n">cnn</span><span class="o">.</span><span class="n">get_nn_info</span><span class="p">(</span><span class="n">layer_struc</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="n">info_dict</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">neighbor</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">top_neighborhood</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">info_dict</span><span class="p">))</span>
                    <span class="k">break</span>

        <span class="n">bottom_neighborhood</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">bottom_inds</span><span class="p">:</span>
            <span class="n">info_dict</span> <span class="o">=</span> <span class="n">cnn</span><span class="o">.</span><span class="n">get_nn_info</span><span class="p">(</span><span class="n">layer_struc</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="n">info_dict</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">neighbor</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">bottom_neighborhood</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">info_dict</span><span class="p">))</span>
                    <span class="k">break</span>

        <span class="n">neighborhool_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">bottom_neighborhood</span><span class="p">,</span> <span class="n">top_neighborhood</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">layer_struc</span><span class="p">,</span> <span class="n">neighborhool_list</span>

    <span class="k">def</span> <span class="nf">_get_pseudohydrogen_charge</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">site</span><span class="p">,</span> <span class="n">coordination</span><span class="p">,</span> <span class="n">include_d_valence</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">electronic_struc</span> <span class="o">=</span> <span class="n">site</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">electronic_structure</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">oxi_state</span> <span class="o">=</span> <span class="n">site</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">oxi_state</span>
        <span class="n">valence</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">orb</span> <span class="ow">in</span> <span class="n">electronic_struc</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">include_d_valence</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">orb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;d&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">orb</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
                        <span class="n">valence</span> <span class="o">+=</span> <span class="nb">int</span><span class="p">(</span><span class="n">orb</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">valence</span> <span class="o">+=</span> <span class="nb">int</span><span class="p">(</span><span class="n">orb</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">orb</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;d&quot;</span><span class="p">:</span>
                    <span class="n">valence</span> <span class="o">+=</span> <span class="nb">int</span><span class="p">(</span><span class="n">orb</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span>

        <span class="k">if</span> <span class="n">oxi_state</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">charge</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span> <span class="o">-</span> <span class="n">valence</span><span class="p">)</span> <span class="o">/</span> <span class="n">coordination</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">charge</span> <span class="o">=</span> <span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">coordination</span><span class="p">)</span> <span class="o">-</span> <span class="n">valence</span><span class="p">)</span> <span class="o">/</span> <span class="n">coordination</span>

        <span class="n">available_charges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="mf">0.25</span><span class="p">,</span>
                <span class="mf">0.33</span><span class="p">,</span>
                <span class="mf">0.42</span><span class="p">,</span>
                <span class="mf">0.5</span><span class="p">,</span>
                <span class="mf">0.58</span><span class="p">,</span>
                <span class="mf">0.66</span><span class="p">,</span>
                <span class="mf">0.75</span><span class="p">,</span>
                <span class="mf">1.00</span><span class="p">,</span>
                <span class="mf">1.25</span><span class="p">,</span>
                <span class="mf">1.33</span><span class="p">,</span>
                <span class="mf">1.50</span><span class="p">,</span>
                <span class="mf">1.66</span><span class="p">,</span>
                <span class="mf">1.75</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="n">closest_charge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">charge</span> <span class="o">-</span> <span class="n">available_charges</span><span class="p">)</span>
        <span class="n">min_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">closest_charge</span><span class="p">,</span> <span class="n">closest_charge</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
        <span class="n">charge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">available_charges</span><span class="p">[</span><span class="n">min_diff</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">charge</span>

    <span class="k">def</span> <span class="nf">_get_bond_dict</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">include_d_valence</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]]:</span>
        <span class="n">image_map</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;-&quot;</span><span class="p">}</span>
        <span class="p">(</span>
            <span class="n">layer_struc</span><span class="p">,</span>
            <span class="n">surface_neighborhoods</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_surface_atoms</span><span class="p">(</span><span class="n">cutoff</span><span class="p">)</span>

        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="s2">&quot;top&quot;</span><span class="p">]</span>
        <span class="n">bond_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;bottom&quot;</span><span class="p">:</span> <span class="p">{},</span> <span class="s2">&quot;top&quot;</span><span class="p">:</span> <span class="p">{}}</span>
        <span class="n">H_len</span> <span class="o">=</span> <span class="mf">0.31</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">neighborhood</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">surface_neighborhoods</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">surface_atom</span> <span class="ow">in</span> <span class="n">neighborhood</span><span class="p">:</span>
                <span class="n">atom_index</span> <span class="o">=</span> <span class="n">surface_atom</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">center_atom_equiv_index</span> <span class="o">=</span> <span class="n">layer_struc</span><span class="p">[</span><span class="n">atom_index</span><span class="p">]</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span>
                    <span class="s2">&quot;oriented_bulk_equivalent&quot;</span>
                <span class="p">]</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="n">center_len</span> <span class="o">=</span> <span class="n">CovalentRadius</span><span class="o">.</span><span class="n">radius</span><span class="p">[</span>
                        <span class="n">layer_struc</span><span class="p">[</span><span class="n">atom_index</span><span class="p">]</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">symbol</span>
                    <span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="n">center_len</span> <span class="o">=</span> <span class="n">layer_struc</span><span class="p">[</span><span class="n">atom_index</span><span class="p">]</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">atomic_radius</span>

                <span class="n">oriented_bulk_equivalent</span> <span class="o">=</span> <span class="n">layer_struc</span><span class="p">[</span><span class="n">atom_index</span><span class="p">]</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span>
                    <span class="s2">&quot;oriented_bulk_equivalent&quot;</span>
                <span class="p">]</span>
                <span class="n">neighbor_info</span> <span class="o">=</span> <span class="n">surface_atom</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">coordination</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">neighbor_info</span><span class="p">)</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_pseudohydrogen_charge</span><span class="p">(</span>
                    <span class="n">layer_struc</span><span class="p">[</span><span class="n">atom_index</span><span class="p">],</span>
                    <span class="n">coordination</span><span class="p">,</span>
                    <span class="n">include_d_valence</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">broken_atoms</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">neighbor</span>
                    <span class="k">for</span> <span class="n">neighbor</span> <span class="ow">in</span> <span class="n">neighbor_info</span>
                    <span class="k">if</span> <span class="n">neighbor</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span>
                <span class="p">]</span>

                <span class="n">bonds</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">bond_strs</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">broken_atoms</span><span class="p">:</span>
                    <span class="n">broken_site</span> <span class="o">=</span> <span class="n">atom</span><span class="p">[</span><span class="s2">&quot;site&quot;</span><span class="p">]</span>
                    <span class="n">broken_atom_equiv_index</span> <span class="o">=</span> <span class="n">broken_site</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span>
                        <span class="s2">&quot;oriented_bulk_equivalent&quot;</span>
                    <span class="p">]</span>
                    <span class="n">broken_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">broken_site</span><span class="o">.</span><span class="n">image</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
                    <span class="n">broken_atom_cart_coords</span> <span class="o">=</span> <span class="n">broken_site</span><span class="o">.</span><span class="n">coords</span>
                    <span class="n">center_atom_cart_coords</span> <span class="o">=</span> <span class="n">layer_struc</span><span class="p">[</span><span class="n">atom_index</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span>
                    <span class="n">bond_vector</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">broken_atom_cart_coords</span> <span class="o">-</span> <span class="n">center_atom_cart_coords</span>
                    <span class="p">)</span>
                    <span class="n">norm_vector</span> <span class="o">=</span> <span class="n">bond_vector</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">bond_vector</span><span class="p">)</span>
                    <span class="n">H_vector</span> <span class="o">=</span> <span class="p">(</span><span class="n">H_len</span> <span class="o">+</span> <span class="n">center_len</span><span class="p">)</span> <span class="o">*</span> <span class="n">norm_vector</span>

                    <span class="n">H_str</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="nb">str</span><span class="p">(</span><span class="n">center_atom_equiv_index</span><span class="p">),</span>
                            <span class="nb">str</span><span class="p">(</span><span class="n">broken_atom_equiv_index</span><span class="p">),</span>
                            <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">image_map</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">broken_image</span><span class="p">]),</span>
                            <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                        <span class="p">]</span>
                    <span class="p">)</span>

                    <span class="n">bonds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">H_vector</span><span class="p">)</span>
                    <span class="n">bond_strs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">H_str</span><span class="p">)</span>

                <span class="n">bond_dict</span><span class="p">[</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="n">oriented_bulk_equivalent</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;bonds&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">bonds</span><span class="p">),</span>
                    <span class="s2">&quot;bond_strings&quot;</span><span class="p">:</span> <span class="n">bond_strs</span><span class="p">,</span>
                    <span class="s2">&quot;charge&quot;</span><span class="p">:</span> <span class="n">charge</span><span class="p">,</span>
                <span class="p">}</span>

        <span class="k">return</span> <span class="n">bond_dict</span>

    <span class="k">def</span> <span class="nf">_get_passivation_atom_index</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">struc</span><span class="p">,</span> <span class="n">bulk_equivalent</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="n">struc_layer_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">struc</span><span class="o">.</span><span class="n">site_properties</span><span class="p">[</span><span class="s2">&quot;layer_index&quot;</span><span class="p">])</span>
        <span class="n">struc_bulk_equiv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="n">struc</span><span class="o">.</span><span class="n">site_properties</span><span class="p">[</span><span class="s2">&quot;oriented_bulk_equivalent&quot;</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">top</span><span class="p">:</span>
            <span class="n">layer_number</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">struc_layer_index</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">layer_number</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">atom_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span>
                <span class="n">struc_layer_index</span> <span class="o">==</span> <span class="n">layer_number</span><span class="p">,</span>
                <span class="n">struc_bulk_equiv</span> <span class="o">==</span> <span class="n">bulk_equivalent</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">atom_index</span>

    <span class="k">def</span> <span class="nf">_passivate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">struc</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">bond</span><span class="p">,</span> <span class="n">bond_str</span><span class="p">,</span> <span class="n">charge</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">position</span> <span class="o">=</span> <span class="n">struc</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span> <span class="o">+</span> <span class="n">bond</span>
        <span class="n">position</span> <span class="o">=</span> <span class="n">struc</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">coords</span> <span class="o">+</span> <span class="n">bond</span>
        <span class="n">props</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">struc</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">properties</span><span class="p">}</span>
        <span class="c1"># props[&quot;hydrogen_str&quot;] = f&quot;{index},&quot; + bond_str</span>

        <span class="n">struc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">Species</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="n">oxidation_state</span><span class="o">=</span><span class="n">charge</span><span class="p">),</span>
            <span class="n">coords</span><span class="o">=</span><span class="n">position</span><span class="p">,</span>
            <span class="n">coords_are_cartesian</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">properties</span><span class="o">=</span><span class="n">props</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_passivated_bond_dict</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">bond_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span>
            <span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]</span>
        <span class="p">],</span>
        <span class="n">relaxed_structure_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]]]:</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">relaxed_structure_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">poscar_str</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">desc_str</span> <span class="o">=</span> <span class="n">poscar_str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>

        <span class="n">layers</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">desc_str</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">termination_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">desc_str</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">termination_index</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">termination_index</span><span class="p">:</span>
            <span class="n">poscar</span> <span class="o">=</span> <span class="n">Poscar</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">poscar_str</span><span class="p">),</span> <span class="n">read_velocities</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>

            <span class="n">structure</span> <span class="o">=</span> <span class="n">poscar</span><span class="o">.</span><span class="n">structure</span>
            <span class="n">hydrogen_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">structure</span><span class="o">.</span><span class="n">atomic_numbers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>

            <span class="n">obs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">oriented_bulk_structure</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">obs</span><span class="o">.</span><span class="n">add_oxidation_state_by_guess</span><span class="p">()</span>

            <span class="n">is_negative</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">obs</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>

            <span class="k">if</span> <span class="n">is_negative</span><span class="p">:</span>
                <span class="n">structure</span> <span class="o">=</span> <span class="n">Structure</span><span class="p">(</span>
                    <span class="n">lattice</span><span class="o">=</span><span class="n">Lattice</span><span class="p">(</span><span class="n">structure</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                    <span class="n">species</span><span class="o">=</span><span class="n">structure</span><span class="o">.</span><span class="n">species</span><span class="p">,</span>
                    <span class="n">coords</span><span class="o">=</span><span class="n">structure</span><span class="o">.</span><span class="n">frac_coords</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="n">hydrogen_coords</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">cart_coords</span><span class="p">[</span><span class="n">hydrogen_index</span><span class="p">]</span>

            <span class="n">layer_struc</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_layer_supercelll</span><span class="p">(</span>
                <span class="n">structure</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">layers</span><span class="o">=</span><span class="n">layers</span><span class="p">,</span> <span class="n">vacuum_scale</span><span class="o">=</span><span class="mi">2</span>
            <span class="p">)</span>
            <span class="n">layer_struc</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

            <span class="n">surface_atom_info</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">side</span><span class="p">,</span> <span class="n">side_dict</span> <span class="ow">in</span> <span class="n">bond_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">is_top</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">side</span> <span class="o">==</span> <span class="s2">&quot;top&quot;</span> <span class="k">else</span> <span class="kc">False</span>
                <span class="k">for</span> <span class="n">bulk_equiv</span><span class="p">,</span> <span class="n">bonds</span> <span class="ow">in</span> <span class="n">side_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_passivation_atom_index</span><span class="p">(</span>
                        <span class="n">struc</span><span class="o">=</span><span class="n">layer_struc</span><span class="p">,</span>
                        <span class="n">bulk_equivalent</span><span class="o">=</span><span class="n">bulk_equiv</span><span class="p">,</span>
                        <span class="n">top</span><span class="o">=</span><span class="n">is_top</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="n">surface_atom_info</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">index</span><span class="p">,</span> <span class="n">side</span><span class="p">,</span> <span class="n">bulk_equiv</span><span class="p">))</span>

            <span class="n">surface_atoms</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">surface_atom_info</span><span class="p">)</span>
            <span class="n">surface_atom_coords</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">cart_coords</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">surface_atoms</span><span class="p">)]</span>

            <span class="n">new_bonds</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">surface_atom_info</span><span class="p">}</span>

            <span class="n">shifts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="p">]</span>
            <span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">structure</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span><span class="p">)</span>

            <span class="n">all_surface_atom_coords</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">shifts</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">+</span> <span class="n">surface_atom_coords</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:]</span>
            <span class="p">)</span>

            <span class="k">for</span> <span class="n">hydrogen</span> <span class="ow">in</span> <span class="n">hydrogen_coords</span><span class="p">:</span>
                <span class="n">all_dists</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span>
                    <span class="n">hydrogen</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">all_surface_atom_coords</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span>
                <span class="p">)</span>
                <span class="n">center_ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">all_dists</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">all_dists</span><span class="p">)))</span>
                <span class="n">center_atom_ind</span> <span class="o">=</span> <span class="n">center_ind</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">bond</span> <span class="o">=</span> <span class="n">hydrogen</span> <span class="o">-</span> <span class="n">all_surface_atom_coords</span><span class="p">[</span><span class="n">center_ind</span><span class="p">]</span>
                <span class="n">new_bonds</span><span class="p">[</span><span class="n">surface_atom_info</span><span class="p">[</span><span class="n">center_atom_ind</span><span class="p">]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bond</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">new_bonds</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">bond_dict</span><span class="p">:</span>
                    <span class="n">bond_dict</span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]][</span><span class="n">k</span><span class="p">[</span><span class="mi">2</span><span class="p">]][</span><span class="s2">&quot;bonds&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">bond_dict</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;This is not the same termination. The passivated structure has termination=</span><span class="si">{</span><span class="n">termination_index</span><span class="si">}</span><span class="s2">, and the current surface has termination=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">termination_index</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">passivate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">bottom</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">top</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">,</span>
        <span class="n">include_d_valence</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">passivated_struc</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function will apply pseudohydrogen passivation to all broken bonds on the surface and assign charges to the pseudo-hydrogens based</span>
<span class="sd">        on the equations provided in https://doi.org/10.1103/PhysRevB.85.195328. The identification of the local coordination environments is</span>
<span class="sd">        provided using CrystalNN in Pymatgen which is based on https://doi.org/10.1021/acs.inorgchem.0c02996.</span>

<span class="sd">        Examples:</span>
<span class="sd">            Initial passivation:</span>
<span class="sd">            &gt;&gt;&gt; surface.passivate(bottom=True, top=True)</span>

<span class="sd">            Relaxed passivation from a CONTCAR file:</span>
<span class="sd">            &gt;&gt;&gt; surface.passivate(bottom=True, top=True, passivated_struc=&quot;CONTCAR&quot;)</span>

<span class="sd">        Args:</span>
<span class="sd">            bottom: Determines if the bottom of the structure should be passivated</span>
<span class="sd">            top: Determines of the top of the structure should be passivated</span>
<span class="sd">            cutoff: Determines the cutoff in Angstroms for the nearest neighbor search. 3.0 seems to give reasonalble reasults.</span>
<span class="sd">            include_d_valence: Determines if the d-orbital electrons are included the calculation of the pseudohydrogen charge.</span>
<span class="sd">            passivated_struc: File path to the CONTCAR/POSCAR file that contains the relaxed atomic positions of the pseudo-hydrogens.</span>
<span class="sd">                This structure must have the same miller index and termination index.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bond_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_bond_dict</span><span class="p">(</span><span class="n">cutoff</span><span class="p">,</span> <span class="n">include_d_valence</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">passivated_struc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">bond_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_passivated_bond_dict</span><span class="p">(</span>
                <span class="n">bond_dict</span><span class="o">=</span><span class="n">bond_dict</span><span class="p">,</span> <span class="n">relaxed_structure_file</span><span class="o">=</span><span class="n">passivated_struc</span>
            <span class="p">)</span>

        <span class="n">ortho_slab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_slab_structure</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">non_ortho_slab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_slab_structure</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">top</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">bulk_equiv</span><span class="p">,</span> <span class="n">bonds</span> <span class="ow">in</span> <span class="n">bond_dict</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">ortho_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_passivation_atom_index</span><span class="p">(</span>
                    <span class="n">struc</span><span class="o">=</span><span class="n">ortho_slab</span><span class="p">,</span> <span class="n">bulk_equivalent</span><span class="o">=</span><span class="n">bulk_equiv</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
                <span class="n">non_ortho_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_passivation_atom_index</span><span class="p">(</span>
                    <span class="n">struc</span><span class="o">=</span><span class="n">non_ortho_slab</span><span class="p">,</span> <span class="n">bulk_equivalent</span><span class="o">=</span><span class="n">bulk_equiv</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>

                <span class="k">for</span> <span class="n">bond</span><span class="p">,</span> <span class="n">bond_str</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                    <span class="n">bonds</span><span class="p">[</span><span class="s2">&quot;bonds&quot;</span><span class="p">],</span> <span class="n">bonds</span><span class="p">[</span><span class="s2">&quot;bond_strings&quot;</span><span class="p">]</span>
                <span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_passivate</span><span class="p">(</span>
                        <span class="n">ortho_slab</span><span class="p">,</span>
                        <span class="n">ortho_index</span><span class="p">,</span>
                        <span class="n">bond</span><span class="p">,</span>
                        <span class="n">bond_str</span><span class="p">,</span>
                        <span class="n">bonds</span><span class="p">[</span><span class="s2">&quot;charge&quot;</span><span class="p">],</span>
                    <span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_passivate</span><span class="p">(</span>
                        <span class="n">non_ortho_slab</span><span class="p">,</span>
                        <span class="n">non_ortho_index</span><span class="p">,</span>
                        <span class="n">bond</span><span class="p">,</span>
                        <span class="n">bond_str</span><span class="p">,</span>
                        <span class="n">bonds</span><span class="p">[</span><span class="s2">&quot;charge&quot;</span><span class="p">],</span>
                    <span class="p">)</span>

        <span class="k">if</span> <span class="n">bottom</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">bulk_equiv</span><span class="p">,</span> <span class="n">bonds</span> <span class="ow">in</span> <span class="n">bond_dict</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">ortho_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_passivation_atom_index</span><span class="p">(</span>
                    <span class="n">struc</span><span class="o">=</span><span class="n">ortho_slab</span><span class="p">,</span> <span class="n">bulk_equivalent</span><span class="o">=</span><span class="n">bulk_equiv</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span>
                <span class="p">)</span>
                <span class="n">non_ortho_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_passivation_atom_index</span><span class="p">(</span>
                    <span class="n">struc</span><span class="o">=</span><span class="n">non_ortho_slab</span><span class="p">,</span> <span class="n">bulk_equivalent</span><span class="o">=</span><span class="n">bulk_equiv</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span>
                <span class="p">)</span>

                <span class="k">for</span> <span class="n">bond</span><span class="p">,</span> <span class="n">bond_str</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                    <span class="n">bonds</span><span class="p">[</span><span class="s2">&quot;bonds&quot;</span><span class="p">],</span> <span class="n">bonds</span><span class="p">[</span><span class="s2">&quot;bond_strings&quot;</span><span class="p">]</span>
                <span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_passivate</span><span class="p">(</span>
                        <span class="n">ortho_slab</span><span class="p">,</span>
                        <span class="n">ortho_index</span><span class="p">,</span>
                        <span class="n">bond</span><span class="p">,</span>
                        <span class="n">bond_str</span><span class="p">,</span>
                        <span class="n">bonds</span><span class="p">[</span><span class="s2">&quot;charge&quot;</span><span class="p">],</span>
                    <span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_passivate</span><span class="p">(</span>
                        <span class="n">non_ortho_slab</span><span class="p">,</span>
                        <span class="n">non_ortho_index</span><span class="p">,</span>
                        <span class="n">bond</span><span class="p">,</span>
                        <span class="n">bond_str</span><span class="p">,</span>
                        <span class="n">bonds</span><span class="p">[</span><span class="s2">&quot;charge&quot;</span><span class="p">],</span>
                    <span class="p">)</span>

        <span class="n">ortho_slab</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">non_ortho_slab</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_passivated</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_slab_structure</span> <span class="o">=</span> <span class="n">ortho_slab</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_slab_structure</span> <span class="o">=</span> <span class="n">non_ortho_slab</span>

    <span class="k">def</span> <span class="nf">get_termination</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the termination of the surface as a dictionary</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; surface.get_termination()</span>
<span class="sd">            &gt;&gt;&gt; {&quot;bottom&quot;: &quot;In&quot;, &quot;top&quot;: &quot;As&quot;}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="OgreInterface.surfaces.Surface.area" class="doc doc-heading">
<code class="highlight language-python"><span class="n">area</span><span class="p">:</span> <span class="nb">float</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Cross section area of the slab in Angstroms^2</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">surface</span><span class="o">.</span><span class="n">area</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mf">62.51234</span>
</code></pre></div>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>float</code>
          </td>
          <td><p>Cross-section area in Angstroms^2</p></td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="OgreInterface.surfaces.Surface.bulk_transformation_matrix" class="doc doc-heading">
<code class="highlight language-python"><span class="n">bulk_transformation_matrix</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Transformation matrix to convert the primitive bulk unit cell to the smallest
oriented unit cell of the slab structure</p>

<p><strong>Examples:</strong></p>
    
      <blockquote>
<blockquote>
<blockquote>
<p>surface.bulk_transformation_matrix
[[ -1   1   0]
...  [  0   0   1]
...  [  1   1  -1]]</p>
</blockquote>
</blockquote>
</blockquote>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="OgreInterface.surfaces.Surface.formula" class="doc doc-heading">
<code class="highlight language-python"><span class="n">formula</span><span class="p">:</span> <span class="nb">str</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Reduced formula of the surface</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">surface</span><span class="o">.</span><span class="n">formula</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;InAs&quot;</span>
</code></pre></div>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>str</code>
          </td>
          <td><p>Reduced formula of the underlying bulk structure</p></td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="OgreInterface.surfaces.Surface.inplane_vectors" class="doc doc-heading">
<code class="highlight language-python"><span class="n">inplane_vectors</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>In-plane cartesian vectors of the slab structure</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">surface</span><span class="o">.</span><span class="n">inplane_vectors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[[</span><span class="mf">4.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="gp">... </span> <span class="p">[</span><span class="mf">2.0</span> <span class="mf">2.0</span> <span class="mf">0.0</span><span class="p">]]</span>
</code></pre></div>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>(2, 3) numpy array containing the cartesian coordinates of the in-place lattice vectors</p></td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="OgreInterface.surfaces.Surface.miller_index_a" class="doc doc-heading">
<code class="highlight language-python"><span class="n">miller_index_a</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Miller index of the a-lattice vector</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">surface</span><span class="o">.</span><span class="n">miller_index_a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">]</span>
</code></pre></div>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>(3,) numpy array containing the miller indices</p></td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="OgreInterface.surfaces.Surface.miller_index_b" class="doc doc-heading">
<code class="highlight language-python"><span class="n">miller_index_b</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Miller index of the b-lattice vector</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">surface</span><span class="o">.</span><span class="n">miller_index_b</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="mi">1</span> <span class="o">-</span><span class="mi">1</span> <span class="mi">0</span><span class="p">]</span>
</code></pre></div>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy">np</span>.<span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td><p>(3,) numpy array containing the miller indices</p></td>
        </tr>
    </tbody>
  </table>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="OgreInterface.surfaces.Surface.slab_transformation_matrix" class="doc doc-heading">
<code class="highlight language-python"><span class="n">slab_transformation_matrix</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <p>Transformation matrix to convert the primitive bulk lattice vectors to the
slab supercell lattice vectors (including the vacuum region)</p>

<p><strong>Examples:</strong></p>
    
      <blockquote>
<blockquote>
<blockquote>
<p>surface.slab_transformation_matrix
[[ -1   1   0]
...  [  0   0   1]
...  [ 15  15 -15]]</p>
</blockquote>
</blockquote>
</blockquote>
  </div>

</div>



<div class="doc doc-object doc-function">



<h3 id="OgreInterface.surfaces.Surface.get_surface" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_surface</span><span class="p">(</span><span class="n">orthogonal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_structure</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_atoms</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This is a simple function for easier access to the surface structure generated from the SurfaceGenerator</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>orthogonal</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines if the orthogonalized structure is returned</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>return_structure</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines if the Pymatgen Structure object is returned</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>return_atoms</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines if the ASE Atoms object is returned</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="ase.Atoms">Atoms</span>, <span title="pymatgen.core.structure.Structure">Structure</span>]</code>
          </td>
          <td><p>Either a Pymatgen Structure of ASE Atoms object of the surface structure</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>OgreInterface/surfaces.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_surface</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">orthogonal</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_structure</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">return_atoms</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">Atoms</span><span class="p">,</span> <span class="n">Structure</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is a simple function for easier access to the surface structure generated from the SurfaceGenerator</span>

<span class="sd">    Args:</span>
<span class="sd">        orthogonal: Determines if the orthogonalized structure is returned</span>
<span class="sd">        return_structure: Determines if the Pymatgen Structure object is returned</span>
<span class="sd">        return_atoms: Determines if the ASE Atoms object is returned</span>

<span class="sd">    Returns:</span>
<span class="sd">        Either a Pymatgen Structure of ASE Atoms object of the surface structure</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">orthogonal</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">return_structure</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">return_atoms</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_slab_structure</span>
        <span class="k">elif</span> <span class="n">return_atoms</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">return_structure</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_slab_atoms</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Please select either return_atoms=True OR return_structure=True to get an ASE atoms object or a Pymatgen Structure object.&quot;</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">return_structure</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">return_atoms</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_slab_structure</span>
        <span class="k">elif</span> <span class="n">return_atoms</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">return_structure</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_slab_atoms</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Please select either return_atoms=True OR return_structure=True to get an ASE atoms object or a Pymatgen Structure object.&quot;</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="OgreInterface.surfaces.Surface.get_termination" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_termination</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the termination of the surface as a dictionary</p>

<p><strong>Examples:</strong></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">surface</span><span class="o">.</span><span class="n">get_termination</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">{</span><span class="s2">&quot;bottom&quot;</span><span class="p">:</span> <span class="s2">&quot;In&quot;</span><span class="p">,</span> <span class="s2">&quot;top&quot;</span><span class="p">:</span> <span class="s2">&quot;As&quot;</span><span class="p">}</span>
</code></pre></div>

      <details class="quote">
        <summary>Source code in <code>OgreInterface/surfaces.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_termination</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the termination of the surface as a dictionary</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; surface.get_termination()</span>
<span class="sd">        &gt;&gt;&gt; {&quot;bottom&quot;: &quot;In&quot;, &quot;top&quot;: &quot;As&quot;}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="OgreInterface.surfaces.Surface.passivate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">passivate</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">include_d_valence</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">passivated_struc</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>This function will apply pseudohydrogen passivation to all broken bonds on the surface and assign charges to the pseudo-hydrogens based
on the equations provided in https://doi.org/10.1103/PhysRevB.85.195328. The identification of the local coordination environments is
provided using CrystalNN in Pymatgen which is based on https://doi.org/10.1021/acs.inorgchem.0c02996.</p>

<p><strong>Examples:</strong></p>
    <p>Initial passivation:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">surface</span><span class="o">.</span><span class="n">passivate</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
    <p>Relaxed passivation from a CONTCAR file:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">surface</span><span class="o">.</span><span class="n">passivate</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">passivated_struc</span><span class="o">=</span><span class="s2">&quot;CONTCAR&quot;</span><span class="p">)</span>
</code></pre></div>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>bottom</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines if the bottom of the structure should be passivated</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>top</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines of the top of the structure should be passivated</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>cutoff</code></td>
          <td>
                <code>float</code>
          </td>
          <td><p>Determines the cutoff in Angstroms for the nearest neighbor search. 3.0 seems to give reasonalble reasults.</p></td>
          <td>
                <code>3.0</code>
          </td>
        </tr>
        <tr>
          <td><code>include_d_valence</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines if the d-orbital electrons are included the calculation of the pseudohydrogen charge.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>passivated_struc</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[str, None]</code>
          </td>
          <td><p>File path to the CONTCAR/POSCAR file that contains the relaxed atomic positions of the pseudo-hydrogens.
This structure must have the same miller index and termination index.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>OgreInterface/surfaces.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">passivate</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">bottom</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">top</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">3.0</span><span class="p">,</span>
    <span class="n">include_d_valence</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">passivated_struc</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function will apply pseudohydrogen passivation to all broken bonds on the surface and assign charges to the pseudo-hydrogens based</span>
<span class="sd">    on the equations provided in https://doi.org/10.1103/PhysRevB.85.195328. The identification of the local coordination environments is</span>
<span class="sd">    provided using CrystalNN in Pymatgen which is based on https://doi.org/10.1021/acs.inorgchem.0c02996.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Initial passivation:</span>
<span class="sd">        &gt;&gt;&gt; surface.passivate(bottom=True, top=True)</span>

<span class="sd">        Relaxed passivation from a CONTCAR file:</span>
<span class="sd">        &gt;&gt;&gt; surface.passivate(bottom=True, top=True, passivated_struc=&quot;CONTCAR&quot;)</span>

<span class="sd">    Args:</span>
<span class="sd">        bottom: Determines if the bottom of the structure should be passivated</span>
<span class="sd">        top: Determines of the top of the structure should be passivated</span>
<span class="sd">        cutoff: Determines the cutoff in Angstroms for the nearest neighbor search. 3.0 seems to give reasonalble reasults.</span>
<span class="sd">        include_d_valence: Determines if the d-orbital electrons are included the calculation of the pseudohydrogen charge.</span>
<span class="sd">        passivated_struc: File path to the CONTCAR/POSCAR file that contains the relaxed atomic positions of the pseudo-hydrogens.</span>
<span class="sd">            This structure must have the same miller index and termination index.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bond_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_bond_dict</span><span class="p">(</span><span class="n">cutoff</span><span class="p">,</span> <span class="n">include_d_valence</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">passivated_struc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">bond_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_passivated_bond_dict</span><span class="p">(</span>
            <span class="n">bond_dict</span><span class="o">=</span><span class="n">bond_dict</span><span class="p">,</span> <span class="n">relaxed_structure_file</span><span class="o">=</span><span class="n">passivated_struc</span>
        <span class="p">)</span>

    <span class="n">ortho_slab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_slab_structure</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">non_ortho_slab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_slab_structure</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">top</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">bulk_equiv</span><span class="p">,</span> <span class="n">bonds</span> <span class="ow">in</span> <span class="n">bond_dict</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">ortho_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_passivation_atom_index</span><span class="p">(</span>
                <span class="n">struc</span><span class="o">=</span><span class="n">ortho_slab</span><span class="p">,</span> <span class="n">bulk_equivalent</span><span class="o">=</span><span class="n">bulk_equiv</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
            <span class="n">non_ortho_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_passivation_atom_index</span><span class="p">(</span>
                <span class="n">struc</span><span class="o">=</span><span class="n">non_ortho_slab</span><span class="p">,</span> <span class="n">bulk_equivalent</span><span class="o">=</span><span class="n">bulk_equiv</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>

            <span class="k">for</span> <span class="n">bond</span><span class="p">,</span> <span class="n">bond_str</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                <span class="n">bonds</span><span class="p">[</span><span class="s2">&quot;bonds&quot;</span><span class="p">],</span> <span class="n">bonds</span><span class="p">[</span><span class="s2">&quot;bond_strings&quot;</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_passivate</span><span class="p">(</span>
                    <span class="n">ortho_slab</span><span class="p">,</span>
                    <span class="n">ortho_index</span><span class="p">,</span>
                    <span class="n">bond</span><span class="p">,</span>
                    <span class="n">bond_str</span><span class="p">,</span>
                    <span class="n">bonds</span><span class="p">[</span><span class="s2">&quot;charge&quot;</span><span class="p">],</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_passivate</span><span class="p">(</span>
                    <span class="n">non_ortho_slab</span><span class="p">,</span>
                    <span class="n">non_ortho_index</span><span class="p">,</span>
                    <span class="n">bond</span><span class="p">,</span>
                    <span class="n">bond_str</span><span class="p">,</span>
                    <span class="n">bonds</span><span class="p">[</span><span class="s2">&quot;charge&quot;</span><span class="p">],</span>
                <span class="p">)</span>

    <span class="k">if</span> <span class="n">bottom</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">bulk_equiv</span><span class="p">,</span> <span class="n">bonds</span> <span class="ow">in</span> <span class="n">bond_dict</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">ortho_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_passivation_atom_index</span><span class="p">(</span>
                <span class="n">struc</span><span class="o">=</span><span class="n">ortho_slab</span><span class="p">,</span> <span class="n">bulk_equivalent</span><span class="o">=</span><span class="n">bulk_equiv</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>
            <span class="n">non_ortho_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_passivation_atom_index</span><span class="p">(</span>
                <span class="n">struc</span><span class="o">=</span><span class="n">non_ortho_slab</span><span class="p">,</span> <span class="n">bulk_equivalent</span><span class="o">=</span><span class="n">bulk_equiv</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span>
            <span class="p">)</span>

            <span class="k">for</span> <span class="n">bond</span><span class="p">,</span> <span class="n">bond_str</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                <span class="n">bonds</span><span class="p">[</span><span class="s2">&quot;bonds&quot;</span><span class="p">],</span> <span class="n">bonds</span><span class="p">[</span><span class="s2">&quot;bond_strings&quot;</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_passivate</span><span class="p">(</span>
                    <span class="n">ortho_slab</span><span class="p">,</span>
                    <span class="n">ortho_index</span><span class="p">,</span>
                    <span class="n">bond</span><span class="p">,</span>
                    <span class="n">bond_str</span><span class="p">,</span>
                    <span class="n">bonds</span><span class="p">[</span><span class="s2">&quot;charge&quot;</span><span class="p">],</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_passivate</span><span class="p">(</span>
                    <span class="n">non_ortho_slab</span><span class="p">,</span>
                    <span class="n">non_ortho_index</span><span class="p">,</span>
                    <span class="n">bond</span><span class="p">,</span>
                    <span class="n">bond_str</span><span class="p">,</span>
                    <span class="n">bonds</span><span class="p">[</span><span class="s2">&quot;charge&quot;</span><span class="p">],</span>
                <span class="p">)</span>

    <span class="n">ortho_slab</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">non_ortho_slab</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_passivated</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_slab_structure</span> <span class="o">=</span> <span class="n">ortho_slab</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_slab_structure</span> <span class="o">=</span> <span class="n">non_ortho_slab</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="OgreInterface.surfaces.Surface.remove_layers" class="doc doc-heading">
<code class="highlight language-python"><span class="n">remove_layers</span><span class="p">(</span><span class="n">num_layers</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Removes atomic layers from a specified side of the surface. Using this function will ruin the pseudo-hydrogen passivation
for the side that has layers removed, so it would be prefered to just select a different termination from the list of Surfaces
generated using the SurfaceGenerator instead of manually removing layers to get the termination you want.</p>

<p><strong>Examples:</strong></p>
    <p>Removing 3 layers from the top of a surface:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">surface</span><span class="o">.</span><span class="n">remove_layers</span><span class="p">(</span><span class="n">num_layers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>num_layers</code></td>
          <td>
                <code>int</code>
          </td>
          <td><p>Number of atomic layers to remove</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>top</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines of the layers are removed from the top of the slab or the bottom if False</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>atol</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[float, None]</code>
          </td>
          <td><p>Tolarence for grouping the layers, if None, it is automatically determined and usually performs well</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>OgreInterface/surfaces.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">remove_layers</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">num_layers</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">top</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">atol</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Removes atomic layers from a specified side of the surface. Using this function will ruin the pseudo-hydrogen passivation</span>
<span class="sd">    for the side that has layers removed, so it would be prefered to just select a different termination from the list of Surfaces</span>
<span class="sd">    generated using the SurfaceGenerator instead of manually removing layers to get the termination you want.</span>

<span class="sd">    Examples:</span>
<span class="sd">        Removing 3 layers from the top of a surface:</span>
<span class="sd">        &gt;&gt;&gt; surface.remove_layers(num_layers=3, top=True)</span>

<span class="sd">    Args:</span>
<span class="sd">        num_layers: Number of atomic layers to remove</span>
<span class="sd">        top: Determines of the layers are removed from the top of the slab or the bottom if False</span>
<span class="sd">        atol: Tolarence for grouping the layers, if None, it is automatically determined and usually performs well</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">group_inds_conv</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">group_layers</span><span class="p">(</span>
        <span class="n">structure</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_slab_structure</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">top</span><span class="p">:</span>
        <span class="n">group_inds_conv</span> <span class="o">=</span> <span class="n">group_inds_conv</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">to_delete_conv</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_layers</span><span class="p">):</span>
        <span class="n">to_delete_conv</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">group_inds_conv</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_slab_structure</span><span class="o">.</span><span class="n">remove_sites</span><span class="p">(</span><span class="n">to_delete_conv</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="OgreInterface.surfaces.Surface.write_file" class="doc doc-heading">
<code class="highlight language-python"><span class="n">write_file</span><span class="p">(</span><span class="n">orthogonal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;POSCAR_slab&#39;</span><span class="p">,</span> <span class="n">relax</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Writes a POSCAR file of the surface with important information about the slab such as the number of layers, the termination index, and pseudo-hydrogen charges</p>

<p><strong>Examples:</strong></p>
    <p>Writing a POSCAR file for a static DFT calculation:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">surface</span><span class="o">.</span><span class="n">write_file</span><span class="p">(</span><span class="n">orthogonal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s2">&quot;POSCAR&quot;</span><span class="p">,</span> <span class="n">relax</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
    <p>Writing a passivated POSCAR file that needs to be relaxed using DFT:</p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">surface</span><span class="o">.</span><span class="n">write_file</span><span class="p">(</span><span class="n">orthogonal</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s2">&quot;POSCAR&quot;</span><span class="p">,</span> <span class="n">relax</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>orthogonal</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines the the output slab is forced to have a c-vector that is orthogonal to the a and b lattice vectors</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>output</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>File path of the POSCAR</p></td>
          <td>
                <code>&#39;POSCAR_slab&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>relax</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Determines if selective dynamics should be set in the POSCAR</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>OgreInterface/surfaces.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write_file</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">orthogonal</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">output</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;POSCAR_slab&quot;</span><span class="p">,</span>
    <span class="n">relax</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Writes a POSCAR file of the surface with important information about the slab such as the number of layers, the termination index, and pseudo-hydrogen charges</span>

<span class="sd">    Examples:</span>
<span class="sd">        Writing a POSCAR file for a static DFT calculation:</span>
<span class="sd">        &gt;&gt;&gt; surface.write_file(orthogonal=True, output=&quot;POSCAR&quot;, relax=False)</span>

<span class="sd">        Writing a passivated POSCAR file that needs to be relaxed using DFT:</span>
<span class="sd">        &gt;&gt;&gt; surface.write_file(orthogonal=True, output=&quot;POSCAR&quot;, relax=True)</span>


<span class="sd">    Args:</span>
<span class="sd">        orthogonal: Determines the the output slab is forced to have a c-vector that is orthogonal to the a and b lattice vectors</span>
<span class="sd">        output: File path of the POSCAR</span>
<span class="sd">        relax: Determines if selective dynamics should be set in the POSCAR</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">orthogonal</span><span class="p">:</span>
        <span class="n">slab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orthogonal_slab_structure</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">slab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_non_orthogonal_slab_structure</span>

    <span class="n">comment</span> <span class="o">=</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;L=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;T=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">termination_index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s2">&quot;O=</span><span class="si">{</span><span class="n">orthogonal</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="p">]</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_passivated</span><span class="p">:</span>
        <span class="n">poscar_str</span> <span class="o">=</span> <span class="n">Poscar</span><span class="p">(</span><span class="n">slab</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span><span class="o">.</span><span class="n">get_string</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">relax</span><span class="p">:</span>
            <span class="n">atomic_numbers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">slab</span><span class="o">.</span><span class="n">atomic_numbers</span><span class="p">)</span>
            <span class="n">selective_dynamics</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span>
                <span class="p">(</span><span class="n">atomic_numbers</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="n">repeats</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">selective_dynamics</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">syms</span> <span class="o">=</span> <span class="p">[</span><span class="n">site</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">symbol</span> <span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">slab</span><span class="p">]</span>

        <span class="n">syms</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">site</span> <span class="ow">in</span> <span class="n">slab</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">site</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">symbol</span> <span class="o">==</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">site</span><span class="o">.</span><span class="n">specie</span><span class="p">,</span> <span class="s2">&quot;oxi_state&quot;</span><span class="p">):</span>
                    <span class="n">oxi</span> <span class="o">=</span> <span class="n">site</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">oxi_state</span>

                    <span class="k">if</span> <span class="n">oxi</span> <span class="o">&lt;</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">oxi</span> <span class="o">!=</span> <span class="mf">0.5</span><span class="p">:</span>
                        <span class="n">H_str</span> <span class="o">=</span> <span class="s2">&quot;H&quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">oxi</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                    <span class="k">elif</span> <span class="n">oxi</span> <span class="o">==</span> <span class="mf">0.5</span><span class="p">:</span>
                        <span class="n">H_str</span> <span class="o">=</span> <span class="s2">&quot;H.5&quot;</span>
                    <span class="k">elif</span> <span class="n">oxi</span> <span class="o">&gt;</span> <span class="mf">1.0</span> <span class="ow">and</span> <span class="n">oxi</span> <span class="o">!=</span> <span class="mf">1.5</span><span class="p">:</span>
                        <span class="n">H_str</span> <span class="o">=</span> <span class="s2">&quot;H&quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">oxi</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="k">elif</span> <span class="n">oxi</span> <span class="o">==</span> <span class="mf">1.5</span><span class="p">:</span>
                        <span class="n">H_str</span> <span class="o">=</span> <span class="s2">&quot;H1.5&quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">H_str</span> <span class="o">=</span> <span class="s2">&quot;H&quot;</span>

                    <span class="n">syms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">H_str</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">syms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">site</span><span class="o">.</span><span class="n">specie</span><span class="o">.</span><span class="n">symbol</span><span class="p">)</span>

        <span class="n">comp_list</span> <span class="o">=</span> <span class="p">[(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span><span class="n">syms</span><span class="p">)]</span>
        <span class="n">atom_types</span><span class="p">,</span> <span class="n">n_atoms</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">comp_list</span><span class="p">)</span>

        <span class="n">new_atom_types</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">atom_types</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;H&quot;</span> <span class="o">==</span> <span class="n">atom</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">atom</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Hf&quot;</span><span class="p">,</span> <span class="s2">&quot;Hs&quot;</span><span class="p">,</span> <span class="s2">&quot;Hg&quot;</span><span class="p">,</span> <span class="s2">&quot;He&quot;</span><span class="p">]:</span>
                <span class="n">new_atom_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;H&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_atom_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span>

        <span class="n">comment</span> <span class="o">+=</span> <span class="s2">&quot;|potcar=&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">atom_types</span><span class="p">)</span>

        <span class="n">poscar</span> <span class="o">=</span> <span class="n">Poscar</span><span class="p">(</span><span class="n">slab</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">relax</span><span class="p">:</span>
            <span class="n">poscar</span><span class="o">.</span><span class="n">selective_dynamics</span> <span class="o">=</span> <span class="n">selective_dynamics</span>

        <span class="n">poscar_str</span> <span class="o">=</span> <span class="n">poscar</span><span class="o">.</span><span class="n">get_string</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">poscar_str</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">new_atom_types</span><span class="p">)</span>
        <span class="n">poscar_str</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">n_atoms</span><span class="p">)))</span>
        <span class="n">poscar_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">poscar_str</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">poscar_str</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.db81ec45.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.a00a7c5e.min.js"></script>
      
    
  </body>
</html>